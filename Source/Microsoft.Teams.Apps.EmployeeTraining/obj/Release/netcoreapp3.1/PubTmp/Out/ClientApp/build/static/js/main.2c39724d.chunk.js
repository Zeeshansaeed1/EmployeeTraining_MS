(this.webpackJsonpemployeetrainer=this.webpackJsonpemployeetrainer||[]).push([[0],{1170:function(e,t,a){},1171:function(e,t,a){},1173:function(e,t,a){},1174:function(e,t,a){},1176:function(e,t,a){},1177:function(e,t,a){},1178:function(e,t,a){},1179:function(e,t,a){},1180:function(e,t,a){},1181:function(e,t,a){},1182:function(e,t,a){},1185:function(e,t,a){},1186:function(e,t,a){},1187:function(e,t,a){},1188:function(e,t,a){},1189:function(e,t,a){},1190:function(e,t,a){},1192:function(e,t,a){},1193:function(e,t,a){"use strict";a.r(t);var n,r,i=a(0),s=a.n(i),o=a(74),l=a(237),c=a(38),u=a(41),d=a(45),m=a(44),p=a(67),v=a(7),g=a.n(v),h=a(13),f=a(1),E=a(46),b=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).code=null,n.token=null;var r=window.location.search,i=new URLSearchParams(r);return n.token=i.get("token"),n.code=i.get("code"),n.state={resourceStrings:{}},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=Object(h.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.resourceStrings.errorMessage;return"401"===this.code&&(e="".concat(this.state.resourceStrings.unauthorizedAccess)),i.createElement("div",{className:"container-div"},i.createElement(f.Flex,{gap:"gap.small",hAlign:"center",vAlign:"center",className:"error-container"},i.createElement(f.Flex,{gap:"gap.small",hAlign:"center",vAlign:"center"},i.createElement(f.Flex.Item,null,i.createElement("div",{style:{position:"relative"}},i.createElement(f.Label,{icon:i.createElement(E.ErrorIcon,null)}))),i.createElement(f.Flex.Item,{grow:!0},i.createElement(f.Flex,{column:!0,gap:"gap.small",vAlign:"stretch"},i.createElement("div",null,i.createElement(f.Text,{weight:"bold",error:!0,content:e}),i.createElement("br",null)))))))}}]),a}(i.Component),y=a(123),C=a(184),x=a(481),S=a(40),k=a(82),w=a.n(k),D=new(function(){function e(){Object(c.a)(this,e),this.authorizationHeaderKey="Authorization",this.acceptLanguageHeaderKey="Accept-Language"}return Object(u.a)(e,[{key:"post",value:function(){var e=Object(h.a)(g.a.mark((function e(t,a,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.setupAuthorizationHeader(n);case 3:return n=e.sent,e.next=6,w.a.post(t,a,n);case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Promise.resolve(this.handleError(e.t0)));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(h.a)(g.a.mark((function e(t,a){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.setupAuthorizationHeader(a);case 3:return a=e.sent,e.next=6,w.a.delete(t,a);case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Promise.resolve(this.handleError(e.t0)));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(h.a)(g.a.mark((function e(t,a,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.setupAuthorizationHeader(n);case 3:return n=e.sent,e.next=6,w.a.put(t,a,n);case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Promise.resolve(this.handleError(e.t0)));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"patch",value:function(){var e=Object(h.a)(g.a.mark((function e(t,a,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.setupAuthorizationHeader(n);case 3:return n=e.sent,e.next=6,w.a.patch(t,a,n);case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Promise.resolve(this.handleError(e.t0)));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(r.length>2&&void 0!==r[2])||r[2],e.prev=1,!n){e.next=6;break}return e.next=5,this.setupAuthorizationHeader(a);case 5:a=e.sent;case 6:return e.next=8,w.a.get(t,a);case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",Promise.resolve(this.handleError(e.t0)));case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getCachedData",value:function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(r.length>2&&void 0!==r[2])||r[2],e.prev=1,!n){e.next=7;break}return e.next=5,this.setupAuthorizationHeader(a);case 5:(a=e.sent).headers["Cache-Control"]="max-age=1209600";case 7:return e.next=9,w.a.get(t,a);case 9:return e.abrupt("return",e.sent);case 12:return e.prev=12,e.t0=e.catch(1),e.abrupt("return",Promise.resolve(this.handleError(e.t0)));case 15:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleError",value:function(e){return e.hasOwnProperty("response")?e.response:e}},{key:"setupAuthorizationHeader",value:function(){var e=Object(h.a)(g.a.mark((function e(t){var a=this;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S.initialize(),e.abrupt("return",new Promise((function(e,n){var r={successCallback:function(n){t||(t=w.a.defaults),t.headers[a.authorizationHeaderKey]="Bearer ".concat(n),t.headers[a.acceptLanguageHeaderKey]=z.language,e(t)},failureCallback:function(e){console.error("Error from getAuthToken: ",e),window.location.href="/signin"},resources:[]};S.authentication.getAuthToken(r)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}()),O=function e(){Object(c.a)(this,e)};O.body="body",O.theme="theme",O.default="default",O.light="light",O.dark="dark",O.contrast="contrast",O.categoryNameMaxLength=100,O.categoryDescriptionMaxLength=300,O.lazyLoadEventsCount=50,O.maxWidthForMobileView=750,O.apiBaseURL=window.location.origin+"/api",function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit",e[e.Delete=2]="Delete",e[e.Unknown=3]="Unknown"}(n||(n={})),function(e){e[e.OK=200]="OK"}(r||(r={}));var T=function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(O.apiBaseURL,"/cultureMetadata"),e.next=3,D.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(O.apiBaseURL,"/cultureMetadata/supportedcultures"),e.next=3,D.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(e){var t={data:{},nextCleanup:(new Date).getTime()+864e5};try{var a=localStorage.getItem(e);if(a&&(t=JSON.parse(a),(new Date).getTime()>t.nextCleanup))return localStorage.removeItem(e),{data:{},nextCleanup:(new Date).getTime()+864e5}}catch(n){console.error(n.message)}return t},N=function(e,t,a){var n=I(e);n.data[t]=a;try{localStorage.setItem(e,JSON.stringify(n))}catch(r){console.error(r.message),localStorage.removeItem(e)}},L="en";S.initialize(),S.getContext((function(e){var t=I("SUPPORTEDCULTURE_CACHE"),a=I("DEFAULTCULTURE_CACHE");t.data.SupportedCultures&&a.data.DefaultCulture?t.data.SupportedCultures.includes(e.locale.split("-")[0])||t.data.SupportedCultures.includes(e.locale)?y.a.changeLanguage(e.locale):y.a.changeLanguage(a.data.DefaultCulture):F().then((function(t){var a=t.data;N("SUPPORTEDCULTURE_CACHE","SupportedCultures",a),a.includes(e.locale.split("-")[0])||a.includes(e.locale)?y.a.changeLanguage(e.locale):T().then((function(e){L=e.data,N("DEFAULTCULTURE_CACHE","DefaultCulture",L),y.a.changeLanguage(L)}))}))})),y.a.use(x.a).use(C.e).init({lng:"en",fallbackLng:L,keySeparator:!1,interpolation:{escapeValue:!1},react:{useSuspense:!0}});var P,A,z=y.a,B=a(35),j=a.n(B),M=a(1237);!function(e){e[e.None=0]="None",e[e.CloseRegistration=1]="CloseRegistration",e[e.CancelEvent=2]="CancelEvent",e[e.Register=3]="Register",e[e.Remove=4]="Remove"}(P||(P={})),function(e){e[e.None=0]="None",e[e.Draft=1]="Draft",e[e.Active=2]="Active",e[e.Cancelled=3]="Cancelled",e[e.Completed=4]="Completed"}(A||(A={}));var R,U,V=function(e){var t=w.a.defaults;return t.params=e,t},_=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/Event"),r=V({eventId:t,teamId:a}),e.next=4,D.get(n,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),W=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(O.apiBaseURL,"/users"),n=V({searchText:encodeURIComponent(t)}),e.next=4,D.get(a,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(O.apiBaseURL,"/group/get-group-members"),n=V({groupId:t}),e.next=4,D.get(a,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(h.a)(g.a.mark((function e(t){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(O.apiBaseURL,"/users"),e.next=3,D.post(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=window.location.origin+"/api",Q=function(){var e=Object(h.a)(g.a.mark((function e(t,a,n,r,i,s){var o,l;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="".concat(H,"/event/UserEvents"),(l=w.a.defaults).params={searchString:encodeURIComponent(t),pageCount:a,eventSearchType:n,createdByFilter:r,categoryFilter:i,sortBy:s},e.abrupt("return",D.get(o,l));case 4:case"end":return e.stop()}}),e)})));return function(t,a,n,r,i,s){return e.apply(this,arguments)}}(),J=function(e,t){var a="".concat(H,"/event/RegisterToEvent?teamId=").concat(e,"&eventId=").concat(t),n=w.a.defaults;return n.params={teamId:e,eventId:t},D.post(a,null,n)},Y=function(e,t){var a="".concat(H,"/event/UnregisterToEvent"),n=w.a.defaults;return n.params={teamId:e,eventId:t},D.post(a,null,n)},q=a(1259);!function(e){e[e.None=0]="None",e[e.Public=1]="Public",e[e.Private=2]="Private"}(R||(R={})),function(e){e[e.None=0]="None",e[e.InPerson=1]="InPerson",e[e.Teams=2]="Teams",e[e.LiveEvent=3]="LiveEvent"}(U||(U={}));var Z,$=a(23),X=a(17),ee=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/eventfiles/upload-image"),r=V({teamId:a}),e.next=4,D.post(n,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),te=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/eventworkflow/create-draft"),r=V({teamId:a}),e.next=4,D.post(n,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ae=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/eventworkflow/update-draft"),r=V({teamId:a}),e.next=4,D.patch(n,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ne=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/eventworkflow/create-event"),r=V({teamId:a}),e.next=4,D.post(n,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),re=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/eventworkflow/update-event"),r=V({teamId:a}),e.next=4,D.patch(n,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ie=function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(O.apiBaseURL,"/category/get-categories-for-event"),e.next=3,D.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(O.apiBaseURL,"/event/search-by-title"),n=V({search:t}),e.next=4,D.get(a,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n,i,s,o,l,c,u,d,m,p,v,h,f,E,b,y,C,x,S,k,w,D,O;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o={mandatoryUsers:new Array,optionalUsers:new Array},l={mandatoryUsers:new Array,optionalUsers:new Array},c={mandatoryUsers:new Array,optionalUsers:new Array},u=0;case 4:if(!(u<t.length)){e.next=17;break}if(!(d=t[u]).isGroup){e.next=13;break}return e.next=9,K(d.id);case 9:(m=e.sent).status===r.OK&&(p=m.data.map((function(e){return e.id})),d.isMandatory?(v=l.mandatoryUsers).push.apply(v,Object(X.a)(p)):(h=l.optionalUsers).push.apply(h,Object(X.a)(p))),e.next=14;break;case 13:d.isMandatory?o.mandatoryUsers.push(d.id):o.optionalUsers.push(d.id);case 14:u++,e.next=4;break;case 17:for(o.mandatoryUsers=Object(X.a)(new Set(o.mandatoryUsers)),o.optionalUsers=Object(X.a)(new Set(o.optionalUsers)),l.mandatoryUsers=Object(X.a)(new Set(l.mandatoryUsers)),l.optionalUsers=Object(X.a)(new Set(l.optionalUsers)),f=new Array,E=function(e){o.mandatoryUsers.find((function(t){return t===o.optionalUsers[e]}))||f.push(o.optionalUsers[e])},b=0;b<o.optionalUsers.length;b++)E(b);for(o.optionalUsers=f,y=new Array,C=function(e){l.mandatoryUsers.find((function(t){return t===l.optionalUsers[e]}))||y.push(l.optionalUsers[e])},x=0;x<l.optionalUsers.length;x++)C(x);for(l.optionalUsers=y,S=new Array,k=function(e){o.optionalUsers.find((function(t){return t===l.mandatoryUsers[e]}))||S.push(l.mandatoryUsers[e])},w=0;w<l.mandatoryUsers.length;w++)k(w);for(l.mandatoryUsers=S,y=new Array,D=function(e){o.mandatoryUsers.find((function(t){return t===l.optionalUsers[e]}))||y.push(l.optionalUsers[e])},O=0;O<l.optionalUsers.length;O++)D(O);return l.optionalUsers=y,(a=c.mandatoryUsers).push.apply(a,Object(X.a)(o.mandatoryUsers)),(n=c.mandatoryUsers).push.apply(n,Object(X.a)(l.mandatoryUsers)),(i=c.optionalUsers).push.apply(i,Object(X.a)(o.optionalUsers)),(s=c.optionalUsers).push.apply(s,Object(X.a)(l.optionalUsers)),c.mandatoryUsers=Object(X.a)(new Set(c.mandatoryUsers)),c.optionalUsers=Object(X.a)(new Set(c.optionalUsers)),e.abrupt("return",{mandatoryUsers:c.mandatoryUsers,optionalUsers:c.optionalUsers});case 44:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,i,s,o,l;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(l=Object($.a)({},t.eventDetails)).startDate=j()(l.startDate).startOf("day").add(null===(n=l.startTime)||void 0===n?void 0:n.getHours(),"hours").add(null===(i=l.startTime)||void 0===i?void 0:i.getMinutes(),"minutes").utc().toDate(),l.endDate=j()(l.endDate).startOf("day").add(null===(s=l.startTime)||void 0===s?void 0:s.getHours(),"hours").add(null===(o=l.startTime)||void 0===o?void 0:o.getMinutes(),"minutes").utc().toDate(),l.startTime=j()(l.startTime).utc().toDate(),l.endTime=j()(l.endTime).utc().toDate(),l.selectedUserOrGroupListJSON=JSON.stringify(t.selectedUserGroups),e.next=8,ne(l,a);case 8:if(e.sent.status!==r.OK){e.next=13;break}return e.abrupt("return",!0);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ce=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Object($.a)({},t.eventDetails)).startDate=j()(n.startDate).utc().toDate(),n.endDate=j()(n.endDate).utc().toDate(),n.startTime=j()(n.startTime).utc().toDate(),n.endTime=j()(n.endTime).utc().toDate(),n.selectedUserOrGroupListJSON=JSON.stringify(t.selectedUserGroups),e.next=8,re(n,a);case 8:if(e.sent.status!==r.OK){e.next=13;break}return e.abrupt("return",!0);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ue=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=t.eventDetails).startDate=j()(n.startDate).utc().toDate(),n.endDate=j()(n.endDate).utc().toDate(),n.startTime=j()(n.startTime).utc().toDate(),n.endTime=j()(n.endTime).utc().toDate(),n.selectedUserOrGroupListJSON=JSON.stringify(t.selectedUserGroups),!t.isDraft){e.next=15;break}return e.next=9,ae(n,a);case 9:if(e.sent.status!==r.OK){e.next=12;break}return e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 15:return e.next=17,te(n,a);case 17:if(e.sent.status!==r.OK){e.next=20;break}return e.abrupt("return",!0);case 20:return e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),de=function(e,t,a){var n=j.a.utc(e).local().format("ddd"),r=j.a.utc(t).local().format("HH:mm"),i=j.a.utc(a).local().format("HH:mm");return"".concat(n,", ").concat(r," - ").concat(i)};function me(e){return function(t){Object(d.a)(n,t);var a=Object(m.a)(n);function n(e){var t;return Object(c.a)(this,n),(t=a.call(this,e)).state={teamsContext:null,microsoftTeams:S,dir:Z.Ltr},t}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;S.initialize(),S.getContext((function(t){e.setState({teamsContext:t,dir:y.a.dir(t.locale)===Z.Rtl?Z.Rtl:Z.Ltr})}))}},{key:"render",value:function(){return s.a.createElement(e,Object.assign({},this.props,{teamsContext:this.state.teamsContext,microsoftTeams:this.state.microsoftTeams,dir:this.state.dir}))}}]),n}(i.Component)}!function(e){e.Rtl="rtl",e.Ltr="ltr",e.Auto="auto"}(Z||(Z={}));var pe,ve,ge=Object(M.a)()(me((function(e){var t=e.t;return i.createElement(f.Label,{circular:!0,className:e.dir===Z.Rtl?"event-artifact rtl-right-margin-small":"event-artifact",title:e.audienceType===R.Private?t("private"):t("public"),content:i.createElement(f.Layout,{className:"text-overflow-ellipsis",gap:".6rem",start:e.audienceType===R.Private?i.createElement(f.EyeSlashIcon,null):i.createElement(f.EyeIcon,null),main:i.createElement(f.Text,{className:"text-overflow-ellipsis",content:e.audienceType===R.Private?t("private"):t("public"),size:"small",weight:"semibold"})})})}))),he=Object(M.a)()((function(e){var t=e.t;return i.createElement(f.Label,{circular:!0,className:"event-artifact",title:t("teamsMeeting"),content:i.createElement(f.Layout,{className:"text-overflow-ellipsis",gap:".6rem",start:i.createElement(f.TeamsIcon,null),main:i.createElement(f.Text,{className:"text-overflow-ellipsis",content:t("teamsMeeting"),size:"small",weight:"semibold"})})})})),fe=Object(M.a)()((function(e){var t=e.t;return i.createElement(f.Label,{circular:!0,className:"event-artifact",title:t("liveEvent"),content:i.createElement(f.Layout,{className:"text-overflow-ellipsis",gap:".6rem",start:i.createElement(f.BroadcastIcon,null),main:i.createElement(f.Text,{className:"text-overflow-ellipsis",content:t("liveEvent"),size:"small",weight:"semibold"})})})})),Ee=Object(M.a)()((function(e){var t=e.t;return i.createElement(f.Label,{circular:!0,className:"event-artifact mandatory text-overflow-ellipsis",title:t("mandatoryArtifactText"),content:i.createElement(f.Layout,{className:"text-overflow-ellipsis",start:i.createElement(f.RedbangIcon,null),main:i.createElement(f.Text,{className:"text-overflow-ellipsis",content:t("mandatoryArtifactText"),size:"small",weight:"semibold"})})})})),be=a(34),ye=(a(1170),Object(M.a)()((function(e){var t=e.t,a=i.useState(!1),n=Object(be.a)(a,2),r=n[0],s=n[1],o=i.useState(!1),l=Object(be.a)(o,2),c=l[0],u=l[1],d=function(){u(!0)};return i.createElement(i.Fragment,null,i.createElement("img",{className:"".concat(e.className," ").concat(r&&!c?"event-image-renderer image-loaded":"event-image-renderer image-not-loaded"),src:e.imageSrc,onLoad:function(){s(!0)},onError:d,onAbort:d}),r||c?c?i.createElement(f.Flex,{className:"".concat(e.className," event-image-placeholder-container"),vAlign:"center",hAlign:"center"},i.createElement(f.Flex,{className:"event-image-placeholder",vAlign:"center",hAlign:"center",gap:"gap.small",fill:!0},i.createElement(f.ImageUnavailableIcon,{className:"placeholder-icon"}),i.createElement(f.Text,{content:t("eventCardImageNotFoundPlaceholder"),align:"center",size:"medium",weight:"semibold",color:"white"}))):void 0:i.createElement(f.Flex,{className:"".concat(e.className," event-image-placeholder-container"),vAlign:"center",hAlign:"center"},i.createElement(f.Flex,{className:"event-image-placeholder",vAlign:"center",hAlign:"center",gap:"gap.small",fill:!0},i.createElement(f.Text,{content:t("eventCardImageLoadingPlaceholder"),align:"center",size:"medium",weight:"semibold",color:"white"}))))}))),Ce=a(1257),xe=(a(1171),Object(M.a)()((function(e){var t=e.t,a=function(){var t,a,n,r=[];switch((null===(t=e.eventDetails)||void 0===t?void 0:t.isMandatoryForLoggedInUser)&&r.push(i.createElement(Ee,null)),null===(a=e.eventDetails)||void 0===a?void 0:a.type){case U.Teams:r.push(i.createElement(he,null));break;case U.LiveEvent:r.push(i.createElement(fe,null))}switch(null===(n=e.eventDetails)||void 0===n?void 0:n.audience){case R.Private:r.push(i.createElement(ge,{audienceType:R.Private}));break;case R.Public:r.push(i.createElement(ge,{audienceType:R.Public}))}return i.createElement(f.Flex,{gap:"gap.small",vAlign:"center"},r)},n=function(){switch(e.eventOperationType){case P.CloseRegistration:return t("closeRegistration");case P.CancelEvent:return t("cancelEvent");case P.Register:return t("register");case P.Remove:return t("remove")}};return function(){var r,s,o,l,c,u,d,m;return e.isLoadingEventDetails?i.createElement(f.Provider,null,i.createElement(f.Flex,null,i.createElement("div",{className:"task-module-container"},i.createElement(f.Loader,{className:"task-module-loader"})))):e.isFailedToGetEventDetails||!e.eventDetails?i.createElement(f.Provider,null,i.createElement(f.Flex,null,i.createElement("div",{className:"task-module-container event-task-module"},i.createElement(f.Text,{error:!0,content:t("dataResponseFailedStatus"),weight:"semibold"})))):i.createElement(Ce.a,{dir:e.dir},i.createElement(f.Provider,null,i.createElement(f.Flex,null,i.createElement("div",{className:"".concat(e.isMobileView?"mobile-task-module-container":"task-module-container"," event-task-module")},i.createElement("div",{className:"event-info"},function(){var t,n,r,s;return e.isMobileView?i.createElement(f.Flex,{column:!0,vAlign:"center",gap:"gap.smaller"},i.createElement(f.Text,{className:"category label-color",truncated:!0,content:null===(t=e.eventDetails)||void 0===t?void 0:t.categoryName,title:null===(n=e.eventDetails)||void 0===n?void 0:n.categoryName,weight:"bold"}),i.createElement(f.Flex,{vAlign:"center"},a())):i.createElement(f.Flex,{space:"between",vAlign:"center"},i.createElement(f.Text,{className:"category label-color",truncated:!0,content:null===(r=e.eventDetails)||void 0===r?void 0:r.categoryName,title:null===(s=e.eventDetails)||void 0===s?void 0:s.categoryName,weight:"bold"}),i.createElement(f.Flex.Item,{push:e.dir===Z.Ltr},a()))}(),e.eventDetails.photo&&i.createElement(ye,{className:"event-image",imageSrc:e.eventDetails.photo}),e.eventDetails.selectedColor&&i.createElement("div",{className:"event-image",style:{backgroundColor:e.eventDetails.selectedColor}},i.createElement(f.Flex,{className:"event-image",hAlign:"center",vAlign:"center"},i.createElement(f.Text,{className:"event-color-text",size:"large",weight:"semibold",content:e.eventDetails.name,title:e.eventDetails.name}))),i.createElement("div",{style:{marginTop:"1.33rem"}},i.createElement(f.Text,{align:e.dir===Z.Rtl?"end":"start",className:e.dir===Z.Rtl?"rtl-right-margin-smaller":"",content:null===(r=e.eventDetails)||void 0===r?void 0:r.name,weight:"bold",size:"medium"})),i.createElement(f.Flex,{vAlign:"center",hAlign:"start"},i.createElement(f.Layout,{className:"event-date-and-time",start:i.createElement(q.a,{iconName:"Clock"}),main:i.createElement(f.Text,{content:de(null===(s=e.eventDetails)||void 0===s?void 0:s.startDate,null===(o=e.eventDetails)||void 0===o?void 0:o.startTime,e.eventDetails.endTime),weight:"semibold",size:"small"}),gap:".4rem"}),function(e,t){if(e===U.InPerson)return i.createElement(i.Fragment,null,i.createElement(f.Divider,{vertical:!0,styles:{height:"1.13rem",marginRight:".8rem"}}),i.createElement(f.Text,{className:"event-venue",content:t,weight:"semibold",size:"small"}))}(null===(l=e.eventDetails)||void 0===l?void 0:l.type,null===(c=e.eventDetails)||void 0===c?void 0:c.venue)),i.createElement(f.Flex,{vAlign:"center",hAlign:"start",design:{marginTop:"2.67rem"}},i.createElement(f.Text,{className:e.dir===Z.Rtl?"rtl-right-margin-small":"",content:null===(u=e.eventDetails)||void 0===u?void 0:u.description})),function(){var a,n,r;if((null===(a=e.eventDetails)||void 0===a?void 0:a.type)===U.LiveEvent)return i.createElement(f.Flex,{design:{marginTop:"2.67rem"},vAlign:"center",hAlign:"start",column:!0},i.createElement(f.Text,{content:t("liveEventUrlStep1"),weight:"semibold"}),i.createElement("a",{href:null===(n=e.eventDetails)||void 0===n?void 0:n.meetingLink,target:"_blank",rel:"noopener noreferrer"},null===(r=e.eventDetails)||void 0===r?void 0:r.meetingLink))}(),i.createElement(f.Flex,{gap:e.dir===Z.Rtl?void 0:"gap.large",className:e.dir===Z.Rtl?"rtl-right-margin-small":"",design:{marginTop:"2.67rem"}},i.createElement(f.Flex,{column:!0,className:e.dir===Z.Rtl?"rtl-left-margin-large":""},i.createElement(f.Text,{content:t("totalNoOfParticipants"),weight:"semibold"}),i.createElement(f.Text,{align:e.dir===Z.Rtl?"end":"start",content:null===(d=e.eventDetails)||void 0===d?void 0:d.maximumNumberOfParticipants})),i.createElement(f.Flex,{column:!0},i.createElement(f.Text,{content:t("registeredParticipants"),weight:"semibold"}),i.createElement(f.Text,{align:e.dir===Z.Rtl?"end":"start",content:null===(m=e.eventDetails)||void 0===m?void 0:m.registeredAttendeesCount}))),function(){var a=e.eventCreatedByName&&e.eventCreatedByName.length?e.eventCreatedByName:t("unknownUserName");return i.createElement(f.Flex,{vAlign:"center",hAlign:"start",gap:"gap.smaller",design:{marginTop:"2.67rem"}},i.createElement(f.Avatar,{size:"small",name:a,className:e.dir===Z.Rtl?"rtl-left-margin-small":""}),i.createElement(f.Layout,{start:i.createElement(f.Text,{content:t("createdBy"),size:"small"}),main:i.createElement(f.Text,{content:a,size:"small",weight:"semibold"}),gap:".4rem"}))}()),function(){if(e.eventOperationType!==P.None)return i.createElement(f.Flex,{className:"footer",vAlign:"center"},e.isOperationFailed?i.createElement(f.Text,{error:!0,content:t("dataResponseFailedStatus"),weight:"semibold"}):null,i.createElement(f.Flex.Item,{grow:e.dir===Z.Rtl,push:e.dir===Z.Ltr},i.createElement("div",null,i.createElement(f.Button,{primary:!0,loading:e.isOperationInProgress,disabled:e.isOperationInProgress,content:n(),onClick:e.onPerformOperation}))))}()))))}()}))),Se=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.isMobileView=void 0,n.getEventDetailsAsync=Object(h.a)(g.a.mark((function e(){var t,a,i,s,o,l,c,u;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new URLSearchParams(window.location.search),s=null!==(t=i.get("eventId"))&&void 0!==t?t:"0",o=null!==(a=i.get("teamId"))&&void 0!==a?a:"0",n.isMobileView="true"===i.get("isMobileView"),e.next=6,_(s,o);case 6:(l=e.sent).status===r.OK&&l.data?(c=l.data,u=P.None,c.status===A.Active&&new Date<j.a.utc(c.endDate).local().toDate()&&(c.isLoggedInUserRegistered?u=P.Remove:!c.isRegistrationClosed&&c.registeredAttendeesCount<c.maximumNumberOfParticipants&&c.canLoggedInUserRegister&&(u=P.Register)),n.setState({isLoading:!1,eventDetails:c,eventOperationType:u},(function(){n.state.eventDetails&&n.getUserProfileAsync(n.state.eventDetails.createdBy)}))):n.setState({isLoading:!1,isErrorGettingEventDetails:!0});case 8:case"end":return e.stop()}}),e)}))),n.getUserProfileAsync=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[t],e.next=3,G(a);case 3:(i=e.sent).status===r.OK&&i.data&&(s=i.data[0],n.setState({eventCreatedBy:s.displayName}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onRegisterRemoveEvent=Object(h.a)(g.a.mark((function e(){var t,a,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.setState({isFailedToRegisterOrRemove:!1,isOperationInProgress:!0}),a=n.state.eventDetails?n.state.eventDetails.teamId:"0",i=n.state.eventDetails?n.state.eventDetails.eventId:"0",e.t0=n.state.eventOperationType,e.next=e.t0===P.Register?6:e.t0===P.Remove?10:14;break;case 6:return e.next=8,J(a,i);case 8:return t=e.sent,e.abrupt("break",15);case 10:return e.next=12,Y(a,i);case 12:return t=e.sent,e.abrupt("break",15);case 14:return e.abrupt("break",15);case 15:t&&t.status===r.OK&&!0===t.data?S.tasks.submitTask({isSuccess:!0,type:n.state.eventOperationType}):n.setState({isFailedToRegisterOrRemove:!0,isOperationInProgress:!1});case 16:case"end":return e.stop()}}),e)}))),n.localize=n.props.t,n.isMobileView=!1,n.state={isLoading:!0,isOperationInProgress:!1,eventDetails:void 0,eventCreatedBy:"",isErrorGettingEventDetails:!1,isFailedToRegisterOrRemove:!1,eventOperationType:P.None},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){S.initialize(),this.getEventDetailsAsync()}},{key:"render",value:function(){return i.createElement(xe,{dir:this.props.dir,eventDetails:this.state.eventDetails,eventCreatedByName:this.state.eventCreatedBy,eventOperationType:this.state.eventOperationType,isLoadingEventDetails:this.state.isLoading,isFailedToGetEventDetails:this.state.isErrorGettingEventDetails,isOperationInProgress:this.state.isOperationInProgress,isOperationFailed:this.state.isFailedToRegisterOrRemove,isMobileView:this.isMobileView,onPerformOperation:this.onRegisterRemoveEvent})}}]),a}(i.Component),ke=Object(M.a)()(me(Se));!function(e){e[e.AllPublicPrivateEventsForUser=0]="AllPublicPrivateEventsForUser",e[e.MandatoryEventsForUser=1]="MandatoryEventsForUser",e[e.DraftEventsForTeam=2]="DraftEventsForTeam",e[e.ActiveEventsForTeam=3]="ActiveEventsForTeam",e[e.CompletedEventsForTeam=4]="CompletedEventsForTeam",e[e.RegisteredEventsForUser=5]="RegisteredEventsForUser",e[e.CompletedEventsForUser=7]="CompletedEventsForUser"}(pe||(pe={})),function(e){e[e.Recent=0]="Recent",e[e.Popularity=1]="Popularity"}(ve||(ve={}));var we=a(1242),De=a(1243),Oe=a(1244),Te=a(182),Fe=a.n(Te),Ie=(a(1173),Object(M.a)()((function(e){var t=e.t,a=i.useState(!1),n=Object(be.a)(a,2),r=n[0],s=n[1],o=i.useState(!1),l=Object(be.a)(o,2),c=l[0],u=l[1],d=function(){u(!0)};return i.createElement(i.Fragment,null,i.createElement("img",{className:"".concat(e.className," ").concat(r&&!c?"event-image-renderer image-loaded":"event-image-renderer image-not-loaded"),src:e.imageSrc,onLoad:function(){s(!0)},onError:d,onAbort:d}),r||c?c?i.createElement(f.Flex,{className:"".concat(e.className," event-image-placeholder-container"),vAlign:"center",hAlign:"center"},i.createElement(f.Flex,{className:"event-image-placeholder",vAlign:"center",hAlign:"center",gap:"gap.small",fill:!0},i.createElement(f.ImageUnavailableIcon,{className:"placeholder-icon"}),i.createElement(f.Text,{content:t("eventCardImageNotFoundPlaceholder"),align:"center",size:"medium",weight:"semibold",color:"white"}))):void 0:i.createElement(f.Flex,{className:"".concat(e.className," event-image-placeholder-container"),vAlign:"center",hAlign:"center"},i.createElement(f.Flex,{className:"event-image-placeholder",vAlign:"center",hAlign:"center",gap:"gap.small",fill:!0},i.createElement(f.Text,{content:t("eventCardImageLoadingPlaceholder"),align:"center",size:"medium",weight:"semibold",color:"white"}))))}))),Ne=(a(1174),Object(M.a)()(me((function(e){var t=e.t;return i.createElement(f.Flex,{column:!0,className:"event-card",onClick:e.onClick},e.eventDetails.photo&&i.createElement(Ie,{className:"event-photo",imageSrc:e.eventDetails.photo}),e.eventDetails.selectedColor&&i.createElement("div",{className:"event-photo",style:{backgroundColor:e.eventDetails.selectedColor}},i.createElement(f.Flex,{className:"event-photo",hAlign:"center",vAlign:"center"},i.createElement(f.Text,{className:"event-color-text",size:"medium",weight:"semibold",title:e.eventDetails.name,content:e.eventDetails.name}))),i.createElement(f.Flex,{className:"event-info",column:!0,fill:!0},i.createElement(f.Flex,{vAlign:"center",gap:"gap.medium"},i.createElement(f.Flex,{className:"event-day",column:!0,vAlign:"center",hAlign:"center",fill:!0},i.createElement(f.Text,{content:j.a.utc(e.eventDetails.startDate).local().format("DD"),size:"large",weight:"bold"}),i.createElement(f.Text,{content:j.a.utc(e.eventDetails.startDate).local().format("MMM"),size:"medium",weight:"semibold"})),i.createElement(f.Flex,{className:"event-details",column:!0,vAlign:"center",fill:!0},i.createElement(f.Text,{align:"rtl"===e.dir?"end":void 0,className:"rtl"===e.dir?"event-category rtl-right-margin-small":"event-category",truncated:!0,content:e.eventDetails.categoryName,weight:"bold",size:"smaller"}),i.createElement(f.Text,{align:"rtl"===e.dir?"end":void 0,className:"rtl"===e.dir?"rtl-right-margin-small":"",truncated:!0,content:e.eventDetails.name,title:e.eventDetails.name,weight:"bold",size:"medium"}),i.createElement(f.Flex,{className:"rtl"===e.dir?"event-date-and-venue-rtl event-date-and-venue":"event-date-and-venue",vAlign:"center"},i.createElement(q.a,{iconName:"Clock"}),i.createElement(f.Flex.Item,{shrink:!1},i.createElement(f.Text,{weight:"semibold",size:"small",content:de(e.eventDetails.startDate,e.eventDetails.startTime,e.eventDetails.endTime)})),function(){if(e.eventDetails.type===U.InPerson)return i.createElement(i.Fragment,null,i.createElement(f.Divider,{className:"event-date-venue-separator",vertical:!0}),i.createElement(f.Text,{truncated:!0,className:"event-venue",content:e.eventDetails.venue,title:e.eventDetails.venue,weight:"semibold",size:"small"}))}()))),i.createElement(f.Flex,{className:"event-participants",gap:"gap.small"},i.createElement(f.Text,{size:"small",content:"".concat(t("participantsRegistered")," : ").concat(e.eventDetails.registeredAttendeesCount)}),i.createElement(f.Divider,{vertical:!0}),i.createElement(f.Text,{size:"small",content:"".concat(t("availableSlots")," : ").concat(e.eventDetails.registeredAttendeesCount<e.eventDetails.maximumNumberOfParticipants?e.eventDetails.maximumNumberOfParticipants-e.eventDetails.registeredAttendeesCount:0)})),function(){var t=[];switch(e.eventDetails.isMandatoryForLoggedInUser&&t.push(i.createElement(Ee,null)),e.eventDetails.type){case U.Teams:t.push(i.createElement(he,null));break;case U.LiveEvent:t.push(i.createElement(fe,null))}switch(e.eventDetails.audience){case R.Private:t.push(i.createElement(ge,{audienceType:R.Private}));break;case R.Public:t.push(i.createElement(ge,{audienceType:R.Public}))}return i.createElement(f.Flex,{className:"footer",gap:"gap.small",vAlign:"center"},t)}()))})))),Le=(a(1175),a(1176),function(e){return i.createElement("div",{className:"user-events"},i.createElement("div",{className:"container-subdiv-cardview"},i.createElement(Oe.a,{key:e.key,className:"pagination-scroll-area",fluid:!0},i.createElement(Fe.a,{pageStart:0,initialLoad:!1,loader:i.createElement(f.Loader,null),useWindow:!1,loadMore:e.loadMoreEvents,hasMore:e.hasMoreEvents},function(){if(!e.events||0===e.events.length)return"No events available";var t=e.events.map((function(t,a){return i.createElement(we.a,{className:"grid-column d-flex justify-content-center",xl:4,lg:4,sm:6,md:4},i.createElement(Ne,{key:"event-".concat(a),eventDetails:t,onClick:function(){return e.onClick(t)}}))}));return i.createElement(De.a,{"data-testid":"event_count"},t)}()))))}),Pe=function(e){return i.createElement("div",{className:"no-content-container"},i.createElement("div",{className:"app-logo"},i.createElement(E.EyeIcon,{size:"largest"})),i.createElement("div",{className:"no-content-title"},i.createElement(f.Text,{content:e.message,weight:"semibold"})))},Ae=a(159),ze=a(482),Be=(a(289),i.memo((function(e){var t=Object(ze.a)().t,a=i.useState({checkboxes:e.content.checkboxes}),n=Object(be.a)(a,2),r=n[0],s=(n[1],i.useState(e.content.checkboxes)),o=Object(be.a)(s,2),l=o[0],c=o[1],u=i.useState(""),d=Object(be.a)(u,2),m=d[0],p=d[1],v=i.useState(!0),g=Object(be.a)(v,2),h=g[0],b=g[1],y=i.useState(!1),C=Object(be.a)(y,2),x=C[0],S=C[1];i.useEffect((function(){w(e.content.checkboxes)}),[]);var k=function(t,a){var n=0;S(!0);var i=r.checkboxes.map((function(e){return e.key===t&&(e.isChecked=a),e}));if(i.map((function(e){e.isChecked&&(n+=1)})),b(!(n>0)),m.trim().length){var s=i.filter((function(e){return e.title.toLowerCase().includes(m.toLowerCase())}));w(s)}else w(i);e.onCheckboxStateChange(i)},w=function(e){if(e&&e.length>0){var t=Object(X.a)(e).slice(0,50);c(t)}else c([])};return i.createElement(Ce.a,{dir:e.dir},i.createElement(f.Provider,null,i.createElement("div",{className:"content-items-wrapper"},e.showSearchBar&&i.createElement("div",{className:"content-items-headerfooter"},i.createElement(f.Input,{icon:i.createElement(E.SearchIcon,null),iconPosition:"rtl"===e.dir?"start":"end",placeholder:t("searchPlaceholder"),value:m,fluid:!0,onChange:function(e){return function(e){if(p(e),e.trim().length>0){var t=r.checkboxes.filter((function(t){return t.title.toLowerCase().includes(e.toLowerCase())}));w(t)}else w(r.checkboxes)}(e.target.value)}})),i.createElement(f.Divider,{className:"filter-popup-menu-divider"}),i.createElement("div",{className:"content-items-headerfooter"},i.createElement(f.Flex,{gap:"gap.small",vAlign:"center",hAlign:"end"},i.createElement(f.Flex.Item,{push:!0},i.createElement("div",null)),i.createElement(f.Button,{disabled:x?h:e.disableClear,className:0===e.selectedCount?"clear-button ":"clear-button enable-clear",size:"small",text:!0,onClick:function(){return function(){var t=r.checkboxes.map((function(e){return e.isChecked=!1,e})),a=t;m.trim().length&&(a=t.filter((function(e){return e.title.toLowerCase().includes(m.toLowerCase())}))),w(a),e.onCheckboxStateChange(t),b(!0),S(!0)}()},content:e.selectedCount>0?t("clear")+"("+e.selectedCount.toString()+")":t("clear")}))),i.createElement("div",{className:"content-items-body"},l.map((function(e){if(e.title.trim().length)return i.createElement(f.Flex,{gap:"gap.small"},i.createElement(f.Checkbox,{"data-testid":e.key+"_categoryCheckbox_item",className:"checkbox-wrapper",label:e.checkboxLabel,key:e.key,checked:e.isChecked,onChange:function(t,a){return k(e.key,a.checked)}}))}))))))}))),je=i.memo((function(e){return i.createElement(Ce.a,{dir:e.dir},i.createElement("div",{className:"content-items-wrapper radio-popup-content"},i.createElement("div",{className:"content-items-body"},i.createElement(f.Flex,{gap:"gap.small"},i.createElement(f.RadioGroup,{defaultCheckedValue:e.selectedValue,vertical:!0,items:e.content.radioGroupItems,onCheckedValueChange:function(t,a){return e.onRadiogroupStateChange(a.value)},"data-testid":"radioGroup_items"})))))})),Me=i.memo((function(e){var t=i.useState({isOpen:!1}),a=Object(be.a)(t,2),n=a[0],r=a[1],s=i.useState(!0),o=Object(be.a)(s,2),l=o[0],c=o[1],u=function(t){r({isOpen:t}),e.onOpenChange(t)};return e.checkboxes?i.createElement(f.Popup,{className:"popup-container",open:n.isOpen,align:"end",position:"below",onOpenChange:function(e,t){var a=t.open;return u(a)},trigger:i.createElement(f.Button,{"data-testid":e.checkboxes.length>0?e.checkboxes[0].title+"_CheckboxButton":"dummyTitle_CheckboxButton",className:"filter-button",onClick:function(){return function(){var t=0;e.checkboxes.map((function(e){e.isChecked&&(t+=1)})),c(!(t>0))}()},content:i.createElement(f.Text,{content:e.title,className:e.dir===Z.Rtl?"rtl-left-margin-small":""}),iconPosition:"after",icon:i.createElement(E.ChevronDownIcon,null),text:!0}),content:i.createElement(Be,{dir:e.dir,disableClear:l,selectedCount:e.selectedCount,showSearchBar:e.showSearchBar,content:{checkboxes:e.checkboxes,title:e.title},onCheckboxStateChange:e.onCheckboxStateChange}),trapFocus:!0}):e.radioGroup?i.createElement(f.Popup,{open:n.isOpen,align:"end",position:"below",onOpenChange:function(e,t){var a=t.open;return u(a)},trigger:i.createElement(f.Button,{"data-testid":e.radioGroup.length>0?e.radioGroup[0].name+"_RadioGroupButton":"dummyName_RadioGroupButton",icon:i.createElement(E.ChevronDownIcon,null),className:"filter-button",iconPosition:"after",content:i.createElement(f.Text,{content:e.title,className:e.dir===Z.Rtl?"rtl-left-margin-small":""}),text:!0}),content:i.createElement(je,{dir:e.dir,selectedValue:e.selectedSortBy,content:{radioGroupItems:e.radioGroup,title:e.title},onRadiogroupStateChange:e.onRadiogroupStateChange}),trapFocus:!0}):i.createElement(i.Fragment,null)})),Re=function e(){Object(c.a)(this,e)};Re.dark="dark",Re.contrast="contrast",Re.eventNameMaxLength=100,Re.eventDescriptionMaxLength=1e3,Re.eventVenueMaxLength=200,Re.userEventsMobileFilteredCategoriesLocalStorageKey="user-events-filtered-categories",Re.userEventsMobileFilteredUsersLocalStorageKey="user-events-filtered-users",Re.userEventsMobileSortByFilterLocalStorageKey="user-events-sortby",Re.validUrlRegExp=/^http(s)?:\/\/(www\.)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/,Re.colorCells=[{id:"a",label:"Wild blue yonder",color:"#A4A8CB"},{id:"b",label:"Jasmine",color:"#FFDE85"},{id:"c",label:"Sky blue",color:"#A0EAF8"},{id:"d",label:"Nadeshiko pink",color:"#F1A7B9"},{id:"e",label:"Lavender blue",color:"#E3D7FF"}],Re.audienceType=[{name:"Public",id:R.Public},{name:"Private",id:R.Private}],Re.sortBy=[{name:"Newest",id:ve.Recent,color:""},{name:"Popularity",id:ve.Popularity,color:""}],Re.eventType=[{name:"In person",id:U.InPerson},{name:"Teams",id:U.Teams},{name:"Live event",id:U.LiveEvent}];var Ue,Ve=function(e){return Re.sortBy.map((function(t){switch(t.id){case ve.Recent:return t.name=e("sortByNewest"),t;case ve.Popularity:return t.name=e("sortByPopularity"),t;default:return t}}))},_e=(a(1177),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.isFilterStateChanged=void 0,n.resize=function(){window.innerWidth!==n.state.screenWidth&&n.setState({screenWidth:window.innerWidth})},n.onCategoryStateChange=function(e){var t=null===e||void 0===e?void 0:e.filter((function(e){return e.isChecked}));n.isFilterStateChanged=!0,n.setState({categoryList:e,categorySelectedCount:t?t.length:0})},n.onCreatedByStateChange=function(e){var t=null===e||void 0===e?void 0:e.filter((function(e){return e.isChecked}));n.isFilterStateChanged=!0,n.setState({createdByList:e,createdBySelectedCount:t?t.length:0})},n.onSortByStateChange=function(e){n.isFilterStateChanged=!0,n.setState({selectedSortBy:e})},n.onCloseIconClick=function(e){n.props.onFilterBarCloseClick(n.state.categorySelectedCount>0||n.state.createdBySelectedCount>0||n.state.selectedSortBy!==ve.Recent),n.isFilterStateChanged=!1},n.onFilterChange=function(e){if(!e&&n.isFilterStateChanged){var t=n.state.categoryList?Object(X.a)(n.state.categoryList):[],a=n.state.createdByList?Object(X.a)(n.state.createdByList):[],r=t.filter((function(e){return e.isChecked})),i=a.filter((function(e){return e.isChecked})),s=r.map((function(e){return e.key})),o=i.map((function(e){return e.key}));n.isFilterStateChanged=!1,n.props.onFilterChange(s,o,n.state.selectedSortBy)}else n.isFilterStateChanged=!1},Object(Ae.a)(),n.localize=n.props.t,n.isFilterStateChanged=!1;var r=Ve(n.localize).map((function(e){return{key:e.id,label:e.name,value:e.id,name:e.name}}));return n.state={selectedSortBy:r[0].value,categoryList:[],createdByList:[],sortBy:r,screenWidth:800,createdBySelectedCount:0,categorySelectedCount:0},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resize.bind(this)),this.resize()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize.bind(this))}},{key:"componentWillReceiveProps",value:function(e){if(e.isReset){var t=this.state.categoryList?Object(X.a)(this.state.categoryList):[],a=this.state.createdByList?Object(X.a)(this.state.createdByList):[];this.isFilterStateChanged=!1,this.setState({categoryList:t.map((function(e){return e.isChecked=!1,e})),categorySelectedCount:0,createdByList:a.map((function(e){return e.isChecked=!1,e})),createdBySelectedCount:0,selectedSortBy:ve.Recent})}e.categoryList&&e.categoryList!==this.props.categoryList&&this.setState({categoryList:e.categoryList.map((function(e){return{isChecked:!1,key:e.categoryId,title:e.name,checkboxLabel:i.createElement(f.Text,{content:e.name})}}))}),e.createdByList&&e.createdByList!==this.props.createdByList&&this.setState({createdByList:e.createdByList.map((function(e){return{isChecked:!1,key:e.aadObjectId,title:e.name,checkboxLabel:i.createElement(f.Text,{content:e.name})}}))})}},{key:"render",value:function(){return this.props.isVisible?i.createElement(Ce.a,{dir:this.props.dir},i.createElement(f.Flex,{className:"filter-bar","data-testid":"filterbar"},this.state.screenWidth>750&&i.createElement(f.Flex,{gap:"gap.small",vAlign:"center",className:"filter-bar-wrapper",space:"between"},i.createElement("div",{className:"filter-bar-item-container"},i.createElement(f.Text,{content:this.localize("category"),weight:"semibold",className:"title-text"}),i.createElement(Me,{dir:this.props.dir,title:this.state.categorySelectedCount>0?this.state.categorySelectedCount+" "+this.localize("selected"):this.localize("selectHere"),showSearchBar:!0,selectedSortBy:this.state.selectedSortBy,selectedCount:this.state.categorySelectedCount,checkboxes:this.state.categoryList,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCategoryStateChange,onOpenChange:this.onFilterChange}),i.createElement(f.Text,{content:this.localize("createdBy"),weight:"semibold",className:"title-text"}),i.createElement(Me,{dir:this.props.dir,title:this.state.createdBySelectedCount>0?this.state.createdBySelectedCount+" "+this.localize("selected"):this.localize("selectHere"),showSearchBar:!0,selectedSortBy:this.state.selectedSortBy,checkboxes:this.state.createdByList,selectedCount:this.state.createdBySelectedCount,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCreatedByStateChange,onOpenChange:this.onFilterChange}),i.createElement(f.Text,{content:this.localize("sortBy"),weight:"semibold",className:"title-text"}),i.createElement(Me,{dir:this.props.dir,title:this.state.sortBy[this.state.selectedSortBy].name,selectedSortBy:this.state.selectedSortBy,selectedCount:this.state.createdBySelectedCount,radioGroup:this.state.sortBy,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCreatedByStateChange,onOpenChange:this.onFilterChange})),i.createElement(f.Flex.Item,{push:this.props.dir===Z.Ltr},i.createElement(E.CloseIcon,{onClick:this.onCloseIconClick,className:this.props.dir===Z.Rtl?"close-icon rtl-left-margin-small":"close-icon"}))),this.state.screenWidth<=750&&i.createElement(f.Flex,{gap:"gap.small",vAlign:"start",className:"filter-bar-wrapper"},i.createElement(f.Flex.Item,{grow:!0},i.createElement(f.Flex,{column:!0,gap:"gap.small",vAlign:"stretch"},i.createElement(f.Flex,{className:"mobile-filterbar-wrapper"},i.createElement(Me,{dir:this.props.dir,title:this.state.categorySelectedCount>0?this.state.categorySelectedCount+" "+this.localize("selected"):this.localize("selectHere"),showSearchBar:!0,selectedSortBy:this.state.selectedSortBy,selectedCount:this.state.categorySelectedCount,checkboxes:this.state.categoryList,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCategoryStateChange,onOpenChange:this.onFilterChange}),i.createElement(Me,{dir:this.props.dir,title:this.state.createdBySelectedCount>0?this.state.createdBySelectedCount+" "+this.localize("selected"):this.localize("selectHere"),showSearchBar:!0,selectedSortBy:this.state.selectedSortBy,selectedCount:this.state.createdBySelectedCount,checkboxes:this.state.createdByList,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCreatedByStateChange,onOpenChange:this.onFilterChange}),i.createElement(Me,{dir:this.props.dir,title:this.state.sortBy[this.state.selectedSortBy].name,selectedCount:this.state.createdBySelectedCount,selectedSortBy:this.state.selectedSortBy,radioGroup:this.state.sortBy,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCreatedByStateChange,onOpenChange:this.onFilterChange}))))))):i.createElement(i.Fragment,null)}}]),a}(i.Component)),We=Object(M.a)()(me(_e)),Ke=(a(1178),function(e){return i.createElement(f.Flex,{className:"tab-menu"},i.createElement(f.Menu,{primary:!0,items:e.tabItems,defaultActiveIndex:e.defaultTabIndex,activeIndex:e.activeTabIndex,onActiveIndexChange:function(t,a){return e.onTabIndexChange(a)}}))});!function(e){e[e.None=0]="None",e[e.Success=1]="Success",e[e.Error=2]="Error"}(Ue||(Ue={}));var Ge=a(1252),He=(a(1179),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.onClose=function(){n.setState({isShowNotification:!1})},n.localize=n.props.t,n.state={isShowNotification:!1},n}return Object(u.a)(a,[{key:"componentWillReceiveProps",value:function(e){var t;e.notification.id!==this.props.notification.id&&(null===(t=e.notification.message)||void 0===t?void 0:t.length)&&e.notification.type!==Ue.None&&this.setState({isShowNotification:!0})}},{key:"render",value:function(){return i.createElement(Ge.a,{className:"notification-toast ".concat(this.props.notification.type===Ue.Success?"success":"error"),autohide:!0,delay:4e3,show:this.state.isShowNotification,onClose:this.onClose},i.createElement(Ge.a.Body,{className:this.props.dir===Z.Ltr?"notification":"rtl-notification"},i.createElement("strong",null,this.props.notification.message)))}}]),a}(i.Component)),Qe=Object(M.a)()(He),Je=window.location.origin+"/api",Ye=function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(Je,"/LnDTeam"),e.next=3,D.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),qe=function(){localStorage.removeItem(Re.userEventsMobileFilteredCategoriesLocalStorageKey),localStorage.removeItem(Re.userEventsMobileFilteredUsersLocalStorageKey),localStorage.removeItem(Re.userEventsMobileSortByFilterLocalStorageKey)},Ze=(a(1180),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.searchText=void 0,n.timeout=void 0,n.mandatoryEventsCount=void 0,n.allEventsCount=void 0,n.screenResize=function(){n.setState({isMobileView:window.innerWidth<=O.maxWidthForMobileView})},n.loadEventCategories=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie();case 2:(a=e.sent)&&a.status===r.OK&&(null===(t=a.data)||void 0===t?void 0:t.length)>0&&n.setState({categoriesInFilter:a.data});case 4:case"end":return e.stop()}}),e)}))),n.loadAllLnDTeamMembers=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye();case 2:(a=e.sent)&&a.status===r.OK&&(null===(t=a.data)||void 0===t?void 0:t.length)>0&&n.setState({lnDTeamMembersInFilter:a.data});case 4:case"end":return e.stop()}}),e)}))),n.getEventsAsync=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,i,s,o,l=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=l.length>1&&void 0!==l[1]?l[1]:0,t!==pe.MandatoryEventsForUser){e.next=7;break}return e.next=4,Q(n.state.searchText,i,pe.MandatoryEventsForUser,n.state.filteredUsers,n.state.filteredCategories,n.state.sortByFilter);case 4:s=e.sent,e.next=10;break;case 7:return e.next=9,Q(n.state.searchText,i,pe.AllPublicPrivateEventsForUser,n.state.filteredUsers,n.state.filteredCategories,n.state.sortByFilter);case 9:s=e.sent;case 10:return o=[],s&&s.status===r.OK&&(null===(a=s.data)||void 0===a?void 0:a.length)>0&&(o=s.data),e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.loadEvents=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,r,i,s,o,l,c,u,d=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.length>1&&void 0!==d[1]?d[1]:0,e.next=3,n.getEventsAsync(t,a);case 3:if(!(r=e.sent)){e.next=15;break}e.t0=t,e.next=e.t0===pe.MandatoryEventsForUser?8:e.t0===pe.AllPublicPrivateEventsForUser?10:12;break;case 8:return a>0?(i=Object(X.a)(r),s=Object(X.a)(n.state.mandatoryEvents),o=i.filter((function(e){return-1===s.findIndex((function(t){return t.eventId===e.eventId}))})),n.setState({mandatoryEvents:s.concat(o),hasMoreEvents:!(r.length<O.lazyLoadEventsCount)})):(n.setTotalEventsCount(pe.MandatoryEventsForUser,r.length),n.setState({mandatoryEvents:Object(X.a)(r),hasMoreEvents:!(r.length<O.lazyLoadEventsCount)})),e.abrupt("break",13);case 10:return a>0?(l=Object(X.a)(r),c=Object(X.a)(n.state.allEvents),u=l.filter((function(e){return-1===c.findIndex((function(t){return t.eventId===e.eventId}))})),n.setState({allEvents:c.concat(u),hasMoreEvents:!(r.length<O.lazyLoadEventsCount)})):(n.setTotalEventsCount(pe.AllPublicPrivateEventsForUser,r.length),n.setState({allEvents:Object(X.a)(r),hasMoreEvents:!(r.length<O.lazyLoadEventsCount)})),e.abrupt("break",13);case 12:return e.abrupt("break",13);case 13:e.next=16;break;case 15:0===a?(n.setTotalEventsCount(t,0),t===pe.MandatoryEventsForUser?n.setState({mandatoryEvents:[],hasMoreEvents:!1}):n.setState({allEvents:[],hasMoreEvents:!1})):n.setState({hasMoreEvents:!1});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.setTotalEventsCount=function(e,t){var a,r;if((!n.state.searchText||""===n.state.searchText.trim())&&!(null===(a=n.state.filteredCategories)||void 0===a?void 0:a.length)&&!(null===(r=n.state.filteredUsers)||void 0===r?void 0:r.length))switch(e){case pe.MandatoryEventsForUser:n.mandatoryEventsCount=t;break;case pe.AllPublicPrivateEventsForUser:n.allEventsCount=t}},n.onEventClick=function(e){n.props.microsoftTeams.tasks.startTask({url:"".concat(window.location.origin,"/register-remove?eventId=").concat(e.eventId,"&teamId=").concat(e.teamId,"&isMobileView=").concat(n.state.isMobileView),height:746,width:600,title:n.localize("eventDetailsStep1")},(function(t,a){if(a){var r=0===n.state.activeTabIndex?Object(X.a)(n.state.mandatoryEvents):Object(X.a)(n.state.allEvents),i=null===r||void 0===r?void 0:r.findIndex((function(t){return t.eventId===e.eventId})),s=r[i];s.registeredAttendeesCount=a.type===P.Register?s.registeredAttendeesCount+1:s.registeredAttendeesCount-1,0===n.state.activeTabIndex?n.setState((function(e){return{mandatoryEvents:r,notification:{id:e.notification.id+1,message:a.type===P.Register?n.localize("eventRegistrationSuccessfulMessage"):n.localize("eventUnregistrationSuccessfulMessage"),type:Ue.Success}}})):n.setState((function(e){return{allEvents:r,notification:{id:e.notification.id+1,message:a.type===P.Register?n.localize("eventRegistrationSuccessfulMessage"):n.localize("eventUnregistrationSuccessfulMessage"),type:Ue.Success}}}))}}))},n.onTabIndexChange=function(e){n.timeout&&window.clearTimeout(n.timeout),qe(),n.setState({isLoadingEvents:!0,activeTabIndex:null===e||void 0===e?void 0:e.activeIndex,searchText:"",filteredCategories:"",filteredUsers:"",sortByFilter:ve.Recent,isResetFilter:!0},(function(){n.timeout=window.setTimeout(Object(h.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e&&n.getEvents();case 1:case"end":return t.stop()}}),t)}))),700)}))},n.onSearchEvents=function(e){13===e.keyCode&&""!==n.state.searchText.trim()&&n.getEvents()},n.onSearchTextChange=function(e){e.target.value.length?n.setState({searchText:e.target.value}):n.setState({searchText:""},(function(){n.getEvents()}))},n.onFilterBarToggle=function(){n.setState((function(e){return{isFilterOpen:!e.isFilterOpen,isResetFilter:!1}}))},n.onMobileFilterButtonClick=function(){n.props.microsoftTeams.tasks.startTask({url:"".concat(window.location.origin,"/mobile-filter"),height:746,width:600,title:n.localize("mobileFilterTitle")},(function(e,t){if(t&&t.isFilterStateChanged){var a=localStorage.getItem(Re.userEventsMobileFilteredCategoriesLocalStorageKey),r=localStorage.getItem(Re.userEventsMobileFilteredUsersLocalStorageKey),i=localStorage.getItem(Re.userEventsMobileSortByFilterLocalStorageKey);n.setState({filteredCategories:a||"",filteredUsers:r||"",sortByFilter:i||0},(function(){return n.getEvents()}))}}))},n.onFilterBarClose=function(e){n.setState((function(e){return{isFilterOpen:!e.isFilterOpen,filteredCategories:"",filteredUsers:"",sortByFilter:ve.Recent,isResetFilter:!0}}),(function(){e&&n.getEvents()}))},n.onFilterChange=function(e,t,a){var r=e||[],i=t||[];n.setState({filteredCategories:r.join(";"),filteredUsers:i.join(";"),sortByFilter:a},(function(){n.getEvents()}))},n.onMobileSearchBoxClose=function(){var e;n.setState({isMobileSearchBoxOpen:!n.state.isMobileSearchBoxOpen}),(null===(e=n.state.searchText)||void 0===e?void 0:e.trim().length)&&n.setState({searchText:""},(function(){return n.getEvents()}))},n.getEvents=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(0===e&&n.setState((function(e){return{isLoadingEvents:!0,hasMoreEvents:!1,userEventsContainerKey:e.userEventsContainerKey+1,isResetFilter:!1}})),n.state.activeTabIndex){case 0:n.loadEvents(pe.MandatoryEventsForUser,e).finally((function(){n.setState({isLoadingEvents:!1})}));break;case 1:n.loadEvents(pe.AllPublicPrivateEventsForUser,e).finally((function(){n.setState({isLoadingEvents:!1})}));break;default:n.setState({isLoadingEvents:!1})}},n.formatEventsCount=function(e){return-1===e?"":e<O.lazyLoadEventsCount?"(".concat(e,")"):"(".concat(O.lazyLoadEventsCount,"+)")},n.renderTabMenuItems=function(){return[{key:"mandatory-user-events",content:"".concat(n.localize("mandatoryEventsTab")," ").concat(n.formatEventsCount(n.mandatoryEventsCount))},{key:"all-user-events",content:"".concat(n.localize("allEventsTab")," ").concat(n.formatEventsCount(n.allEventsCount))}]},n.renderEvents=function(){if(n.state.isLoadingEvents)return i.createElement(f.Provider,null,i.createElement(f.Loader,{className:"loader"}));var e=[];return 0===n.state.activeTabIndex?e=Object(X.a)(n.state.mandatoryEvents):1===n.state.activeTabIndex&&(e=Object(X.a)(n.state.allEvents)),e&&0!==e.length?i.createElement(f.Flex,{className:n.state.isFilterOpen?"filter-open":void 0},i.createElement(Le,{key:"discover-events-".concat(n.state.userEventsContainerKey),events:e,hasMoreEvents:n.state.hasMoreEvents,loadMoreEvents:n.getEvents,onClick:n.onEventClick})):i.createElement(Pe,{message:n.localize("eventsNotAvailable")})},n.renderFilterButtonIcon=function(){return n.state.filteredCategories&&n.state.filteredCategories.length>0||n.state.filteredUsers&&n.state.filteredUsers.length>0?i.createElement(q.a,{iconName:"FilterSolid"}):i.createElement(q.a,{iconName:"Filter"})},n.renderDesktopView=function(){return i.createElement(Ce.a,{dir:n.props.dir},i.createElement(f.Flex,{column:!0},i.createElement(f.Flex,{space:"between",vAlign:"center"},i.createElement(Ke,{defaultTabIndex:0,activeTabIndex:n.state.activeTabIndex,tabItems:n.renderTabMenuItems(),onTabIndexChange:n.onTabIndexChange}),i.createElement(f.Flex.Item,{push:n.props.dir===Z.Ltr},i.createElement(f.Flex,{gap:"gap.medium",vAlign:"center"},i.createElement(f.MenuButton,{className:n.props.dir===Z.Rtl?"rtl-left-margin-medium":"",trigger:i.createElement(f.Button,{icon:n.renderFilterButtonIcon(),content:n.localize("filterButtonText"),onClick:n.onFilterBarToggle,"data-testid":"filterbutton"})}),i.createElement(f.Input,{inverted:!0,value:n.state.searchText,icon:i.createElement(f.SearchIcon,null),iconPosition:n.props.dir===Z.Rtl?"start":"end",placeholder:n.localize("searchForEventsPlaceholder"),input:{design:{minWidth:"20rem",maxWidth:"20rem"}},onKeyUp:n.onSearchEvents,onChange:n.onSearchTextChange,"data-testid":"search_input"})))),i.createElement(We,{isVisible:n.state.isFilterOpen,isReset:n.state.isResetFilter,categoryList:n.state.categoriesInFilter,createdByList:n.state.lnDTeamMembersInFilter,onFilterBarCloseClick:n.onFilterBarClose,onFilterChange:n.onFilterChange})),n.renderEvents())},n.renderMobileView=function(){return i.createElement(Ce.a,{dir:n.props.dir},i.createElement(f.Flex,{column:!0},i.createElement(f.Flex,{space:"between"},i.createElement(Ke,{defaultTabIndex:0,activeTabIndex:n.state.activeTabIndex,tabItems:n.renderTabMenuItems(),onTabIndexChange:n.onTabIndexChange}),i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Flex,{gap:"gap.medium",vAlign:"center"},i.createElement(f.MenuButton,{trigger:i.createElement(f.Button,{text:!0,iconOnly:!0,icon:n.renderFilterButtonIcon(),onClick:n.onMobileFilterButtonClick})}),i.createElement(f.SearchIcon,{onClick:function(){return n.setState({isMobileSearchBoxOpen:!n.state.isMobileSearchBoxOpen})}})))),n.state.isMobileSearchBoxOpen&&!n.state.isFilterOpen&&i.createElement(f.Flex,{className:"search-box",vAlign:"center",gap:"gap.small"},i.createElement(f.Input,{inverted:!0,fluid:!0,value:n.state.searchText,placeholder:n.localize("searchForEventsPlaceholder"),input:{design:{minWidth:"20rem",width:"100rem"}},onKeyUp:n.onSearchEvents,onChange:n.onSearchTextChange}),i.createElement(f.Flex.Item,{push:!0},i.createElement(f.CloseIcon,{className:"close-searchbox-icon",onClick:n.onMobileSearchBoxClose})))),!n.state.isFilterOpen&&n.renderEvents())},n.searchText="",n.localize=n.props.t,n.timeout=null,n.mandatoryEventsCount=-1,n.allEventsCount=-1,n.state={mandatoryEvents:[],allEvents:[],hasMoreEvents:!1,userEventsContainerKey:0,isLoadingEvents:!0,activeTabIndex:0,isFilterOpen:!1,searchText:"",filteredCategories:"",filteredUsers:"",sortByFilter:ve.Recent,categoriesInFilter:[],lnDTeamMembersInFilter:[],isResetFilter:!1,notification:{id:0,message:"",type:Ue.None},isMobileView:!1,isMobileSearchBoxOpen:!1},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.screenResize.bind(this)),this.screenResize(),this.loadEventCategories(),this.loadAllLnDTeamMembers(),qe();var t=this.getEventsAsync(pe.MandatoryEventsForUser),a=this.getEventsAsync(pe.AllPublicPrivateEventsForUser);Promise.all([t,a]).then((function(t){e.setTotalEventsCount(pe.MandatoryEventsForUser,t[0].length),e.setTotalEventsCount(pe.AllPublicPrivateEventsForUser,t[1].length)})).finally((function(){e.getEvents()}))}},{key:"render",value:function(){return i.createElement("div",{className:"container-div"},i.createElement("div",{className:"discover-events-container"},this.state.isMobileView?this.renderMobileView():this.renderDesktopView(),i.createElement(Qe,{dir:this.props.dir,notification:this.state.notification})))}}]),a}(i.Component)),$e=Object(M.a)()(me(Ze)),Xe=(a(1181),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).teamId=void 0,n.localize=void 0,n.searchText=void 0,n.timeout=void 0,n.registeredEventsCount=void 0,n.completedEventsCount=void 0,n.resize=function(){n.setState({isMobileView:window.innerWidth<=O.maxWidthForMobileView})},n.loadEventCategories=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie();case 2:(a=e.sent)&&a.status===r.OK&&(null===(t=a.data)||void 0===t?void 0:t.length)>0&&n.setState({categoriesInFilter:a.data});case 4:case"end":return e.stop()}}),e)}))),n.loadAllLnDTeamMembers=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye();case 2:(a=e.sent)&&a.status===r.OK&&(null===(t=a.data)||void 0===t?void 0:t.length)>0&&n.setState({lnDTeamMembersInFilter:a.data});case 4:case"end":return e.stop()}}),e)}))),n.getEventsAsync=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,i,s,o,l=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=l.length>1&&void 0!==l[1]?l[1]:0,t!==pe.RegisteredEventsForUser){e.next=7;break}return e.next=4,Q(n.state.searchText,i,pe.RegisteredEventsForUser,n.state.filteredUsers,n.state.filteredCategories,n.state.sortByFilter);case 4:s=e.sent,e.next=10;break;case 7:return e.next=9,Q(n.state.searchText,i,pe.CompletedEventsForUser,n.state.filteredUsers,n.state.filteredCategories,n.state.sortByFilter);case 9:s=e.sent;case 10:return o=[],s&&s.status===r.OK&&(null===(a=s.data)||void 0===a?void 0:a.length)>0&&(o=s.data),e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.loadEvents=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,r,i,s,o,l,c,u,d=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.length>1&&void 0!==d[1]?d[1]:0,e.next=3,n.getEventsAsync(t,a);case 3:if(!(r=e.sent)){e.next=14;break}e.t0=t,e.next=e.t0===pe.RegisteredEventsForUser?8:e.t0===pe.CompletedEventsForUser?10:11;break;case 8:return a>0?(i=Object(X.a)(r),s=Object(X.a)(n.state.registeredEvents),o=i.filter((function(e){return-1===s.findIndex((function(t){return t.eventId===e.eventId}))})),n.setState({registeredEvents:s.concat(o),hasMoreEvents:!(r.length<O.lazyLoadEventsCount)})):(n.setTotalEventsCount(pe.RegisteredEventsForUser,r.length),n.setState({registeredEvents:Object(X.a)(r),hasMoreEvents:!(r.length<O.lazyLoadEventsCount)})),e.abrupt("break",12);case 10:a>0?(l=Object(X.a)(r),c=Object(X.a)(n.state.completedEvents),u=l.filter((function(e){return-1===c.findIndex((function(t){return t.eventId===e.eventId}))})),n.setState({completedEvents:c.concat(u),hasMoreEvents:!(r.length<O.lazyLoadEventsCount)})):(n.setTotalEventsCount(pe.CompletedEventsForUser,r.length),n.setState({completedEvents:Object(X.a)(r),hasMoreEvents:!(r.length<O.lazyLoadEventsCount)}));case 11:return e.abrupt("break",12);case 12:e.next=15;break;case 14:0===a?(n.setTotalEventsCount(t,0),t===pe.RegisteredEventsForUser?n.setState({registeredEvents:[],hasMoreEvents:!1}):n.setState({completedEvents:[],hasMoreEvents:!1})):n.setState({hasMoreEvents:!1});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.setTotalEventsCount=function(e,t){var a,r;if((!n.state.searchText||""===n.state.searchText.trim())&&!(null===(a=n.state.filteredCategories)||void 0===a?void 0:a.length)&&!(null===(r=n.state.filteredUsers)||void 0===r?void 0:r.length))switch(e){case pe.RegisteredEventsForUser:n.registeredEventsCount=t;break;case pe.CompletedEventsForUser:n.completedEventsCount=t}},n.onEventClick=function(e){n.props.microsoftTeams.tasks.startTask({url:"".concat(window.location.origin,"/register-remove?eventId=").concat(e.eventId,"&teamId=").concat(e.teamId,"&isMobileView=").concat(n.state.isMobileView),height:746,width:600,title:n.localize("eventDetailsStep1")},(function(t,a){if(a&&a.isSuccess){var r=(n.state.registeredEvents?Object(X.a)(n.state.registeredEvents):[]).filter((function(t){return t.eventId!==e.eventId}));n.registeredEventsCount-=1,n.setState((function(e){return{registeredEvents:r,notification:{id:e.notification.id+1,message:a.type===P.Register?n.localize("eventRegistrationSuccessfulMessage"):n.localize("eventUnregistrationSuccessfulMessage"),type:Ue.Success}}}))}}))},n.onTabIndexChange=function(e){n.timeout&&window.clearTimeout(n.timeout),qe(),n.setState({isLoadingEvents:!0,activeTabIndex:null===e||void 0===e?void 0:e.activeIndex,searchText:"",filteredCategories:"",filteredUsers:"",sortByFilter:ve.Recent,isResetFilter:!0},(function(){n.timeout=window.setTimeout(Object(h.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e&&n.getEvents();case 1:case"end":return t.stop()}}),t)}))),700)}))},n.onSearchEvents=function(e){13===e.keyCode&&""!==n.state.searchText.trim()&&n.getEvents()},n.onSearchTextChange=function(e){e.target.value.length?n.setState({searchText:e.target.value}):n.setState({searchText:""},(function(){n.getEvents()}))},n.onFilterBarToggle=function(){n.setState((function(e){return{isFilterOpen:!e.isFilterOpen,isResetFilter:!1}}))},n.onMobileFilterButtonClick=function(){n.props.microsoftTeams.tasks.startTask({url:"".concat(window.location.origin,"/mobile-filter"),height:746,width:600,title:n.localize("mobileFilterTitle")},(function(e,t){if(t&&t.isFilterStateChanged){var a=localStorage.getItem(Re.userEventsMobileFilteredCategoriesLocalStorageKey),r=localStorage.getItem(Re.userEventsMobileFilteredUsersLocalStorageKey),i=localStorage.getItem(Re.userEventsMobileSortByFilterLocalStorageKey);n.setState({filteredCategories:a||"",filteredUsers:r||"",sortByFilter:i||0},(function(){return n.getEvents()}))}}))},n.onFilterBarClose=function(e){n.setState((function(e){return{isFilterOpen:!e.isFilterOpen,filteredCategories:"",filteredUsers:"",sortByFilter:ve.Recent,isResetFilter:!0}}),(function(){e&&n.getEvents()}))},n.onFilterChange=function(e,t,a){var r=e||[],i=t||[];n.setState({filteredCategories:r.join(";"),filteredUsers:i.join(";"),sortByFilter:a},(function(){n.getEvents()}))},n.onMobileSearchBoxClose=function(){var e;n.setState({isMobileSearchBoxOpen:!n.state.isMobileSearchBoxOpen}),(null===(e=n.state.searchText)||void 0===e?void 0:e.trim().length)&&n.setState({searchText:""},(function(){return n.getEvents()}))},n.getEvents=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(0===e&&n.setState((function(e){return{isLoadingEvents:!0,hasMoreEvents:!1,userEventsContainerKey:e.userEventsContainerKey+1,isResetFilter:!1}})),n.state.activeTabIndex){case 0:n.loadEvents(pe.RegisteredEventsForUser,e).finally((function(){n.setState({isLoadingEvents:!1})}));break;case 1:n.loadEvents(pe.CompletedEventsForUser,e).finally((function(){n.setState({isLoadingEvents:!1})}));break;default:n.setState({isLoadingEvents:!1})}},n.formatEventsCount=function(e){return-1===e?"":e<O.lazyLoadEventsCount?"(".concat(e,")"):"(".concat(O.lazyLoadEventsCount,"+)")},n.renderTabMenuItems=function(){return[{key:"registered-user-events",content:"".concat(n.localize("registeredEventsTab")," ").concat(n.formatEventsCount(n.registeredEventsCount))},{key:"completed-user-events",content:"".concat(n.localize("completedEventsTab")," ").concat(n.formatEventsCount(n.completedEventsCount))}]},n.renderEvents=function(){if(n.state.isLoadingEvents)return i.createElement(f.Provider,null,i.createElement(f.Loader,{className:"loader"}));var e=[];return 0===n.state.activeTabIndex?e=Object(X.a)(n.state.registeredEvents):1===n.state.activeTabIndex&&(e=Object(X.a)(n.state.completedEvents)),e&&0!==e.length?i.createElement(f.Flex,{className:n.state.isFilterOpen?"filter-open":void 0},i.createElement(Le,{key:"my-events-".concat(n.state.userEventsContainerKey),events:e,hasMoreEvents:n.state.hasMoreEvents,loadMoreEvents:n.getEvents,onClick:n.onEventClick})):i.createElement(Pe,{message:n.localize("eventsNotAvailable")})},n.renderFilterButtonIcon=function(){return n.state.filteredCategories&&n.state.filteredCategories.length>0||n.state.filteredUsers&&n.state.filteredUsers.length>0?i.createElement(q.a,{iconName:"FilterSolid"}):i.createElement(q.a,{iconName:"Filter"})},n.renderDesktopView=function(){return i.createElement(Ce.a,{dir:n.props.dir},i.createElement(f.Flex,{column:!0},i.createElement(f.Flex,{space:"between",vAlign:"center"},i.createElement(Ke,{defaultTabIndex:0,activeTabIndex:n.state.activeTabIndex,tabItems:n.renderTabMenuItems(),onTabIndexChange:n.onTabIndexChange}),i.createElement(f.Flex.Item,{push:n.props.dir===Z.Ltr},i.createElement(f.Flex,{gap:"gap.medium",vAlign:"center"},i.createElement(f.MenuButton,{className:n.props.dir===Z.Rtl?"rtl-left-margin-medium":"",trigger:i.createElement(f.Button,{icon:n.renderFilterButtonIcon(),content:n.localize("filterButtonText"),onClick:n.onFilterBarToggle,"data-testid":"filterbutton"})}),i.createElement(f.Input,{inverted:!0,value:n.state.searchText,icon:i.createElement(f.SearchIcon,null),iconPosition:n.props.dir===Z.Rtl?"start":"end",placeholder:n.localize("searchForEventsPlaceholder"),input:{design:{minWidth:"20rem",maxWidth:"20rem"}},onKeyUp:n.onSearchEvents,onChange:n.onSearchTextChange,"data-testid":"search_input"})))),i.createElement(We,{isVisible:n.state.isFilterOpen,isReset:n.state.isResetFilter,categoryList:n.state.categoriesInFilter,createdByList:n.state.lnDTeamMembersInFilter,onFilterBarCloseClick:n.onFilterBarClose,onFilterChange:n.onFilterChange})),n.renderEvents())},n.renderMobileView=function(){return i.createElement(Ce.a,{dir:n.props.dir},i.createElement(f.Flex,{column:!0},i.createElement(f.Flex,{space:"between"},i.createElement(Ke,{defaultTabIndex:0,activeTabIndex:n.state.activeTabIndex,tabItems:n.renderTabMenuItems(),onTabIndexChange:n.onTabIndexChange}),i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Flex,{gap:"gap.medium",vAlign:"center"},i.createElement(f.MenuButton,{trigger:i.createElement(f.Button,{text:!0,iconOnly:!0,icon:n.renderFilterButtonIcon(),onClick:n.onMobileFilterButtonClick})}),i.createElement(f.SearchIcon,{onClick:function(){return n.setState({isMobileSearchBoxOpen:!n.state.isMobileSearchBoxOpen})}})))),n.state.isMobileSearchBoxOpen&&!n.state.isFilterOpen&&i.createElement(f.Flex,{className:"search-box",vAlign:"center",gap:"gap.small"},i.createElement(f.Input,{inverted:!0,fluid:!0,value:n.state.searchText,placeholder:n.localize("searchForEventsPlaceholder"),input:{design:{minWidth:"20rem",width:"100rem"}},onKeyUp:n.onSearchEvents,onChange:n.onSearchTextChange}),i.createElement(f.Flex.Item,{push:!0},i.createElement(f.CloseIcon,{className:"close-searchbox-icon",onClick:n.onMobileSearchBoxClose})))),!n.state.isFilterOpen&&n.renderEvents())},n.teamId="",n.searchText="",n.localize=n.props.t,n.timeout=null,n.registeredEventsCount=-1,n.completedEventsCount=-1,n.state={registeredEvents:[],completedEvents:[],hasMoreEvents:!1,userEventsContainerKey:0,isLoadingEvents:!0,activeTabIndex:0,isFilterOpen:!1,searchText:"",filteredCategories:"",filteredUsers:"",sortByFilter:ve.Recent,categoriesInFilter:[],lnDTeamMembersInFilter:[],isResetFilter:!1,notification:{id:0,message:"",type:Ue.None},isMobileView:!1,isMobileSearchBoxOpen:!1},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.resize.bind(this)),this.resize(),this.loadEventCategories(),this.loadAllLnDTeamMembers(),qe();var t=this.getEventsAsync(pe.RegisteredEventsForUser),a=this.getEventsAsync(pe.CompletedEventsForUser);Promise.all([t,a]).then((function(t){e.setTotalEventsCount(pe.RegisteredEventsForUser,t[0].length),e.setTotalEventsCount(pe.CompletedEventsForUser,t[1].length)})).finally((function(){e.getEvents()}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize.bind(this))}},{key:"render",value:function(){return i.createElement("div",{className:"container-div"},i.createElement("div",{className:"my-events-container"},this.state.isMobileView?this.renderMobileView():this.renderDesktopView(),i.createElement(Qe,{dir:this.props.dir,notification:this.state.notification})))}}]),a}(i.Component)),et=Object(M.a)()(me(Xe)),tt=(a(290),i.memo((function(e){var t=Object(ze.a)().t,a=i.useState({checkboxes:e.content.checkboxes}),n=Object(be.a)(a,2),r=n[0],s=(n[1],i.useState(e.content.checkboxes)),o=Object(be.a)(s,2),l=o[0],c=o[1],u=i.useState(""),d=Object(be.a)(u,2),m=d[0],p=d[1],v=i.useState(!0),g=Object(be.a)(v,2),h=g[0],b=g[1],y=i.useState(!1),C=Object(be.a)(y,2),x=C[0],S=C[1];i.useEffect((function(){w(e.content.checkboxes)}),[]);var k=function(t,a){S(!0);var n=r.checkboxes.map((function(e){return e.key===t&&(e.isChecked=a),e})),i=n.reduce((function(e,t){return t.isChecked?e+1:e}),0);b(i<=0);var s=n;m.trim().length&&(s=n.filter((function(e){return e.title.toLowerCase().includes(m.toLowerCase())}))),w(s),e.onCheckboxStateChange(n)},w=function(e){e||(e=[]);var t=Object(X.a)(e).slice(0,50);c(t)};return e.isOpen?i.createElement(f.Provider,null,i.createElement("div",{className:"accordion-content-items-wrapper"},e.showSearchBar&&i.createElement("div",{className:"accordion-content-items-headerfooter"},i.createElement(f.Input,{icon:i.createElement(E.SearchIcon,null),placeholder:t("searchPlaceholder"),value:m,fluid:!0,onChange:function(e){return function(e){if(p(e),e.trim().length>0){var t=r.checkboxes.filter((function(t){return!0===t.title.toLowerCase().includes(e.toLowerCase())}));w(t)}else w(r.checkboxes)}(e.target.value)}})),i.createElement(f.Divider,{className:"accordion-filter-popup-menu-divider"}),i.createElement("div",{className:"accordion-content-items-headerfooter"},i.createElement(f.Flex,{gap:"gap.small",vAlign:"center",hAlign:"end"},i.createElement(f.Flex.Item,{push:!0},i.createElement("div",null)),i.createElement(f.Button,{disabled:x?h:e.disableClear,className:0===e.selectedCount?"clear-button ":"clear-button enable-clear",size:"small",text:!0,onClick:function(){return function(){var t=r.checkboxes.map((function(e){return e.isChecked=!1,e})),a=t;m.trim().length&&(a=t.filter((function(e){return e.title.toLowerCase().includes(m.toLowerCase())}))),w(a),e.onCheckboxStateChange(t),b(!0),S(!0)}()},content:e.selectedCount>0?t("clear")+"("+e.selectedCount.toString()+")":t("clear")}))),i.createElement("div",{className:"accordion-content-items-body"},l.map((function(e){if(e.title.trim().length)return i.createElement(f.Flex,{gap:"gap.small"},i.createElement(f.Checkbox,{className:"checkbox-wrapper",label:e.checkboxLabel,key:e.key,checked:e.isChecked,onChange:function(t,a){return k(e.key,a.checked)}}))}))))):i.createElement(i.Fragment,null)}))),at=i.memo((function(e){return e.isOpen?i.createElement(i.Fragment,null,i.createElement("div",{className:"accordion-content-items-wrapper radio-popup-content"},i.createElement("div",{className:"accordion-content-items-body"},i.createElement(f.Flex,{gap:"gap.small"},i.createElement(f.RadioGroup,{defaultCheckedValue:e.selectedValue,vertical:!0,items:e.content.radioGroupItems,onCheckedValueChange:function(t,a){return e.onRadiogroupStateChange(a.value)}}))))):i.createElement(i.Fragment,null)})),nt=i.memo((function(e){var t=i.useState(!1),a=Object(be.a)(t,2),n=a[0],r=a[1],s=function(){r(!n),e.onFilterOpenChange(!n)};return e.checkboxes?i.createElement("div",{className:"accordion-container"},i.createElement("div",{className:"accordion-main",onClick:function(){return s()}},i.createElement(f.Flex,null,i.createElement(f.Flex.Item,null,i.createElement(f.Text,{content:e.title})),i.createElement(f.Flex.Item,{push:!0},i.createElement(E.ChevronDownIcon,null)))),i.createElement(tt,{isOpen:e.isFilterOpen,disableClear:0===e.selectedCount,selectedCount:e.selectedCount,showSearchBar:e.showSearchBar,content:{checkboxes:e.checkboxes,title:e.title},onCheckboxStateChange:e.onCheckboxStateChange})):e.radioGroup?i.createElement("div",{className:"accordion-container"},i.createElement("div",{className:"accordion-main",onClick:function(){return s()}},i.createElement(f.Flex,null,i.createElement(f.Flex.Item,null,i.createElement(f.Text,{content:e.title})),i.createElement(f.Flex.Item,{push:!0},i.createElement(E.ChevronDownIcon,null)))),i.createElement(at,{isOpen:e.isFilterOpen,selectedValue:e.selectedSortBy,content:{radioGroupItems:e.radioGroup,title:e.title},onRadiogroupStateChange:e.onRadiogroupStateChange})):i.createElement(i.Fragment,null)})),rt=(a(1182),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.sortByList=[],n.isFilterStateChanged=void 0,n.loadEventCategories=Object(h.a)(g.a.mark((function e(){var t,a,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie();case 2:(a=e.sent)&&a.status===r.OK&&(null===(t=a.data)||void 0===t?void 0:t.length)>0&&a&&a.status===r.OK&&(null===(s=a.data)||void 0===s?void 0:s.length)>0&&n.setState({categoryList:a.data.map((function(e){return{isChecked:!1,key:e.categoryId,title:e.name,checkboxLabel:i.createElement(f.Text,{content:e.name})}}))});case 4:case"end":return e.stop()}}),e)}))),n.loadAllLnDTeamMembers=Object(h.a)(g.a.mark((function e(){var t,a,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye();case 2:(a=e.sent)&&a.status===r.OK&&(null===(t=a.data)||void 0===t?void 0:t.length)>0&&a&&a.status===r.OK&&(null===(s=a.data)||void 0===s?void 0:s.length)>0&&n.setState({createdByList:a.data.map((function(e){return{isChecked:!1,key:e.aadObjectId,title:e.name,checkboxLabel:i.createElement(f.Text,{content:e.name})}}))});case 4:case"end":return e.stop()}}),e)}))),n.loadFilterItems=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.loadEventCategories(),a=n.loadAllLnDTeamMembers(),Promise.all([t,a]).finally((function(){var e=localStorage.getItem(Re.userEventsMobileFilteredCategoriesLocalStorageKey),t=localStorage.getItem(Re.userEventsMobileFilteredUsersLocalStorageKey),a=localStorage.getItem(Re.userEventsMobileSortByFilterLocalStorageKey),r=Object(X.a)(n.state.categoryList),i=0;if((null===e||void 0===e?void 0:e.trim().length)&&(null===r||void 0===r?void 0:r.length)>0)for(var s=r.filter((function(t){return e&&e.indexOf(t.key)>-1})),o=0;o<s.length;o++)s[o].isChecked=!0,i+=1;var l=Object(X.a)(n.state.createdByList),c=0;if((null===t||void 0===t?void 0:t.trim().length)&&(null===l||void 0===l?void 0:l.length)>0)for(var u=l.filter((function(e){return t&&t.indexOf(e.key)>-1})),d=0;d<u.length;d++)u[d].isChecked=!0,c+=1;var m=n.state.selectedSortBy;if(null===a||void 0===a?void 0:a.trim().length){var p,v=null===(p=n.sortByList)||void 0===p?void 0:p.find((function(e){return e.key.toString()===(null===a||void 0===a?void 0:a.trim())}));v&&(m=v.key)}n.setState({categoryList:r,categorySelectedCount:i,createdByList:l,createdBySelectedCount:c,selectedSortBy:m,isLoading:!1})}));case 3:case"end":return e.stop()}}),e)}))),n.resize=function(){window.innerWidth!==n.state.screenWidth&&n.setState({screenWidth:window.innerWidth})},n.onCategoryStateChange=function(e){var t=null===e||void 0===e?void 0:e.filter((function(e){return e.isChecked}));n.setState({categoryList:e,categorySelectedCount:t&&t.length},(function(){return n.isFilterStateChanged=!0}))},n.onCreatedByStateChange=function(e){var t=null===e||void 0===e?void 0:e.filter((function(e){return e.isChecked}));n.setState({createdByList:e,createdBySelectedCount:t?t.length:0},(function(){return n.isFilterStateChanged=!0}))},n.onSortByStateChange=function(e){n.setState({selectedSortBy:e},(function(){return n.isFilterStateChanged=!0}))},n.onCloseIconClick=function(){if(n.state.searchText.trim().length>0&&n.setState({searchText:""}),n.state.categoryList.filter((function(e){return e.isChecked})).length){var e=n.state.categoryList.map((function(e){return e.isChecked=!1,e}));n.setState({categoryList:e})}if(n.state.createdByList.filter((function(e){return e.isChecked})).length){var t=n.state.createdByList.map((function(e){return e.isChecked=!1,e}));n.setState({createdByList:t})}n.setState({selectedSortBy:n.sortByList[0].value})},n.onCategoriesFilterOpenStateChange=function(e){e?n.setState({isCategoriesFilterOpen:!0,isCreatedByFilterOpen:!1,isSortByFilterOpen:!1}):n.setState({isCategoriesFilterOpen:!1})},n.onCreatedByFilterOpenStateChange=function(e){e?n.setState({isCategoriesFilterOpen:!1,isCreatedByFilterOpen:!0,isSortByFilterOpen:!1}):n.setState({isCreatedByFilterOpen:!1})},n.onSortByFilterOpenStateChange=function(e){e?n.setState({isCategoriesFilterOpen:!1,isCreatedByFilterOpen:!1,isSortByFilterOpen:!0}):n.setState({isSortByFilterOpen:!1})},n.onClearFilter=function(){var e=n.state.categoryList?Object(X.a)(n.state.categoryList):[],t=n.state.createdByList?Object(X.a)(n.state.createdByList):[];n.setState({categoryList:e.map((function(e){return e.isChecked=!1,e})),categorySelectedCount:0,createdByList:t.map((function(e){return e.isChecked=!1,e})),createdBySelectedCount:0,selectedSortBy:ve.Recent},(function(){n.isFilterStateChanged=!0}))},n.onApplyFilter=function(){var e=(n.state.categoryList?Object(X.a)(n.state.categoryList):[]).filter((function(e){return e.isChecked})).map((function(e){return e.key}));localStorage.setItem(Re.userEventsMobileFilteredCategoriesLocalStorageKey,e.join(";"));var t=(n.state.createdByList?Object(X.a)(n.state.createdByList):[]).filter((function(e){return e.isChecked})).map((function(e){return e.key}));localStorage.setItem(Re.userEventsMobileFilteredUsersLocalStorageKey,t.join(";")),localStorage.setItem(Re.userEventsMobileSortByFilterLocalStorageKey,n.state.selectedSortBy.toString()),n.props.microsoftTeams.tasks.submitTask({isFilterStateChanged:n.isFilterStateChanged})},Object(Ae.a)(),n.localize=n.props.t,n.sortByList=Ve(n.localize).map((function(e){return{key:e.id,label:e.name,value:e.id,name:e.name}})),n.isFilterStateChanged=!1,n.state={selectedSortBy:n.sortByList[0].value,categoryList:[],createdByList:[],searchText:"",screenWidth:800,createdBySelectedCount:0,categorySelectedCount:0,isLoading:!0,isCategoriesFilterOpen:!1,isCreatedByFilterOpen:!1,isSortByFilterOpen:!1},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.loadFilterItems(),window.addEventListener("resize",this.resize.bind(this)),this.resize()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize.bind(this))}},{key:"render",value:function(){return this.state.isLoading?i.createElement(f.Provider,null,i.createElement(f.Loader,{className:"loader"})):i.createElement(f.Provider,{className:"mobile-filter-bar-container"},i.createElement(f.Flex,{className:"mobile-filter-buttons"},i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Flex,{gap:"gap.small",vAlign:"center"},i.createElement(f.Button,{content:this.localize("mobileFilterClearButtonText"),onClick:this.onClearFilter}),i.createElement(f.Button,{primary:!0,content:this.localize("mobileFilterApplyButtonText"),onClick:this.onApplyFilter})))),i.createElement(f.Flex,{className:"filter-bar mobile-filter-wrapper"},i.createElement("div",{className:"menu-wrapper"},i.createElement(nt,{isFilterOpen:this.state.isCategoriesFilterOpen,title:"".concat(this.localize("category")," ").concat(this.state.categorySelectedCount>0?"(".concat(this.state.categorySelectedCount," ").concat(this.localize("selected"),")"):""),showSearchBar:!0,selectedSortBy:this.state.selectedSortBy,selectedCount:this.state.categorySelectedCount,checkboxes:this.state.categoryList,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCategoryStateChange,onFilterOpenChange:this.onCategoriesFilterOpenStateChange}),i.createElement(nt,{isFilterOpen:this.state.isCreatedByFilterOpen,title:"".concat(this.localize("createdBy")," ").concat(this.state.createdBySelectedCount>0?"(".concat(this.state.createdBySelectedCount," ").concat(this.localize("selected"),")"):""),showSearchBar:!0,selectedSortBy:this.state.selectedSortBy,selectedCount:this.state.createdBySelectedCount,checkboxes:this.state.createdByList,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCreatedByStateChange,onFilterOpenChange:this.onCreatedByFilterOpenStateChange}),i.createElement(nt,{isFilterOpen:this.state.isSortByFilterOpen,title:this.sortByList[this.state.selectedSortBy].name,selectedCount:this.state.createdBySelectedCount,selectedSortBy:this.state.selectedSortBy,radioGroup:this.sortByList,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCreatedByStateChange,onFilterOpenChange:this.onSortByFilterOpenStateChange}))))}}]),a}(i.Component)),it=Object(M.a)()(me(rt)),st=Object(M.a)()((function(e){var t=e.t,a=[{icon:i.createElement(f.EditIcon,{outline:!0}),content:t("editEventInformation"),onClick:function(){return e.onEditEvent(e.eventDetails.eventId)}},{icon:i.createElement(f.ArrowDownIcon,null),content:t("exportRegistrationDetails"),onClick:function(){return e.onExportDetails(e.eventDetails.eventId,e.eventDetails.name)}},{icon:i.createElement(f.BellIcon,{outline:!0}),content:t("sendReminder"),onClick:function(){return e.onSendReminder(e.eventDetails.eventId)}},{kind:"divider"},{icon:i.createElement(f.CloseIcon,{outline:!0}),content:t("cancelEvent"),onClick:function(){return e.onCancelEvent(e.eventDetails.eventId)}}],n=[{icon:i.createElement(f.EditIcon,{outline:!0}),content:t("editEventInformation"),onClick:function(){return e.onEditEvent(e.eventDetails.eventId)}},{kind:"divider"},{icon:i.createElement(f.CloseIcon,{outline:!0}),content:t("deleteDraft"),onClick:function(){return e.onDeleteDraftEvent(e.eventDetails.eventId,e.eventDetails.name)}}],r=[{icon:i.createElement(f.ArrowDownIcon,null),content:t("exportRegistrationDetails"),onClick:function(){return e.onExportDetails(e.eventDetails.eventId,e.eventDetails.name)}}];return i.createElement(f.MenuButton,{trigger:i.createElement(f.Button,{text:!0,iconOnly:!0,icon:i.createElement(f.MoreIcon,null)}),menu:{items:function(){switch(e.eventDetails.status){case A.Draft:return n;case A.Active:return new Date<j.a.utc(e.eventDetails.endDate).local().toDate()?(e.eventDetails.isRegistrationClosed||a.unshift({icon:i.createElement(f.UserFriendsIcon,{outline:!0}),content:t("closeRegistration"),onClick:function(){return e.onCloseRegistration(e.eventDetails.eventId)}}),a):r}}()},position:"before",className:e.dir===Z.Rtl?"ltr-direction":""})})),ot=function(){var e=Object(h.a)(g.a.mark((function e(t,a,n,r){var i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="".concat(O.apiBaseURL,"/EventWorkflow"),s=V({searchString:encodeURIComponent(t),eventSearchType:n,teamId:r,pageCount:a}),e.next=4,D.get(i,s);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),lt=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/Event"),r=V({eventId:t,teamId:a}),e.next=4,D.get(n,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ct=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/EventWorkflow/CloseEventRegistrations"),r=V({eventId:a,teamId:t}),e.next=4,D.patch(n,null,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ut=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/EventWorkflow/CancelEvent"),r=V({eventId:a,teamId:t}),e.next=4,D.patch(n,null,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),dt=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/EventWorkflow/delete-draft"),r=V({eventId:a,teamId:t}),e.next=4,D.delete(n,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),mt=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/eventfiles/ExportEventDetailsToCSV"),r=V({eventId:a,teamId:t}),e.next=4,D.get(n,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),pt=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/EventWorkflow/SendReminder"),r=V({eventId:a,teamId:t}),e.next=4,D.post(n,null,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),vt=(a(470),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.draftEventsCount=void 0,n.completedEventsCount=void 0,n.activeEventsCount=void 0,n.teamId=void 0,n.timeout=void 0,n.eventsScrollAreaRef=void 0,n.componentWillReceiveProps=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.teamsContext===t.teamsContext){e.next=18;break}if(!t.teamsContext){e.next=18;break}if(n.teamId=t.teamsContext.teamId,-1!==n.activeEventsCount||-1!==n.draftEventsCount||-1!==n.completedEventsCount){e.next=18;break}return n.activeEventsCount=n.draftEventsCount=n.completedEventsCount=0,e.next=7,n.getEventsAsync(0,pe.ActiveEventsForTeam);case 7:return a=e.sent,e.next=10,n.getEventsAsync(0,pe.DraftEventsForTeam);case 10:return r=e.sent,e.next=13,n.getEventsAsync(0,pe.CompletedEventsForTeam);case 13:i=e.sent,n.setTotalEventsCount(pe.ActiveEventsForTeam,a.length),n.setTotalEventsCount(pe.DraftEventsForTeam,r.length),n.setTotalEventsCount(pe.CompletedEventsForTeam,i.length),n.getEvents();case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getEventsAsync=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ot(n.state.searchText,t,a,n.teamId);case 2:return i=e.sent,s=[],i&&i.status===r.OK&&i.data&&(s=i.data),e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.loadEvents=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var r,i,s,o,l;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getEventsAsync(t,a);case 2:if(!(r=e.sent)){e.next=16;break}i=!(r.length<O.lazyLoadEventsCount),e.t0=a,e.next=e.t0===pe.DraftEventsForTeam?8:e.t0===pe.CompletedEventsForTeam?10:12;break;case 8:return 0===t?(n.setTotalEventsCount(pe.DraftEventsForTeam,r.length),n.setState({draftEvents:Object(X.a)(r),loadMoreEvents:i})):(s=Object(X.a)(n.state.draftEvents),n.setState({draftEvents:[].concat(Object(X.a)(s),Object(X.a)(r)),loadMoreEvents:i})),e.abrupt("break",14);case 10:return 0===t?(n.setTotalEventsCount(pe.CompletedEventsForTeam,r.length),n.setState({completedEvents:Object(X.a)(r),loadMoreEvents:i})):(o=Object(X.a)(n.state.completedEvents),n.setState({completedEvents:[].concat(Object(X.a)(o),Object(X.a)(r)),loadMoreEvents:i})),e.abrupt("break",14);case 12:return 0===t?(n.setTotalEventsCount(pe.ActiveEventsForTeam,r.length),n.setState({activeEvents:Object(X.a)(r),loadMoreEvents:i})):(l=Object(X.a)(n.state.activeEvents),n.setState({activeEvents:[].concat(Object(X.a)(l),Object(X.a)(r)),loadMoreEvents:i})),e.abrupt("break",14);case 14:e.next=18;break;case 16:0===t&&n.setTotalEventsCount(a,0),n.setState({loadMoreEvents:!1});case 18:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.setTotalEventsCount=function(e,t){if(!n.state.searchText||""===n.state.searchText.trim())switch(e){case pe.DraftEventsForTeam:n.draftEventsCount=t;break;case pe.CompletedEventsForTeam:n.completedEventsCount=t;break;case pe.ActiveEventsForTeam:n.activeEventsCount=t}},n.getEvents=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(0===e&&n.setState((function(e){return{isLoading:!0,loadMoreEvents:!1,infiniteScrollKey:e.infiniteScrollKey+1}})),n.state.activeTabIndex){case 0:n.loadEvents(e,pe.DraftEventsForTeam).finally((function(){n.setState({isLoading:!1})}));break;case 2:n.loadEvents(e,pe.CompletedEventsForTeam).finally((function(){n.setState({isLoading:!1})}));break;default:n.loadEvents(e,pe.ActiveEventsForTeam).finally((function(){n.setState({isLoading:!1})}))}},n.formatEventDateAndTime=function(e){if(e){var t=j.a.utc(e.startDate).local().format("DD MMM YYYY"),a=j.a.utc(e.startTime).local().format("HH:mm"),n=j.a.utc(e.endTime).local().format("HH:mm");return"".concat(t,", ").concat(a," - ").concat(n)}return""},n.onTabMenuIndexChange=function(e){n.timeout&&window.clearTimeout(n.timeout),n.setState({isLoading:!0,searchText:"",activeTabIndex:n.state.isMobileView?null===e||void 0===e?void 0:e.index:null===e||void 0===e?void 0:e.activeIndex}),n.timeout=window.setTimeout(Object(h.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e&&n.getEvents();case 1:case"end":return t.stop()}}),t)}))),700)},n.onCloseRegistration=function(e){n.props.microsoftTeams.tasks.startTask({title:n.localize("closeRegistration"),height:746,width:600,url:"".concat(window.location.origin,"/close-or-cancel-event?operationType=").concat(P.CloseRegistration,"&eventId=").concat(e,"&teamId=").concat(n.teamId,"&isMobileView=").concat(n.state.isMobileView)},(function(e,t){t&&n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("closeRegistrationSuccessfulMessage"),type:Ue.Success}}}))}))},n.onEditEvent=function(e){n.props.microsoftTeams.tasks.startTask({title:n.localize("editEvent"),height:746,width:600,url:"".concat(window.location.origin,"/create-event?eventId=").concat(e,"&isDraft=").concat(0===n.state.activeTabIndex)},(function(e,t){t&&(t.isSuccess?n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("updateEventSuccessfulMessage"),type:Ue.Success},activeTabIndex:t.isCreateEvent?1:e.activeTabIndex}}),(function(){window.setTimeout((function(){return n.getEvents()}),2e3)})):n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("updateEventFailureMessage"),type:Ue.Error}}})))}))},n.onSendReminder=function(){var e=Object(h.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pt(n.teamId,t);case 2:e.sent.status===r.OK?n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("sendReminderSuccessfulMessage"),type:Ue.Success}}})):n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("sendReminderFailureMessage"),type:Ue.Error}}}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onCancelEvent=function(e){n.props.microsoftTeams.tasks.startTask({title:n.localize("cancelEvent"),height:746,width:600,url:"".concat(window.location.origin,"/close-or-cancel-event?operationType=").concat(P.CancelEvent,"&eventId=").concat(e,"&teamId=").concat(n.teamId,"&isMobileView=").concat(n.state.isMobileView)},(function(t,a){if(a){var r=(n.state.activeEvents?Object(X.a)(n.state.activeEvents):[]).filter((function(t){return t.eventId!==e}));n.activeEventsCount-=1,n.setState((function(e){return{activeEvents:r,notification:{id:e.notification.id+1,message:n.localize("cancelEventSuccessfulMessage"),type:Ue.Success}}}))}}))},n.onDeleteDraftEvent=function(e,t){n.props.microsoftTeams.tasks.startTask({title:n.localize("deleteEvent"),height:200,width:400,url:"".concat(window.location.origin,"/delete-draft?eventId=").concat(e,"&teamId=").concat(n.teamId)},(function(t,a){if(a){var r=(n.state.draftEvents?Object(X.a)(n.state.draftEvents):[]).filter((function(t){return t.eventId!==e}));n.draftEventsCount-=1,n.setState((function(e){return{draftEvents:r,notification:{id:e.notification.id+1,message:n.localize("deleteDraftEvent"),type:Ue.Success}}}))}}))},n.onExportDetails=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var i,s,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt(n.teamId,t);case 2:(i=e.sent).status===r.OK?(s=window.URL.createObjectURL(new Blob(["\ufeff",i.data],{type:"text/csv;charset=utf-8"})),(o=document.createElement("a")).href=s,o.setAttribute("download","".concat(a,".csv")),o.click(),n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("exportDetailsSuccessfulMessage"),type:Ue.Success}}}))):n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("exportDetailsFailureMessage"),type:Ue.Error}}}));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.onSearchEvents=function(e){var t;13===e.keyCode&&(null===(t=n.state.searchText)||void 0===t?void 0:t.length)&&""!==n.state.searchText.trim()&&n.getEvents()},n.onSearchTextChange=function(e){e.target.value.length?n.setState({searchText:e.target.value}):n.setState({searchText:""},(function(){n.getEvents()}))},n.formatEventsCount=function(e){return-1===e?"":e<O.lazyLoadEventsCount?"(".concat(e,")"):"(".concat(O.lazyLoadEventsCount,"+)")},n.getTabMenuItems=function(){return[{key:"draft-events",content:"".concat(n.localize("draftEvents")," ").concat(n.formatEventsCount(n.draftEventsCount))},{key:"active-events",content:"".concat(n.localize("activeEvents")," ").concat(n.formatEventsCount(n.activeEventsCount))},{key:"completed-events",content:"".concat(n.localize("completedEvents")," ").concat(n.formatEventsCount(n.completedEventsCount))}]},n.onEventCreated=function(e,t){var a;t&&(t.isSuccess?n.setState((function(e){return{notification:{id:e.notification.id+1,message:t.isDraft?n.localize("createDraftSuccessfulMessage"):n.localize("createEventSuccessfulMessage"),type:Ue.Success},activeTabIndex:t.isDraft?0:1}}),(function(){window.setTimeout((function(){return n.getEvents()}),2e3)})):n.setState((function(e){return{notification:{id:e.notification.id+1,message:t.isDraft?n.localize("createDraftFailureMessage"):n.localize("createEventFailureMessage"),type:Ue.Error}}}))),null===(a=n.props.microsoftTeams)||void 0===a||a.getContext((function(e){n.teamId=e.teamId}))},n.onManageCategoriesClick=function(){n.props.microsoftTeams.tasks.startTask({title:n.localize("manageCategories"),height:600,width:900,url:"".concat(window.location.origin,"/manage-categories")},(function(){}))},n.onCreateEventsClick=function(){n.props.microsoftTeams.tasks.startTask({title:n.localize("createEvent"),height:746,width:600,url:"".concat(window.location.origin,"/create-event")},n.onEventCreated)},n.onMobileSearchBoxClose=function(){var e;n.setState({isMobileSearchBoxOpen:!n.state.isMobileSearchBoxOpen}),(null===(e=n.state.searchText)||void 0===e?void 0:e.trim().length)&&n.setState({searchText:""},(function(){return n.getEvents()}))},n.getEventsTableHeader=function(){return{items:[{content:n.localize("eventTitle")},{content:n.localize("dateAndTime"),design:{minWidth:"17vw",maxWidth:"17vw"}},{content:n.localize("venue"),design:{minWidth:"17vw",maxWidth:"17vw"}},{content:n.localize("noOfRegistrations"),design:{minWidth:"12vw",maxWidth:"12vw"}},{content:n.localize("category"),design:{minWidth:"15vw",maxWidth:"15vw"}},{design:{minWidth:"5vw",maxWidth:"5vw"}}]}},n.getEventType=function(e){return e.type===U.InPerson?e.venue:e.type===U.LiveEvent?n.localize("liveEvent"):n.localize("teamsMeeting")},n.renderMobileView=function(){return i.createElement("div",{className:"container-manage-events"},i.createElement(f.Flex,null,i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Flex,{gap:"gap.small"},i.createElement(f.Button,{primary:!0,content:n.localize("manageCategories"),onClick:n.onManageCategoriesClick}),i.createElement(f.Button,{primary:!0,content:n.localize("createEvent"),onClick:n.onCreateEventsClick})))),i.createElement(f.Flex,{className:"mobile-menu-manage-events",space:"between",vAlign:"center"},i.createElement(f.SplitButton,{button:n.getTabMenuItems()[n.state.activeTabIndex],menu:{activeIndex:n.state.activeTabIndex,items:n.getTabMenuItems()},onMenuItemClick:function(e,t){return n.onTabMenuIndexChange(t)},style:{width:"40rem !important"},className:"split-button"}),i.createElement(f.Flex.Item,{push:!0},i.createElement(f.SearchIcon,{onClick:n.onMobileSearchBoxClose}))),n.state.isMobileSearchBoxOpen&&i.createElement(f.Flex,{className:"manage-events-mobile-search-box",vAlign:"center",gap:"gap.small"},i.createElement(f.Input,{inverted:!0,fluid:!0,placeholder:n.localize("searchForEventsPlaceholder"),input:{design:{minWidth:"20rem",width:"100rem"}},onKeyUp:n.onSearchEvents,onChange:n.onSearchTextChange}),i.createElement(f.Flex.Item,{push:!0},i.createElement(f.CloseIcon,{onClick:n.onMobileSearchBoxClose}))),n.state.isLoading?i.createElement(f.Loader,{className:"loader"}):i.createElement("div",{key:n.state.infiniteScrollKey,className:"manage-events-scroll-area-mobile"},i.createElement(Fe.a,{pageStart:0,loadMore:n.getEvents,hasMore:n.state.loadMoreEvents,initialLoad:!1,loader:i.createElement("div",null,i.createElement(f.Loader,null)),useWindow:!1},n.renderEvents())))},n.renderDesktopView=function(){return i.createElement("div",{className:"container-manage-events"},i.createElement(f.Flex,{space:"between",vAlign:"center"},i.createElement(Ke,{tabItems:n.getTabMenuItems(),defaultTabIndex:1,activeTabIndex:n.state.activeTabIndex,onTabIndexChange:n.onTabMenuIndexChange}),i.createElement(f.Flex.Item,{push:n.props.dir===Z.Ltr},i.createElement(f.Flex,{gap:"gap.medium",vAlign:"center"},i.createElement(f.Input,{inverted:!0,value:n.state.searchText,icon:i.createElement(f.SearchIcon,null),iconPosition:n.props.dir===Z.Rtl?"start":"end",placeholder:n.localize("searchForEventsPlaceholder"),input:{design:{minWidth:"20rem",maxWidth:"20rem"}},onKeyUp:n.onSearchEvents,onChange:n.onSearchTextChange}),i.createElement(f.Flex,{gap:"gap.small"},i.createElement(f.Button,{content:n.localize("manageCategories"),onClick:n.onManageCategoriesClick}),i.createElement(f.Button,{className:n.props.dir===Z.Rtl?"rtl-right-margin-medium":"",icon:i.createElement(f.AddIcon,null),primary:!0,content:i.createElement(f.Text,{className:n.props.dir===Z.Rtl?"rtl-right-margin-small":"",content:n.localize("createEvent")}),onClick:n.onCreateEventsClick}))))),n.state.isLoading?i.createElement(f.Loader,{className:"loader"}):i.createElement("div",{key:n.state.infiniteScrollKey,className:"manage-events-scroll-area"},i.createElement(Fe.a,{pageStart:0,loadMore:n.getEvents,hasMore:n.state.loadMoreEvents,initialLoad:!1,loader:i.createElement("div",null,i.createElement(f.Loader,null)),useWindow:!1},n.renderEvents())))},n.localize=n.props.t,n.teamId="",n.timeout=null,n.draftEventsCount=-1,n.completedEventsCount=-1,n.activeEventsCount=-1,n.eventsScrollAreaRef=null,n.state={activeTabIndex:1,draftEvents:[],activeEvents:[],completedEvents:[],isLoading:!0,infiniteScrollKey:0,loadMoreEvents:!1,isInitialLoadComplete:!1,isMobileView:!1,notification:{id:0,message:"",type:Ue.None},searchText:"",isMobileSearchBoxOpen:!1},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onScreenSizeChange.bind(this)),this.onScreenSizeChange()}},{key:"onScreenSizeChange",value:function(){this.setState({isMobileView:window.innerWidth<=O.maxWidthForMobileView})}},{key:"renderEvents",value:function(){var e,t=this,a=[];if(0===this.state.activeTabIndex?a=Object(X.a)(this.state.draftEvents):2===this.state.activeTabIndex?a=Object(X.a)(this.state.completedEvents):1===this.state.activeTabIndex&&(a=Object(X.a)(this.state.activeEvents)),(null===(e=a)||void 0===e?void 0:e.length)>0){if(this.state.isMobileView){var n=a.map((function(e,a){return{key:"event-".concat(a),content:i.createElement("div",{className:"manage-events-list-item-container"},i.createElement(f.Flex,{space:"between"},i.createElement(f.Flex,{column:!0},i.createElement(f.Text,{content:e.name,weight:"bold",className:"list-header"}),i.createElement(f.Flex,{className:"list-elements",vAlign:"center"},i.createElement(f.Text,{className:"category-name",content:e.categoryName,weight:"semibold"}),i.createElement(f.Text,{content:"|",weight:"semibold",className:"divider"}),i.createElement(f.Text,{content:e.type===U.InPerson?e.venue:t.localize("teamsMeeting"),weight:"semibold"})),i.createElement(f.Text,{className:"list-elements",content:t.formatEventDateAndTime(e)}),i.createElement(f.Text,{className:"list-elements",content:"".concat(t.localize("noOfRegistrations"),": ").concat(e.registeredAttendeesCount,"/").concat(e.maximumNumberOfParticipants)})),i.createElement(f.Flex.Item,{push:!0},e.status===A.Cancelled?i.createElement(f.Button,{disabled:!0,text:!0,iconOnly:!0,icon:i.createElement(f.MoreIcon,null)}):i.createElement(st,{eventDetails:e,onCancelEvent:t.onCancelEvent,onCloseRegistration:t.onCloseRegistration,onEditEvent:t.onEditEvent,onExportDetails:t.onExportDetails,onSendReminder:t.onSendReminder,onDeleteDraftEvent:t.onDeleteDraftEvent,dir:t.props.dir}))))}}));return i.createElement(f.List,{className:"manage-events-mobile-list-view",items:n})}var r=a.map((function(e){var a=t.getEventType(e),n=t.formatEventDateAndTime(e);return{key:"row-".concat(e.eventId),items:[{content:i.createElement(f.Text,{error:e.status===A.Cancelled,content:e.name+(e.status===A.Cancelled?" (".concat(t.localize("cancelledStatus"),")"):""),weight:"bold"}),truncateContent:!0,title:e.name},{content:n,truncateContent:!0,title:n,design:{minWidth:"17vw",maxWidth:"17vw"}},{content:a,truncateContent:!0,title:a,design:{minWidth:"17vw",maxWidth:"17vw"}},{content:"".concat(e.registeredAttendeesCount,"/").concat(e.maximumNumberOfParticipants),design:{minWidth:"12vw",maxWidth:"12vw"}},{content:e.categoryName,truncateContent:!0,title:e.categoryName,design:{minWidth:"15vw",maxWidth:"15vw"}},{content:e.status===A.Cancelled?i.createElement(f.Button,{disabled:!0,text:!0,iconOnly:!0,icon:i.createElement(f.MoreIcon,null)}):i.createElement(st,{eventDetails:e,onCancelEvent:t.onCancelEvent,onCloseRegistration:t.onCloseRegistration,onEditEvent:t.onEditEvent,onExportDetails:t.onExportDetails,onSendReminder:t.onSendReminder,onDeleteDraftEvent:t.onDeleteDraftEvent,dir:t.props.dir}),design:{minWidth:"5vw",maxWidth:"5vw"}}]}}));return i.createElement(f.Table,{className:"manage-events-table",header:this.getEventsTableHeader(),rows:r})}return i.createElement(Pe,{message:this.localize("eventsNotAvailable")})}},{key:"render",value:function(){return i.createElement(Ce.a,{dir:this.props.dir},i.createElement("div",{className:"container-div"},this.state.isMobileView?this.renderMobileView():this.renderDesktopView(),i.createElement(Qe,{dir:this.props.dir,notification:this.state.notification})))}}]),a}(i.Component)),gt=Object(M.a)()(me(vt)),ht=a(302),ft=a.n(ht),Et=a(1253),bt=a(1255),yt=a(36),Ct=a(1260),xt={themeDarker:"#82c7ff",themeDark:"#6cb8f6",themeDarkAlt:"#3aa0f3",themePrimary:"#2899f5",themeSecondary:"#0078d4",themeTertiary:"#235a85",themeLight:"#004c87",themeLighter:"#043862",themeLighterAlt:"#092c47",black:"#ffffff",neutralDark:"#faf9f8",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralSecondary:"#a19f9d",neutralSecondaryAlt:"#979693",neutralTertiary:"#797775",neutralTertiaryAlt:"#484644",neutralQuaternary:"#3b3a39",neutralQuaternaryAlt:"#323130",neutralLight:"#292827",neutralLighter:"#252423",neutralLighterAlt:"#201f1e",white:"#1b1a19",redDark:"#F1707B"},St=Object(yt.i)({palette:xt,semanticColors:{buttonText:xt.black,buttonTextPressed:xt.neutralDark,buttonTextHovered:xt.neutralPrimary,disabledBackground:xt.neutralQuaternaryAlt,inputBackgroundChecked:xt.themePrimary,menuBackground:xt.neutralLighter,menuItemBackgroundHovered:xt.neutralQuaternaryAlt,menuItemBackgroundPressed:xt.neutralQuaternary,menuDivider:xt.neutralTertiaryAlt,menuIcon:xt.themeDarkAlt,menuHeader:xt.black,menuItemText:xt.neutralPrimary,menuItemTextHovered:xt.neutralDark},isInverted:!0}),kt={settings:{theme:St},scopedSettings:{Card:{styles:{root:{background:St.palette.neutralLighter}}},DatePicker:{styles:function(e){var t=e.disabled,a=function(){return{color:St.palette.neutralPrimary,backgroundColor:St.palette.neutralQuaternary}};return{callout:{backgroundColor:St.semanticColors.bodyBackground,color:St.palette.neutralPrimary,selectors:Object($.a)(Object($.a)({".ms-DatePicker-day--infocus":{color:St.palette.neutralPrimary},".ms-DatePicker-currentDecade":{color:St.palette.neutralPrimary},".ms-DatePicker-day--outfocus":{color:St.palette.neutralSecondary},".ms-DatePicker-monthAndYear":{color:St.palette.neutralPrimary},".ms-DatePicker-weekday":{color:St.palette.neutralSecondary},".ms-DatePicker-monthOption":{color:St.palette.neutralPrimary},".ms-DatePicker-currentYear":{color:St.palette.neutralPrimary},".ms-DatePicker-prevMonth":{color:St.palette.neutralPrimary},".ms-DatePicker-nextMonth":{color:St.palette.neutralPrimary},".ms-DatePicker-prevYear":{color:St.palette.neutralPrimary},".ms-DatePicker-nextYear":{color:St.palette.neutralPrimary},".ms-DatePicker-prevDecade":{color:St.palette.neutralPrimary},".ms-DatePicker-nextDecade":{color:St.palette.neutralPrimary},".ms-DatePicker-goToday":{color:St.palette.neutralPrimary},".ms-DatePicker-goToday[disabled]":{display:"none"},".ms-DatePicker-yearOption":{color:St.palette.neutralPrimary},".ms-DatePicker-yearOption--disabled":{color:St.palette.neutralSecondary},".ms-DatePicker-monthOption--disabled":{color:St.palette.neutralSecondary},".ms-DatePicker-day--disabled":{color:St.palette.neutralSecondary},".ms-DatePicker-nextDecade--disabled":{color:St.palette.neutralSecondary},".ms-DatePicker-prevDecade--disabled":{color:St.palette.neutralSecondary},".ms-DatePicker-prevYear--disabled":{color:St.palette.neutralSecondary},".ms-DatePicker-nextYear--disabled":{color:St.palette.neutralSecondary},".ms-DatePicker-prevMonth--disabled":{color:St.palette.neutralSecondary},".ms-DatePicker-nextMonth--disabled":{color:St.palette.neutralSecondary}},{".ms-DatePicker-day-button.ms-DatePicker-day--today":{backgroundColor:St.palette.themePrimary,color:St.palette.neutralPrimary},".ms-DatePicker-day-button.ms-DatePicker-day--today:active":{backgroundColor:St.palette.themePrimary},".ms-DatePicker-day-button.ms-DatePicker-day--today:hover":{color:St.palette.neutralPrimary},".ms-DatePicker-day--highlighted":{backgroundColor:St.palette.themeSecondary,color:St.palette.neutralPrimary},".ms-DatePicker-day--highlighted > .ms-DatePicker-day-button":{backgroundColor:St.palette.themePrimary},".ms-DatePicker-day--highlighted > .ms-DatePicker-day--today":{color:St.palette.neutralPrimary}}),{".ms-DatePicker-day--highlighted:hover":{backgroundColor:St.semanticColors.listItemBackgroundChecked,color:St.palette.neutralPrimary},".ms-DatePicker-day--highlighted > .ms-DatePicker-day-button:hover":{color:St.palette.neutralPrimary},".ms-DatePicker-day--infocus:hover":Object($.a)({},a()),".ms-DatePicker-currentDecade:hover":{color:St.palette.neutralPrimary},".ms-DatePicker-day--outfocus:hover":Object($.a)({},a()),".ms-DatePicker-monthAndYear:hover":{color:St.palette.neutralPrimary},".ms-DatePicker-weekday:hover":{color:St.palette.neutralPrimary},".ms-DatePicker-monthOption:hover":Object($.a)({},a()),".ms-DatePicker-header > .ms-DatePicker-currentYear:hover":{color:St.palette.neutralPrimary},".ms-DatePicker-prevMonth:hover":Object($.a)({},a()),".ms-DatePicker-nextMonth:hover":Object($.a)({},a()),".ms-DatePicker-prevYear:hover":Object($.a)({},a()),".ms-DatePicker-nextYear:hover":Object($.a)({},a()),".ms-DatePicker-goToday:hover":{color:St.palette.neutralPrimary,backgroundColor:St.palette.themeSecondary},".ms-DatePicker-yearOption:hover":Object($.a)({},a()),".ms-DatePicker-prevDecade:hover":Object($.a)({},a()),".ms-DatePicker-nextDecade:hover":Object($.a)({},a())})},icon:[{color:St.palette.neutralPrimary},t&&{color:St.semanticColors.disabledBodyText}],root:[t&&{color:St.semanticColors.disabledBodyText}]}}},DetailsList:{styles:{headerWrapper:{selectors:{".ms-DetailsHeader":{borderColor:St.palette.neutralQuaternary}}}}},ActionButton:{styles:{root:{backgroundColor:St.palette.white},rootDisabled:{backgroundColor:St.palette.neutralLighter},rootHovered:{backgroundColor:St.palette.neutralLight},rootPressed:{backgroundColor:St.palette.neutralQuaternaryAlt}}},DetailsRow:{styles:{root:{selectors:{":hover":{background:St.palette.neutralLighter}},borderColor:St.palette.neutralQuaternaryAlt}}},Modal:{styles:{main:{backgroundColor:St.palette.neutralLighter}}},Overlay:{styles:{root:{background:St.palette.blackTranslucent40}}},VerticalDivider:{styles:{divider:{backgroundColor:St.palette.neutralQuaternaryAlt},wrapper:{Backgroundcolor:St.palette.green}}},DocumentCard:{styles:{root:{border:"1px solid ".concat(St.palette.neutralQuaternaryAlt),selectors:{".ms-DocumentCardPreview":{borderRight:"1px solid ".concat(St.palette.neutralQuaternaryAlt)}}}}},DocumentCardPreview:{styles:{root:{borderBottom:"1px solid ".concat(St.palette.neutralQuaternaryAlt),borderRight:"1px solid ".concat(St.palette.neutralQuaternaryAlt)}}},Panel:{styles:{main:{backgroundColor:St.palette.neutralLighter},closeButton:{color:St.palette.neutralSecondary,selectors:{":hover":{color:St.palette.neutralPrimary}}}}},PeoplePickerItem:{styles:function(e){var t=e.selected;return{root:[{background:St.palette.neutralQuaternaryAlt,selectors:{":hover":{background:St.palette.neutralQuaternary}}},t&&{backgroundColor:St.palette.themeSecondary,selectors:{":hover":{background:St.palette.themeSecondary}}}],removeButton:[{background:St.palette.neutralQuaternaryAlt,color:St.palette.neutralDark,selectors:{":hover":{background:St.palette.neutralQuaternary,color:St.palette.black}}},t&&{background:St.palette.themeSecondary,selectors:{":hover":{background:St.palette.themeDark},":active":{color:St.palette.black}}}],subComponentStyles:{persona:{primaryText:[{color:St.palette.neutralPrimary},t&&{color:St.palette.black,selectors:{":hover":{color:St.palette.black}}}]}}}}},PersonaCoin:{styles:function(e){return{initials:{color:e.showUnknownPersonaCoin?St.palette.redDark:St.palette.black}}}},Separator:{styles:{root:{selectors:{":before":{backgroundColor:St.palette.neutralQuaternaryAlt},":after":{backgroundColor:St.palette.neutralQuaternaryAlt}}}}},SpinButton:{styles:{inputTextSelected:{color:St.palette.black,background:St.palette.themePrimary}}}}};Object(Ct.a)(kt.settings.theme);var wt={settings:{theme:Object(yt.i)({})},scopedSettings:{}};Object(Ct.a)(wt.settings.theme);a(1185);Object(Ae.a)();var Dt=function(e){var t,a="",n=e.theme;n===Re.dark||n===Re.contrast?(a="dark-datepicker",t=kt):(a="default-datepicker",t=wt);var r=Object(i.useState)(e.selectedDate),s=Object(be.a)(r,2),o=s[0],l=s[1],c=Object(i.useState)(e.minDate),u=Object(be.a)(c,2),d=u[0],m=u[1];i.useEffect((function(){l(e.selectedDate)}),[e.selectedDate]),i.useEffect((function(){m(e.minDate)}),[e.minDate]);return i.createElement(i.Fragment,null,i.createElement(f.Flex,{gap:"gap.small"},i.createElement(Ce.a,{className:"full-width",dir:"ltr"},i.createElement(bt.a,t,i.createElement(Et.a,{className:a,label:"",showMonthPickerAsOverlay:!0,minDate:d,isMonthPickerVisible:!0,value:o,onSelectDate:function(t){var a=j()(t).set("hour",j()().hour()).set("minute",j()().minute()).set("second",j()().second());e.onDateSelect(a.toDate()),l(a.toDate())},disabled:e.disableSelectionForPastDate})))))},Ot=(a(1186),function(e){var t=Object(ze.a)().t,a=Object(i.useState)(!1),n=Object(be.a)(a,2),r=n[0],o=n[1],l=s.a.useState(e.hours.toString().padStart(2,"0")+":"+e.minutes.toString().padStart(2,"0")),c=Object(be.a)(l,2),u=c[0],d=c[1],m=s.a.useState(e.hours.toString().padStart(2,"0")),p=Object(be.a)(m,2),v=p[0],g=p[1],h=s.a.useState(e.minutes.toString().padStart(2,"0")),E=Object(be.a)(h,2),b=E[0],y=E[1],C=s.a.useState(e.minHours),x=Object(be.a)(C,2),S=x[0],k=x[1],w=s.a.useState(e.minMinutes),D=Object(be.a)(w,2),O=(D[0],D[1]),T=[],F=[];s.a.useEffect((function(){g(e.hours.toString().padStart(2,"0")),d(e.hours.toString().padStart(2,"0")+":"+e.minutes.toString().padStart(2,"0"))}),[e.hours]),s.a.useEffect((function(){y(e.minutes.toString().padStart(2,"0")),d(e.hours.toString().padStart(2,"0")+":"+e.minutes.toString().padStart(2,"0"))}),[e.minutes]),s.a.useEffect((function(){k(e.minHours)}),[e.minHours]),s.a.useEffect((function(){O(e.minMinutes)}),[e.minMinutes]);for(var I=S||0;I<24;I++)T.push(I.toString().padStart(2,"0"));for(I=0;I<60;I++)F.push(I.toString().padStart(2,"0"));var N={onAdd:function(e){return e&&g(e),""}},L={onAdd:function(e){return e&&y(e),""}},P=s.a.createElement("div",{className:"timepicker-popup-style"},s.a.createElement(f.Flex,{gap:"gap.small"},s.a.createElement(f.Flex.Item,{size:"size.half"},s.a.createElement(f.Text,{size:e.dir===Z.Rtl?"medium":"small",content:t("hourPlaceholder")})),s.a.createElement(f.Flex.Item,{size:"size.half",className:e.dir===Z.Rtl?"rtl-right-margin-large":""},s.a.createElement(f.Text,{size:e.dir===Z.Rtl?"medium":"small",content:t("minutePlaceholder")}))),s.a.createElement(f.Flex,{gap:"gap.small",styles:{marginTop:"0.5rem"}},s.a.createElement(f.Flex.Item,null,s.a.createElement(f.Dropdown,{className:"timepicker-dropdown",items:T,value:v,placeholder:t("hourPlaceholder"),getA11ySelectionMessage:N})),s.a.createElement(f.Flex.Item,null,s.a.createElement(f.Dropdown,{className:e.dir===Z.Rtl?"timepicker-dropdown rtl-right-margin-small":"timepicker-dropdown",value:b,items:F,placeholder:t("minutePlaceholder"),getA11ySelectionMessage:L}))));return s.a.createElement(f.Popup,{open:r,trapFocus:!0,onOpenChange:function(t,a){var n=a.open;o(n),n||(d(v+":"+b),e.onPickerClose(parseInt(v),parseInt(b)))},trigger:s.a.createElement(f.Input,{className:e.dir===Z.Rtl?"rtl-left-margin-small":"",disabled:e.isDisabled,fluid:!0,value:u,icon:s.a.createElement(q.a,{iconName:"Clock"}),iconPosition:e.dir===Z.Rtl?"start":"end"}),content:P})});Ot.defaultProps={hours:0,minutes:0};var Tt=a(1251),Ft=(a(1187),function(e){var t=s.a.useState(),a=Object(be.a)(t,2),n=a[0],r=a[1],i=s.a.useState(1),o=Object(be.a)(i,2),l=o[0],c=o[1];return s.a.useEffect((function(){var t=Re.colorCells.find((function(t){return t.color===e.selectedColor}));r(null===t||void 0===t?void 0:t.id),c(l+1)}),[e.selectedColor]),s.a.createElement("div",{className:"color-picker",key:l},s.a.createElement(Tt.a,{columnCount:5,cellShape:"circle",colorCells:Re.colorCells,selectedId:n,onColorChanged:e.onColorChange}))}),It=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.inputReference=void 0,n.teamId=void 0,n.timeZone=void 0,n.update=function(){n.setState({screenWidth:window.innerWidth})},n.checkIfSaveAsDraftAllowed=function(){var e={isPhotoValid:!0,isColorValid:!0,isNameValid:!0,isDescriptionValid:!0,isEventTypeValid:!0,isEventCategoryValid:!0,isVenueValid:!0,isMaxNoofPartipantsValid:!0,isMeetingLinkValid:!0};return(""==n.state.eventDetails.name||n.state.eventDetails.name.length>Re.eventNameMaxLength)&&(e.isNameValid=!1),n.setState({isPhotoValid:e.isPhotoValid,isColorValid:e.isColorValid,isNameValid:e.isNameValid,isDescriptionValid:e.isDescriptionValid,isEventTypeValid:e.isEventTypeValid,isEventCategoryValid:e.isEventCategoryValid,isVenueValid:e.isVenueValid,isMaxNoofParticipantsValid:e.isMaxNoofPartipantsValid,isMeetingLinkValid:e.isMeetingLinkValid}),!(!(e.isPhotoValid&&e.isColorValid&&e.isNameValid&&e.isDescriptionValid&&e.isEventTypeValid&&e.isEventCategoryValid&&e.isVenueValid&&e.isMaxNoofPartipantsValid&&e.isMeetingLinkValid)||n.state.isEventNameExisting)},n.checkIfNextAllowed=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={isTimeValid:!0,isPhotoValid:!0,isColorValid:!0,isNameValid:!0,isDescriptionValid:!0,isEventTypeValid:!0,isEventCategoryValid:!0,isVenueValid:!0,isMaxNoofPartipantsValid:!0,isMeetingLinkValid:!0},n.state.eventDetails.photo||n.state.eventDetails.selectedColor||(t.isPhotoValid=!1,t.isColorValid=!1),(""==n.state.eventDetails.name.trim()||n.state.eventDetails.name.length>Re.eventNameMaxLength)&&(t.isNameValid=!1),a=!1,!t.isNameValid){e.next=9;break}if(n.props.eventPageState.isEdit&&n.props.eventPageState.eventDetails.name===n.state.eventDetails.name.trim()){e.next=9;break}return e.next=8,n.checkEventName();case 8:a=e.sent;case 9:if((""==n.state.eventDetails.description.trim()||n.state.eventDetails.description.length>Re.eventDescriptionMaxLength)&&(t.isDescriptionValid=!1),n.state.eventDetails.type||(t.isEventTypeValid=!1),n.state.eventDetails.categoryId||(t.isEventCategoryValid=!1),n.state.eventDetails.type===U.InPerson&&""==n.state.eventDetails.venue&&(t.isVenueValid=!1),n.state.eventDetails.maximumNumberOfParticipants||(t.isMaxNoofPartipantsValid=!1),n.state.eventDetails.type!==U.LiveEvent||""!=n.state.eventDetails.meetingLink&&n.state.eventDetails.meetingLink.match(Re.validUrlRegExp)||(t.isMeetingLinkValid=!1),n.checkEventAlreadyStarted()&&(!n.state.eventDetails.startTime||!n.state.eventDetails.endTime||n.state.eventDetails.startTime>=n.state.eventDetails.endTime)&&(t.isTimeValid=!1),n.setState({isPhotoValid:t.isPhotoValid,isColorValid:t.isColorValid,isNameValid:t.isNameValid,isDescriptionValid:t.isDescriptionValid,isEventTypeValid:t.isEventTypeValid,isEventCategoryValid:t.isEventCategoryValid,isVenueValid:t.isVenueValid,isMaxNoofParticipantsValid:t.isMaxNoofPartipantsValid,isMeetingLinkValid:t.isMeetingLinkValid,isTimeValid:t.isTimeValid,isEventNameExisting:a,isValidatingStep1:!1}),!(t.isPhotoValid&&t.isColorValid&&t.isNameValid&&t.isDescriptionValid&&t.isEventTypeValid&&t.isEventCategoryValid&&t.isVenueValid&&t.isMaxNoofPartipantsValid&&t.isMeetingLinkValid&&t.isTimeValid)||n.state.isEventNameExisting){e.next=21;break}return e.abrupt("return",!0);case 21:return e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e)}))),n.checkEventAlreadyStarted=function(){return!(n.props.eventPageState.isEdit&&ft.a.utc(n.state.eventDetails.startDate).local().toDate()<new Date)},n.nextBtnClick=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isValidatingStep1:!0}),e.next=3,n.checkIfNextAllowed();case 3:e.sent&&((t=Object($.a)({},n.props.eventPageState)).eventDetails=n.state.eventDetails,t.selectedCategory=n.state.selectedCategory,t.selectedEvent=n.state.selectedEventType,t.categories=n.state.categories,n.props.navigateToPage(2,t));case 5:case"end":return e.stop()}}),e)}))),n.setStartDate=function(e){var t=n.state.eventDetails;t.startDate=e,t.endDate=e,n.setState({eventDetails:t})},n.setEndDate=function(e){var t=n.state.eventDetails;t.endDate=e,n.setState({eventDetails:t})},n.getNameError=function(){return n.state.isNameValid?n.state.eventDetails.name.length>Re.eventNameMaxLength?i.createElement(f.Text,{"data-testid":"event_name_max_error",content:n.localize("eventNameMaxCharError"),error:!0}):n.state.isEventNameExisting?i.createElement(f.Text,{content:n.localize("eventNameAlreadyExists"),error:!0}):i.createElement(i.Fragment,null):i.createElement(f.Text,{"data-testid":"event_name_req_error",content:n.localize("required"),error:!0})},n.getMeetingLinkError=function(){return n.state.isMeetingLinkValid?i.createElement(i.Fragment,null):i.createElement(f.Text,{"data-testid":"event_link_req_error",content:n.localize("validUrlErrorMessage"),error:!0})},n.getDescriptionError=function(){return n.state.isDescriptionValid?n.state.eventDetails.description.length>Re.eventDescriptionMaxLength?i.createElement(f.Text,{"data-testid":"event_desc_max_error",content:n.localize("eventDescriptionMaxCharError"),error:!0}):i.createElement(i.Fragment,null):i.createElement(f.Text,{"data-testid":"event_desc_req_error",content:n.localize("required"),error:!0})},n.getVenueError=function(){return n.state.isVenueValid?n.state.eventDetails.venue.length>Re.eventVenueMaxLength?i.createElement(f.Text,{"data-testid":"event_venue_max_error",content:n.localize("eventVenueMaxCharError"),error:!0}):i.createElement(i.Fragment,null):i.createElement(f.Text,{"data-testid":"event_venue_req_error",content:n.localize("required"),error:!0,size:"medium"})},n.getEventTypeError=function(){return n.state.isEventTypeValid?i.createElement(f.Text,{content:"",error:!0,size:"medium"}):i.createElement(f.Text,{"data-testid":"event_type_error",content:n.localize("required"),error:!0})},n.getEventCategoryError=function(){return n.state.isEventCategoryValid?i.createElement(f.Text,{content:"",error:!0,size:"medium"}):i.createElement(f.Text,{"data-testid":"event_category_error",content:n.localize("required"),error:!0})},n.getPhotoError=function(){return n.state.isPhotoValid?n.state.isPhotoDimentionsValid?i.createElement(f.Text,{content:"",error:!0,size:"medium"}):i.createElement(f.Text,{content:n.localize("invalidImageDimensions"),error:!0}):i.createElement(f.Text,{"data-testid":"event_photo_error",content:n.localize("required"),error:!0})},n.getMaximumNoofParticipantsError=function(){return n.state.isMaxNoofParticipantsValid?i.createElement(i.Fragment,null):i.createElement(f.Text,{"data-testid":"event_max_req_error",content:n.localize("required"),error:!0})},n.onEventNameChange=function(e){n.setState((function(t){return{eventDetails:Object($.a)(Object($.a)({},t.eventDetails),{},{name:e}),isNameValid:!0,isEventNameExisting:!1}}))},n.onEventDescriptionChange=function(e){n.setState((function(t){return{eventDetails:Object($.a)(Object($.a)({},t.eventDetails),{},{description:e}),isDescriptionValid:!0}}))},n.onEventVenueChange=function(e){n.setState((function(t){return{eventDetails:Object($.a)(Object($.a)({},t.eventDetails),{},{venue:e}),isVenueValid:!0}}))},n.onLiveEventUrlChange=function(e){n.setState((function(t){return{eventDetails:Object($.a)(Object($.a)({},t.eventDetails),{},{meetingLink:e}),isMeetingLinkValid:!0}}))},n.onMaxNoOfParticipantsChange=function(e){n.setState((function(t){return{eventDetails:Object($.a)(Object($.a)({},t.eventDetails),{},{maximumNumberOfParticipants:parseInt(e)}),isMaxNoofParticipantsValid:!0}}))},n.onStartTimeChange=function(e,t){n.setState((function(a){return{eventDetails:Object($.a)(Object($.a)({},a.eventDetails),{},{startTime:new Date((new Date).setHours(e,t)),endTime:void 0===n.state.eventDetails.endTime?new Date((new Date).setHours(e,t+15)):n.state.eventDetails.endTime})}}))},n.onEndTimeChange=function(e,t){n.setState((function(a){return{eventDetails:Object($.a)(Object($.a)({},a.eventDetails),{},{endTime:new Date((new Date).setHours(e,t))})}}))},n.handleUploadClick=function(e){n.inputReference.current.click()},n.onColorChange=function(e,t){n.setState((function(e){return{eventDetails:Object($.a)(Object($.a)({},e.eventDetails),{},{selectedColor:t,photo:""}),inputKey:n.state.inputKey+1,isPhotoDimentionsValid:!0,isPhotoValid:!0}}))},n.uploadImage=function(){var e=Object(h.a)(g.a.mark((function e(t){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({imageUploadLoader:!0}),e.next=3,ee(t,n.teamId);case 3:(a=e.sent)&&a.status===r.OK&&a.data?n.setState((function(e){return{eventDetails:Object($.a)(Object($.a)({},e.eventDetails),{},{photo:a.data,selectedColor:""}),imageUploadLoader:!1}})):n.setState({imageUploadLoader:!1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleChange=function(e){var t=e.target.files[0];if(t){var a=!0,r=new Image;r.src=window.URL.createObjectURL(t),r.onload=function(){if(r.width<850||r.height<290||r.width>900||r.height>310)a=!1;else{var e=new FormData;e.append("fileInfo",t,t.name),n.uploadImage(e)}n.setState({isPhotoDimentionsValid:a})}}},n.checkEventName=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se(n.state.eventDetails.name);case 2:if(!(t=e.sent)||t.status!==r.OK||!t.data){e.next=8;break}return a=t.data.some((function(e){return e.name.toLowerCase()===n.state.eventDetails.name.trim().toLowerCase()})),e.abrupt("return",a);case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e)}))),n.saveEventAsDraft=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.checkIfSaveAsDraftAllowed()){e.next=12;break}return n.setState({isLoading:!0}),(t=Object($.a)({},n.props.eventPageState)).eventDetails=n.state.eventDetails,t.selectedCategory=n.state.selectedCategory,t.selectedEvent=n.state.selectedEventType,t.categories=n.state.categories,e.next=10,ue(t,n.teamId);case 10:e.sent?n.props.microsoftTeams.tasks.submitTask({isSuccess:!0,isDraft:!0}):n.setState({isLoading:!1});case 12:case"end":return e.stop()}}),e)}))),n.localize=n.props.t;var s,o=(s=n.localize,Re.eventType.map((function(e){switch(e.id){case U.InPerson:return e.name=s("inPersonEvent"),e;case U.Teams:return e.name=s("teamsEvent"),e;case U.LiveEvent:return e.name=s("liveEvent"),e;default:return e}})));window.addEventListener("resize",n.update),n.inputReference=i.createRef();var l=new Date;return n.teamId="",n.timeZone=ft.a.tz.guess(),n.state={imageUploadLoader:!1,inputKey:1,isLoading:!1,categories:n.props.eventPageState.categories.length>0?n.props.eventPageState.categories:new Array,theme:"",eventTypes:o,screenWidth:window.innerWidth,projectStartDate:l.setDate(l.getDate()+1),isPhotoValid:!0,isColorValid:!0,isEventNameExisting:!1,isPhotoDimentionsValid:!0,isNameValid:!0,isDescriptionValid:!0,isTimeValid:!0,isVenueValid:!0,isMeetingLinkValid:!0,isEventTypeValid:!0,isEventCategoryValid:!0,isMaxNoofParticipantsValid:!0,isValidatingStep1:!1,selectedEventType:void 0===n.props.eventPageState.eventDetails.type?{key:U.Teams.toString(),header:o.find((function(e){return e.id===U.Teams})).name}:{key:o.find((function(e){return e.id===n.props.eventPageState.eventDetails.type})).id.toString(),header:o.find((function(e){return e.id===n.props.eventPageState.eventDetails.type})).name},selectedCategory:n.props.eventPageState.selectedCategory,eventDetails:Object($.a)({},n.props.eventPageState.eventDetails)},n}return Object(u.a)(a,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.eventPageState.categories!==this.props.eventPageState.categories&&this.setState({categories:e.eventPageState.categories}),e.eventPageState.eventDetails!==this.props.eventPageState.eventDetails&&this.setState({eventDetails:Object($.a)({},e.eventPageState.eventDetails)}),e.eventPageState.selectedCategory!==this.props.eventPageState.selectedCategory&&this.setState({selectedCategory:e.eventPageState.selectedCategory}),e.teamsContext&&e.teamsContext!==this.props.teamsContext&&(this.setState({theme:e.teamsContext.theme}),this.teamId=e.teamsContext.teamId)}},{key:"render",value:function(){for(var e,t,a,n,r,s=this,o={onAdd:function(e){return s.setState((function(t){return{eventDetails:Object($.a)(Object($.a)({},t.eventDetails),{},{type:e.key}),isEventTypeValid:!0,selectedEventType:e}})),""}},l=new Array,c=0;c<this.state.categories.length;c++)l.push({key:this.state.categories[c].id.toString(),header:this.state.categories[c].name});var u=new Date;return u.setDate(u.getDate()+1),i.createElement(i.Fragment,null,i.createElement("div",{className:"page-content"},i.createElement(f.Flex,{gap:"gap.smaller"},i.createElement(f.Text,{size:"large",content:this.localize("eventDetailsStep1")})),i.createElement(f.Flex,{gap:"gap.smaller",className:"margin-top",vAlign:"center"},i.createElement(f.Text,{className:"form-label margin-right",content:this.localize("eventPhotoStep1")}),i.createElement(f.ExclamationCircleIcon,{title:this.localize("imageInfoIcon"),size:"small"}),i.createElement(f.Flex.Item,{push:!0,grow:this.props.dir===Z.Rtl},this.getPhotoError())),this.state.eventDetails.photo&&i.createElement(f.Flex,{gap:"gap.smaller",className:"input-label-margin-between",vAlign:"end"},i.createElement(f.Image,{className:"event-image-color",fluid:!0,src:this.state.eventDetails.photo})),this.state.eventDetails.selectedColor&&i.createElement(f.Flex,{gap:"gap.smaller",className:"input-label-margin-between",vAlign:"end"},i.createElement("div",{className:"event-image-color",style:{backgroundColor:this.state.eventDetails.selectedColor}},i.createElement(f.Flex,{className:"event-image-color",hAlign:"center",vAlign:"center"},i.createElement(f.Text,{className:"event-color-text",size:"large",weight:"semibold",content:this.state.eventDetails.name})))),i.createElement(f.Flex,{gap:"gap.smaller",className:"input-label-margin-between",vAlign:"center"},i.createElement(f.Flex.Item,null,i.createElement(i.Fragment,null,i.createElement(f.Button,{disabled:this.state.imageUploadLoader,loading:this.state.imageUploadLoader,onClick:this.handleUploadClick,size:"medium",icon:i.createElement(f.FilesUploadIcon,{className:this.props.dir===Z.Rtl?"rtl-left-margin-small":""}),content:this.state.eventDetails.photo&&this.state.eventDetails.photo.length?this.localize("changePhotoStep1"):this.localize("uploadPhotoStep1"),iconPosition:"before"}),i.createElement("input",{type:"file",ref:this.inputReference,onChange:this.handleChange,style:{display:"none"},key:this.state.inputKey}),i.createElement(f.Text,{className:this.props.dir===Z.Rtl?"form-label rtl-left-margin-small":"form-label",content:this.localize("orLabelForImageOrColor")}))),i.createElement(f.Flex.Item,null,i.createElement("div",null,i.createElement(Ft,{onColorChange:this.onColorChange,selectedColor:this.state.eventDetails.selectedColor})))),i.createElement(f.Flex,{className:"margin-top",gap:"gap.smaller"},i.createElement(f.Text,{className:"form-label",content:this.localize("eventNameStep1")}),i.createElement(f.Flex.Item,{push:!0,grow:this.props.dir===Z.Rtl},this.getNameError())),i.createElement(f.Flex,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(f.Input,{"data-testid":"event_name_input",maxLength:Re.eventNameMaxLength,fluid:!0,placeholder:this.localize("eventNamePlaceholderStep1"),value:this.state.eventDetails.name,onChange:function(e){return s.onEventNameChange(e.target.value)}})),i.createElement(f.Flex,{gap:"gap.smaller",className:"margin-top"},i.createElement(f.Flex.Item,{size:"size.half"},i.createElement(f.Flex,null,i.createElement(f.Text,{className:"form-label",content:this.localize("eventTypeStep1")}),i.createElement(f.Flex.Item,{push:!0,grow:this.props.dir===Z.Rtl},this.getEventTypeError()))),i.createElement(f.Flex.Item,{size:"size.half"},i.createElement(f.Flex,null,i.createElement(f.Text,{className:"form-label",content:this.localize("category")}),i.createElement(f.Flex.Item,{push:!0,grow:this.props.dir===Z.Rtl},this.getEventCategoryError())))),i.createElement(f.Flex,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(f.Flex.Item,{size:"size.half"},i.createElement(f.Dropdown,{className:this.props.dir===Z.Rtl?"dropdown-flex-half rtl-left-margin-small":"dropdown-flex-half",fluid:!0,items:this.state.eventTypes.map((function(e){return{key:e.id,header:e.name}})),value:this.state.selectedEventType,placeholder:this.localize("selectEventTypePlaceholder"),getA11ySelectionMessage:o,"data-testid":"event_type_dropdown"})),i.createElement(f.Flex.Item,{size:"size.half"},i.createElement(f.Dropdown,{className:"dropdown-flex-half",fluid:!0,onChange:function(e,t){var a;a=t.value,s.setState((function(e){return{eventDetails:Object($.a)(Object($.a)({},e.eventDetails),{},{categoryId:a.key}),isEventCategoryValid:!0,selectedCategory:a}}))},value:this.state.selectedCategory,items:l,placeholder:this.localize("selectCategoryPlaceholder"),"data-testid":"event_category_dropdown"}))),this.state.eventDetails.type===U.LiveEvent&&i.createElement(i.Fragment,null,i.createElement(f.Flex,{className:"margin-top",gap:"gap.smaller"},i.createElement(f.Text,{className:"form-label",content:this.localize("liveEventUrlStep1")}),i.createElement(f.Flex.Item,{push:!0,grow:this.props.dir===Z.Rtl},this.getMeetingLinkError())),i.createElement(f.Flex,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(f.Input,{fluid:!0,value:this.state.eventDetails.meetingLink,placeholder:this.localize("liveEventUrlPlaceholder"),onChange:function(e){return s.onLiveEventUrlChange(e.target.value)},"data-testid":"event_link_input"}))),this.state.eventDetails.type===U.InPerson&&i.createElement(i.Fragment,null,i.createElement(f.Flex,{className:"margin-top",gap:"gap.smaller"},i.createElement(f.Text,{className:"form-label",content:this.localize("venue")}),i.createElement(f.Flex.Item,{push:!0,grow:this.props.dir===Z.Rtl},this.getVenueError())),i.createElement(f.Flex,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(f.Input,{maxLength:Re.eventVenueMaxLength,value:this.state.eventDetails.venue,onChange:function(e){return s.onEventVenueChange(e.target.value)},fluid:!0,placeholder:this.localize("venuePlaceholder"),"data-testid":"event_venue_input"}))),i.createElement(f.Flex,{gap:"gap.smaller",className:"margin-top"},i.createElement(f.Text,{className:"form-label",content:this.localize("eventDescriptionStep1")}),i.createElement(f.Flex.Item,{push:!0,grow:this.props.dir===Z.Rtl},this.getDescriptionError())),i.createElement(f.Flex,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(f.TextArea,{maxLength:Re.eventDescriptionMaxLength,fluid:!0,placeholder:this.localize("eventDescriptionPlaceholder"),value:this.state.eventDetails.description,onChange:function(e){return s.onEventDescriptionChange(e.target.value)},"data-testid":"event_description_input"})),i.createElement(f.Flex,{gap:"gap.smaller",className:"margin-top"},i.createElement(f.Text,{title:this.timeZone,truncated:!0,className:"form-label",content:"".concat(this.localize("yourTimeZone"),": ").concat(this.timeZone)})),this.state.screenWidth>=600&&i.createElement(i.Fragment,null,i.createElement(f.Flex,{gap:"gap.smaller",className:"margin-top"},i.createElement(f.Flex.Item,{size:"size.half"},i.createElement("div",null,i.createElement(f.Text,{className:"form-label",align:this.props.dir===Z.Rtl?"end":"start",content:"".concat(this.localize("startDateStep1"))}),i.createElement(f.Flex,{className:this.props.dir===Z.Rtl?"rtl-left-margin-small":""},i.createElement(Dt,{screenWidth:this.state.screenWidth,theme:this.state.theme,selectedDate:this.state.eventDetails.startDate,minDate:u,onDateSelect:this.setStartDate,disableSelectionForPastDate:!this.checkEventAlreadyStarted()})))),i.createElement(f.Flex.Item,{size:"size.half"},i.createElement("div",null,i.createElement(f.Text,{className:"form-label",align:this.props.dir===Z.Rtl?"end":"start",content:"".concat(this.localize("endDateStep1"))}),i.createElement(Dt,{screenWidth:this.state.screenWidth,theme:this.state.theme,minDate:this.state.eventDetails.endDate,selectedDate:this.state.eventDetails.endDate,onDateSelect:this.setEndDate,disableSelectionForPastDate:!this.checkEventAlreadyStarted()}))))),this.state.screenWidth<600&&i.createElement(i.Fragment,null,i.createElement(f.Flex,{gap:"gap.smaller",className:"margin-top"},i.createElement(f.Text,{className:"form-label",content:this.localize("startDateStep1")})),i.createElement(f.Flex,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(Dt,{screenWidth:this.state.screenWidth,theme:this.state.theme,selectedDate:this.state.eventDetails.startDate,minDate:u,onDateSelect:this.setStartDate,disableSelectionForPastDate:!this.checkEventAlreadyStarted()})),i.createElement(f.Flex,{gap:"gap.smaller",className:"margin-top"},i.createElement(f.Text,{className:"form-label",content:this.localize("endDateStep1")})),i.createElement(f.Flex,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(Dt,{screenWidth:this.state.screenWidth,theme:this.state.theme,minDate:this.state.eventDetails.startDate,selectedDate:this.state.eventDetails.endDate,onDateSelect:this.setEndDate,disableSelectionForPastDate:!this.checkEventAlreadyStarted()}))),i.createElement(f.Flex,{gap:"gap.smaller",className:"margin-top"},i.createElement(f.Flex.Item,{size:"size.half"},i.createElement(f.Flex,{gap:"gap.smaller"},i.createElement(f.Flex.Item,{size:"size.half"},i.createElement(f.Text,{className:"form-label",align:this.props.dir===Z.Rtl?"end":"start",content:this.localize("startTimeStep1")})),i.createElement(f.Flex.Item,{size:"size.half"},i.createElement(f.Text,{className:"form-label",align:this.props.dir===Z.Rtl?"end":"start",content:this.localize("endTimeStep1")})))),i.createElement(f.Flex.Item,{size:"size.half"},i.createElement(f.Flex,null,i.createElement(f.Text,{className:"form-label",align:this.props.dir===Z.Rtl?"end":"start",content:this.localize("maxParticipantsStep1")}),i.createElement(f.Flex.Item,{push:this.props.dir===Z.Ltr,grow:this.props.dir===Z.Rtl},this.getMaximumNoofParticipantsError())))),i.createElement(f.Flex,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(f.Flex.Item,{size:"size.half",className:this.props.dir===Z.Rtl?"rtl-left-margin-small":""},i.createElement(f.Flex,{gap:"gap.smaller"},i.createElement(f.Flex.Item,{size:"size.half"},i.createElement(Ot,{hours:null===(e=this.state.eventDetails.startTime)||void 0===e?void 0:e.getHours(),minutes:null===(t=this.state.eventDetails.startTime)||void 0===t?void 0:t.getMinutes(),isDisabled:!this.checkEventAlreadyStarted(),onPickerClose:this.onStartTimeChange,dir:this.props.dir})),i.createElement(f.Flex.Item,{size:"size.half"},i.createElement(Ot,{hours:null===(a=this.state.eventDetails.endTime)||void 0===a?void 0:a.getHours(),minutes:null===(n=this.state.eventDetails.endTime)||void 0===n?void 0:n.getMinutes(),onPickerClose:this.onEndTimeChange,minHours:null===(r=this.state.eventDetails.startTime)||void 0===r?void 0:r.getHours(),minMinutes:void 0,isDisabled:!this.checkEventAlreadyStarted(),dir:this.props.dir})))),i.createElement(f.Flex.Item,{size:"size.half",className:this.props.dir===Z.Rtl?"rtl-left-margin-small":""},i.createElement(f.Input,{type:"number",min:1,fluid:!0,value:this.state.eventDetails.maximumNumberOfParticipants.toString(),onChange:function(e){return s.onMaxNoOfParticipantsChange(e.target.value)},"data-testid":"event_maxParticipants_input"})))),this.props.dir===Z.Ltr&&i.createElement(f.Flex,{gap:"gap.smaller",className:"button-footer",vAlign:"center"},!this.state.isTimeValid&&i.createElement(f.Text,{error:!0,content:this.localize("startAndEndTimeError")}),i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Text,{weight:"bold",content:this.localize("step1Of3")})),(!this.props.eventPageState.isEdit||this.props.eventPageState.isEdit&&this.props.eventPageState.isDraft)&&i.createElement(f.Button,{disabled:this.state.isLoading||this.state.isValidatingStep1,loading:this.state.isLoading,onClick:this.saveEventAsDraft,content:this.localize("saveAsDraft"),secondary:!0,"data-testid":"event_save_button"}),i.createElement(f.Button,{"data-testid":"event_next_button",content:this.localize("nextButton"),loading:this.state.isValidatingStep1,disabled:this.state.isLoading||this.state.isValidatingStep1,primary:!0,onClick:this.nextBtnClick})),this.props.dir===Z.Rtl&&i.createElement(f.Flex,{gap:"gap.smaller",className:"button-footer",vAlign:"center"},i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Text,{error:!0,content:this.state.isTimeValid?"":this.localize("startAndEndTimeError")})),i.createElement(f.Text,{className:"rtl-left-margin-small",weight:"bold",content:this.localize("step1Of3")}),(!this.props.eventPageState.isEdit||this.props.eventPageState.isEdit&&this.props.eventPageState.isDraft)&&i.createElement(f.Button,{className:"rtl-left-margin-small",disabled:this.state.isLoading||this.state.isValidatingStep1,loading:this.state.isLoading,onClick:this.saveEventAsDraft,content:this.localize("saveAsDraft"),secondary:!0,"data-testid":"event_save_button"}),i.createElement(f.Button,{"data-testid":"event_next_button",content:this.localize("nextButton"),loading:this.state.isValidatingStep1,disabled:this.state.isLoading||this.state.isValidatingStep1,primary:!0,onClick:this.nextBtnClick})))}}]),a}(i.Component),Nt=Object(M.a)()(me(It)),Lt=function(e){var t=null,a=new Array,n=i.useState(new Array),r=Object(be.a)(n,2),s=r[0],o=r[1],l=i.useState(!0),c=Object(be.a)(l,2),u=c[0],d=c[1],m=i.useState(!1),p=Object(be.a)(m,2),v=p[0],E=p[1],b=i.useState(0),y=Object(be.a)(b,2),C=y[0],x=y[1],S=i.useState(void 0),k=Object(be.a)(S,2),w=k[0],D=k[1],O=function(){var e=Object(h.a)(g.a.mark((function e(t){var n,r,i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.length||t.length){e.next=3;break}return o(a),e.abrupt("return");case 3:return n=new Array,e.next=6,W(t);case 6:if(200===(r=e.sent).status&&r.data)for(i=r.data,s=0;s<i.length;s++)i[s].displayName&&i[s].email&&n.push({header:i[s].displayName,content:i[s].email,id:i[s].id,email:i[s].email,isGroup:i[s].isGroup});a.length||(a=[].concat(n)),o(n),d(!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T={onAdd:function(t){return e.onItemSelect(t),x(C+1),""}};return i.createElement(f.Dropdown,{search:!0,styles:{width:"100%"},fluid:!0,key:C,loading:u,loadingMessage:e.loadingMessage,items:s,value:w,onChange:function(e,t){t.value;D(void 0)},onSearchQueryChange:function(e,a){!function(e){t&&window.clearTimeout(t),u||d(!0),t=window.setTimeout(Object(h.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O(e);case 2:case"end":return t.stop()}}),t)}))),750)}(a.searchQuery)},onOpenChange:function(e,t){var a=t.open;t.value;a?(d(!0),O("")):o(new Array),E(a)},open:v,getA11ySelectionMessage:T,placeholder:e.placeholder,noResultsMessage:e.noResultMessage,"data-testid":"audience_dropdown_search"})},Pt=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n,r,s;Object(c.a)(this,a),(s=t.call(this,e)).localize=void 0,s.teamId=void 0,s.nextBtnClick=function(){var e=Object($.a)({},s.props.eventPageState);e.selectedUserGroups=s.state.selectedUsersAndGroups,e.selectedAudience=s.state.selectedAudienceType,e.eventDetails=s.state.eventDetails,e.eventDetails.selectedUserOrGroupListJSON=JSON.stringify(s.state.selectedUsersAndGroups),s.props.navigateToPage(3,e)},s.backBtnClick=function(){var e=Object($.a)({},s.props.eventPageState);e.selectedUserGroups=s.state.selectedUsersAndGroups,e.selectedAudience=s.state.selectedAudienceType,e.eventDetails=s.state.eventDetails,e.eventDetails.selectedUserOrGroupListJSON=JSON.stringify(s.state.selectedUsersAndGroups),s.props.navigateToPage(1,e)},s.onToggleChange=function(e){var t=s.state.selectedUsersAndGroups;t[e].isMandatory=!t[e].isMandatory,s.setState({selectedUsersAndGroups:t})},s.deleteItem=function(e){var t=s.state.selectedUsersAndGroups;t.splice(e,1),s.setState({selectedUsersAndGroups:t})},s.renderMembers=function(){if(s.state.selectedUsersAndGroups&&s.state.selectedUsersAndGroups.length>0){var e=s.state.selectedUsersAndGroups.map((function(e,t){return{key:t,items:[{content:i.createElement(i.Fragment,null,i.createElement(f.Text,{weight:"bold",content:e.displayName}),i.createElement("br",null),i.createElement(f.Text,{size:"small",content:e.email})),title:e.displayName,truncateContent:!0},{content:i.createElement(i.Fragment,null,i.createElement(f.Text,{content:s.localize("mandatoryToggleStep2")}),i.createElement(f.Checkbox,{className:s.props.dir===Z.Rtl?"rtl-toggle":"",onChange:function(){return s.onToggleChange(t)},checked:e.isMandatory,toggle:!0})),className:"mandatory-toggle-column"},{content:i.createElement(E.TrashCanIcon,{className:"icon-hover",onClick:function(){return s.deleteItem(t)}}),className:"delete-button-column"}]}}));return i.createElement(f.Table,{className:"selected-user-group-table",rows:e})}return i.createElement(f.Flex,{gap:"gap.small"},i.createElement(f.Flex.Item,null,i.createElement("div",{style:{position:"relative"}},i.createElement(E.QuestionCircleIcon,{outline:!0,color:"green"}))),i.createElement(f.Flex.Item,{grow:s.props.dir===Z.Ltr},i.createElement(f.Flex,{column:!0,gap:"gap.small",vAlign:"stretch",className:s.props.dir===Z.Rtl?"rtl-right-margin-medium rtl-direction":""},i.createElement("div",null,i.createElement(f.Text,{weight:"bold",content:s.localize("noUserSelectedHeaderStep2")}),i.createElement("br",null),i.createElement(f.Text,{size:"small",content:s.localize("noUserSelectedContentStep2")})))))},s.onAudienceTypeSelection={onAdd:function(e){return s.setState({selectedAudienceType:e}),""}},s.onUserOrGroupSelection=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={displayName:t.header,email:t.content,id:t.id,isGroup:t.isGroup,isMandatory:!0},n=s.state.selectedUsersAndGroups,n.find((function(e){return e.id===a.id}))||(n.push(a),s.setState({selectedUsersAndGroups:n}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.onAudienceChange=function(e){s.setState((function(t){return{eventDetails:Object($.a)(Object($.a)({},t.eventDetails),{},{audience:e.key}),selectedAudienceType:e}}))},s.onAutoRegisterToggleChange=function(){s.setState((function(e){return{eventDetails:Object($.a)(Object($.a)({},e.eventDetails),{},{isAutoRegister:!s.state.eventDetails.isAutoRegister})}}))},s.saveEventAsDraft=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.setState({isLoading:!0}),(t=Object($.a)({},s.props.eventPageState)).selectedUserGroups=s.state.selectedUsersAndGroups,t.selectedAudience=s.state.selectedAudienceType,t.eventDetails=s.state.eventDetails,t.eventDetails.selectedUserOrGroupListJSON=JSON.stringify(s.state.selectedUsersAndGroups),e.next=8,ue(t,s.teamId);case 8:e.sent?S.tasks.submitTask({isSuccess:!0,isDraft:!0}):s.setState({isLoading:!1});case 10:case"end":return e.stop()}}),e)}))),s.onMandatoryAllClocked=function(){for(var e=Object(X.a)(s.state.selectedUsersAndGroups),t=0;t<e.length;t++)e[t].isMandatory=!0;s.setState({selectedUsersAndGroups:e})},s.teamId="",s.localize=s.props.t;var o,l=(o=s.localize,Re.audienceType.map((function(e){switch(e.id){case R.Public:return e.name=o("publicAudience"),e;case R.Private:return e.name=o("privateAudience"),e;default:return e}})));return s.state={isLoading:!1,selectedAudienceType:{key:null===(n=s.props.eventPageState.eventDetails.audience)||void 0===n?void 0:n.toString(),header:null===(r=l.find((function(e){return e.id===s.props.eventPageState.eventDetails.audience})))||void 0===r?void 0:r.name},selectedUsersAndGroups:s.props.eventPageState.selectedUserGroups.length>0?s.props.eventPageState.selectedUserGroups:new Array,eventDetails:s.props.eventPageState.eventDetails,audienceTypes:l},s}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;S.initialize(),S.getContext((function(t){e.teamId=t.teamId}))}},{key:"render",value:function(){var e=this;return i.createElement(i.Fragment,null,i.createElement("div",{className:"page-content"},i.createElement(f.Flex,{gap:"gap.smaller"},i.createElement(f.Text,{size:"large",content:this.localize("audienceDetailsStep2")})),i.createElement(f.Flex,{gap:"gap.smaller",className:"margin-top"},i.createElement(f.Flex.Item,{size:"size.half"},i.createElement(f.Flex,{gap:"gap.smaller",vAlign:"center"},i.createElement(f.Text,{className:this.props.dir===Z.Rtl?"rtl-left-margin-small form-label":"form-label",content:this.localize("audienceTypeStep2")}),i.createElement(E.InfoIcon,{outline:!0,title:this.localize("audienceTypeInfoIconTitle")})))),i.createElement(f.Flex,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(f.Flex.Item,{size:"size.half"},i.createElement(f.Dropdown,{fluid:!0,value:this.state.selectedAudienceType,items:this.state.audienceTypes.map((function(e){return{key:e.id,header:e.name}})),onChange:function(t,a){e.onAudienceChange(a.value)},"data-testid":"event_audience_dropdown"}))),this.state.eventDetails.audience===R.Private&&i.createElement(i.Fragment,null,i.createElement(f.Flex,{gap:"gap.smaller",className:"margin-top"},i.createElement(Lt,{loadingMessage:this.localize("dropdownSearchLoadingMessage"),noResultMessage:this.localize("noResultFoundDropdownMessage"),placeholder:this.localize("startTypingDropdownSearch"),onItemSelect:this.onUserOrGroupSelection})),i.createElement(f.Flex,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(f.Checkbox,{onChange:function(){return e.onAutoRegisterToggleChange()},checked:this.state.eventDetails.isAutoRegister,label:this.localize("autoRegisterCheckboxLabelStep2"),"data-testid":"auto_toggle"}),i.createElement(f.Flex.Item,{push:this.props.dir===Z.Ltr,grow:this.props.dir===Z.Rtl},i.createElement(f.Button,{onClick:this.onMandatoryAllClocked,primary:!0,text:!0,content:this.localize("mandatoryAllButtonStep2"),disabled:0===this.state.selectedUsersAndGroups.filter((function(e){return!1===e.isMandatory})).length,"data-testid":"audience_mandatory_button",className:this.props.dir===Z.Rtl?"left-push":""}))),this.renderMembers())),this.props.dir===Z.Ltr&&i.createElement(f.Flex,{gap:"gap.smaller",className:"button-footer",vAlign:"center"},i.createElement(f.Button,{icon:i.createElement(E.ArrowLeftIcon,null),text:!0,content:this.localize("back"),onClick:this.backBtnClick,"data-testid":"back_button"}),i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Text,{weight:"bold",content:this.localize("step2Of3")})),(!this.props.eventPageState.isEdit||this.props.eventPageState.isEdit&&this.props.eventPageState.isDraft)&&i.createElement(f.Button,{disabled:this.state.isLoading,loading:this.state.isLoading,onClick:this.saveEventAsDraft,content:this.localize("saveAsDraft"),secondary:!0,"data-testid":"save_draft_button"}),i.createElement(f.Button,{content:this.localize("nextButton"),disabled:this.state.isLoading||this.state.eventDetails.audience===R.Private&&0===this.state.selectedUsersAndGroups.length,primary:!0,onClick:this.nextBtnClick,"data-testid":"next_button"})),this.props.dir===Z.Rtl&&i.createElement(f.Flex,{gap:"gap.smaller",className:"button-footer",vAlign:"center"},i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Button,{icon:i.createElement(E.ArrowRightIcon,null),text:!0,content:i.createElement(f.Text,{content:this.localize("back"),className:this.props.dir===Z.Rtl?"rtl-right-margin-small":""}),onClick:this.backBtnClick,"data-testid":"back_button"})),i.createElement(f.Text,{className:"rtl-left-margin-small",weight:"bold",content:this.localize("step2Of3")}),(!this.props.eventPageState.isEdit||this.props.eventPageState.isEdit&&this.props.eventPageState.isDraft)&&i.createElement(f.Button,{className:"rtl-right-margin-small",disabled:this.state.isLoading,loading:this.state.isLoading,onClick:this.saveEventAsDraft,content:this.localize("saveAsDraft"),secondary:!0,"data-testid":"save_draft_button"}),i.createElement(f.Button,{content:this.localize("nextButton"),disabled:this.state.isLoading||this.state.eventDetails.audience===R.Private&&0===this.state.selectedUsersAndGroups.length,primary:!0,onClick:this.nextBtnClick,"data-testid":"next_button"})))}}]),a}(i.Component),At=Object(M.a)()(Pt),zt=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.teamId=void 0,n.getRegisteredAttendeesCount=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe(Object(X.a)(n.props.eventPageState.selectedUserGroups));case 2:t=e.sent,n.setState({registeredAttendeesCount:t.mandatoryUsers.length});case 4:case"end":return e.stop()}}),e)}))),n.backBtnClick=function(){n.props.navigateToPage(2,n.props.eventPageState)},n.getArtifacts=function(){var e,t,a=[];switch(null===(e=n.props.eventPageState.eventDetails)||void 0===e?void 0:e.type){case U.Teams:a.push(i.createElement(he,null));break;case U.LiveEvent:a.push(i.createElement(fe,null))}switch(null===(t=n.props.eventPageState.eventDetails)||void 0===t?void 0:t.audience){case R.Private:a.push(i.createElement(ge,{audienceType:R.Private}));break;case R.Public:a.push(i.createElement(ge,{audienceType:R.Public}))}return i.createElement(f.Flex,{gap:"gap.small",vAlign:"center"},a)},n.getEventDayAndTime=function(e,t,a){var n=j.a.utc(e).local().format("ddd"),r=j.a.utc(t).local().format("HH:mm"),i=j.a.utc(a).local().format("HH:mm");return"".concat(n,", ").concat(r," - ").concat(i)},n.renderEventVenue=function(e,t){if(e===U.InPerson)return i.createElement(i.Fragment,null,i.createElement(f.Divider,{vertical:!0,styles:{height:"1.13rem",marginRight:".8rem"}}),i.createElement(f.Text,{className:"event-venue",content:t,weight:"semibold",size:"small"}))},n.saveEventAsDraft=Object(h.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isDraftLoading:!0}),e.next=3,ue(Object($.a)({},n.props.eventPageState),n.teamId);case 3:e.sent?S.tasks.submitTask({isSuccess:!0,isDraft:!0}):(n.setState({isDraftLoading:!1}),S.tasks.submitTask({isSuccess:!1,isDraft:!0}));case 5:case"end":return e.stop()}}),e)}))),n.createEvent=Object(h.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isCreateLoading:!0}),e.next=3,le(n.props.eventPageState,n.teamId);case 3:e.sent?S.tasks.submitTask({isSuccess:!0,isCreateEvent:!0}):(n.setState({isCreateLoading:!1}),S.tasks.submitTask({isSuccess:!1,isCreateEvent:!0}));case 5:case"end":return e.stop()}}),e)}))),n.updateEvent=Object(h.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isCreateLoading:!0}),e.next=3,ce(n.props.eventPageState,n.teamId);case 3:e.sent?S.tasks.submitTask({isSuccess:!0}):(n.setState({isCreateLoading:!1}),S.tasks.submitTask({isSuccess:!1}));case 5:case"end":return e.stop()}}),e)}))),n.renderAttendeeURL=function(){if(n.props.eventPageState.eventDetails.type===U.LiveEvent)return i.createElement(f.Flex,{design:{marginTop:"2.67rem"},vAlign:"center",hAlign:"start",column:!0},i.createElement(f.Text,{content:n.localize("liveEventUrlStep1"),weight:"semibold"}),i.createElement("a",{href:n.props.eventPageState.eventDetails.meetingLink,target:"_blank",rel:"noopener noreferrer"},n.props.eventPageState.eventDetails.meetingLink))},n.localize=n.props.t,n.teamId="",n.state={isCreateLoading:!1,registeredAttendeesCount:0,isDraftLoading:!1},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;S.initialize(),S.getContext((function(t){e.teamId=t.teamId})),this.props.eventPageState.eventDetails.audience===R.Private&&this.props.eventPageState.eventDetails.isAutoRegister&&this.getRegisteredAttendeesCount()}},{key:"render",value:function(){var e;return i.createElement(i.Fragment,null,i.createElement("div",{className:"page-content create-event-step3"},i.createElement(f.Flex,{gap:"gap.smaller"},i.createElement(f.Text,{size:"large",content:this.localize("eventPreviewStep3")})),i.createElement(f.Flex,{className:"margin-top",space:"between",vAlign:"center"},i.createElement(f.Text,{className:"category label-color",content:null===(e=this.props.eventPageState.selectedCategory)||void 0===e?void 0:e.header,weight:"bold"}),i.createElement(f.Flex.Item,{push:this.props.dir===Z.Ltr},this.getArtifacts())),this.props.eventPageState.eventDetails.photo&&i.createElement(f.Image,{className:"event-image",fluid:!0,src:this.props.eventPageState.eventDetails.photo}),this.props.eventPageState.eventDetails.selectedColor&&i.createElement("div",{className:"event-image",style:{backgroundColor:this.props.eventPageState.eventDetails.selectedColor}},i.createElement(f.Flex,{className:"event-image-color",hAlign:"center",vAlign:"center"},i.createElement(f.Text,{className:"event-color-text",size:"large",weight:"semibold",content:this.props.eventPageState.eventDetails.name}))),i.createElement("div",{style:{marginTop:"1.33rem"}},i.createElement(f.Text,{align:this.props.dir===Z.Rtl?"end":"start",content:this.props.eventPageState.eventDetails.name,weight:"bold",size:"medium"})),i.createElement(f.Flex,{vAlign:"center",hAlign:"start"},i.createElement(f.Layout,{className:"event-date-and-time",start:i.createElement(q.a,{iconName:"Clock"}),main:i.createElement(f.Text,{content:this.getEventDayAndTime(this.props.eventPageState.eventDetails.startDate,this.props.eventPageState.eventDetails.startTime,this.props.eventPageState.eventDetails.endTime),weight:"semibold",size:"small"}),gap:".4rem"}),this.renderEventVenue(this.props.eventPageState.eventDetails.type,this.props.eventPageState.eventDetails.venue)),i.createElement(f.Flex,{vAlign:"center",hAlign:"start",design:{marginTop:"2.67rem"}},i.createElement(f.Text,{align:this.props.dir===Z.Rtl?"end":"start",content:this.props.eventPageState.eventDetails.description})),this.renderAttendeeURL(),i.createElement(f.Flex,{gap:this.props.dir===Z.Rtl?void 0:"gap.large",design:{marginTop:"2.67rem"}},i.createElement(f.Flex,{column:!0,className:this.props.dir===Z.Rtl?"rtl-left-margin-small":""},i.createElement(f.Text,{align:this.props.dir===Z.Rtl?"end":"start",content:this.localize("totalNoOfParticipants"),weight:"semibold"}),i.createElement(f.Text,{align:this.props.dir===Z.Rtl?"end":"start",content:this.props.eventPageState.eventDetails.maximumNumberOfParticipants})),i.createElement(f.Flex,{column:!0},i.createElement(f.Text,{align:this.props.dir===Z.Rtl?"end":"start",content:this.localize("registeredParticipants"),weight:"semibold"}),i.createElement(f.Text,{align:this.props.dir===Z.Rtl?"end":"start",content:this.state.registeredAttendeesCount})))),this.props.dir===Z.Ltr&&i.createElement(f.Flex,{gap:"gap.smaller",className:"button-footer",vAlign:"center"},i.createElement(f.Button,{disabled:this.state.isCreateLoading,icon:i.createElement(f.ArrowLeftIcon,null),text:!0,content:this.localize("back"),onClick:this.backBtnClick}),i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Text,{weight:"bold",content:this.localize("step3of3")})),(this.props.eventPageState.isDraft||!this.props.eventPageState.isEdit)&&i.createElement(i.Fragment,null,i.createElement(f.Button,{disabled:this.state.isCreateLoading||this.state.isDraftLoading,loading:this.state.isDraftLoading,onClick:this.saveEventAsDraft,content:this.localize("saveAsDraft"),secondary:!0,"data-testid":"save_button"}),i.createElement(f.Button,{disabled:this.state.isCreateLoading||this.state.isDraftLoading,loading:this.state.isCreateLoading,content:this.localize("createEvent"),primary:!0,onClick:this.createEvent,"data-testid":"create_event_button"})),!this.props.eventPageState.isDraft&&this.props.eventPageState.isEdit&&i.createElement(i.Fragment,null,i.createElement(f.Button,{disabled:this.state.isCreateLoading,loading:this.state.isCreateLoading,content:this.localize("updateEventButton"),primary:!0,onClick:this.updateEvent,"data-testid":"update_button"}))),this.props.dir===Z.Rtl&&i.createElement(f.Flex,{gap:"gap.smaller",className:"button-footer",vAlign:"center"},i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Button,{disabled:this.state.isCreateLoading,icon:i.createElement(f.ArrowRightIcon,null),text:!0,content:i.createElement(f.Text,{content:this.localize("back"),className:"rtl-right-margin-small"}),onClick:this.backBtnClick})),i.createElement(f.Text,{className:"rtl-left-margin-small",weight:"bold",content:this.localize("step3of3")}),(this.props.eventPageState.isDraft||!this.props.eventPageState.isEdit)&&i.createElement(i.Fragment,null,i.createElement(f.Button,{className:"rtl-left-margin-small",disabled:this.state.isCreateLoading||this.state.isDraftLoading,loading:this.state.isDraftLoading,onClick:this.saveEventAsDraft,content:this.localize("saveAsDraft"),secondary:!0,"data-testid":"save_button"}),i.createElement(f.Button,{disabled:this.state.isCreateLoading||this.state.isDraftLoading,loading:this.state.isCreateLoading,content:this.localize("createEvent"),primary:!0,onClick:this.createEvent,"data-testid":"create_event_button"})),!this.props.eventPageState.isDraft&&this.props.eventPageState.isEdit&&i.createElement(i.Fragment,null,i.createElement(f.Button,{className:"rtl-left-margin-small",disabled:this.state.isCreateLoading,loading:this.state.isCreateLoading,content:this.localize("updateEventButton"),primary:!0,onClick:this.updateEvent,"data-testid":"update_button"}))))}}]),a}(i.Component),Bt=Object(M.a)()(me(zt)),jt=function(e){var t=Object(ze.a)().t,a=i.useState(e.eventDetails),n=Object(be.a)(a,2),s=n[0],o=(n[1],i.useState(!1)),l=Object(be.a)(o,2),c=l[0],u=(l[1],i.useState(!1)),d=Object(be.a)(u,2),m=d[0],p=(d[1],i.useState("")),v=Object(be.a)(p,2),E=v[0],b=v[1];i.useEffect((function(){y(e.eventDetails.createdBy)}),[e.eventDetails]),i.useEffect((function(){y(e.eventDetails.createdBy)}),[]);var y=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[t],e.next=3,G(a);case 3:(n=e.sent).status===r.OK&&n.data&&(i=n.data[0],b(i.displayName));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e,t,a){var n=j.a.utc(e).local().format("ddd"),r=j.a.utc(t).local().format("HH:mm"),i=j.a.utc(a).local().format("HH:mm");return"".concat(n,", ").concat(r," - ").concat(i)};return c?i.createElement(f.Loader,{className:"task-module-loader"}):m?i.createElement(f.Text,{error:!0,content:t("dataResponseFailedStatus"),weight:"semibold"}):i.createElement("div",{className:"close-cancel-event-container"},i.createElement("div",{className:"close-cancel-event"},i.createElement(f.Flex,{space:"between",vAlign:"center"},i.createElement(f.Text,{className:"category label-color",content:s.categoryName,weight:"bold"}),i.createElement(f.Flex.Item,{push:!0},s.audience===R.Private?i.createElement(f.Label,{className:"category-type-label",circular:!0,icon:i.createElement(f.EyeSlashIcon,null),iconPosition:"start",content:t("private")}):i.createElement(f.Label,{className:"category-type-label",circular:!0,icon:i.createElement(f.EyeIcon,null),iconPosition:"start",content:t("public")}))),i.createElement(f.Image,{className:"event-image",fluid:!0,src:s.photo}),i.createElement("div",{style:{marginTop:"1.33rem"}},i.createElement(f.Text,{content:s.name,weight:"bold",size:"medium"})),i.createElement(f.Flex,{vAlign:"center",hAlign:"start"},i.createElement(f.Layout,{className:"event-date-and-time",start:i.createElement(q.a,{iconName:"Clock"}),main:i.createElement(f.Text,{content:C(s.startDate,s.startTime,s.endTime),weight:"semibold",size:"small"}),gap:".4rem"}),function(e,t){if(e===U.InPerson)return i.createElement(i.Fragment,null,i.createElement(f.Divider,{vertical:!0,styles:{height:"1.13rem",marginRight:".8rem"}}),i.createElement(f.Text,{className:"event-venue",content:t,weight:"semibold",size:"small"}))}(s.type,s.venue)),i.createElement(f.Flex,{vAlign:"center",hAlign:"start",design:{marginTop:"2.67rem"}},i.createElement(f.Text,{content:s.description})),i.createElement(f.Flex,{gap:"gap.large",design:{marginTop:"2.67rem"}},i.createElement(f.Flex,{column:!0},i.createElement(f.Text,{content:t("totalNoOfParticipants"),weight:"semibold"}),i.createElement(f.Text,{content:s.maximumNumberOfParticipants})),i.createElement(f.Flex,{column:!0},i.createElement(f.Text,{content:t("registeredParticipants"),weight:"semibold"}),i.createElement(f.Text,{content:s.registeredAttendeesCount}))),function(){var e=E&&E.length?E:t("unknownUserName");return i.createElement(f.Flex,{vAlign:"center",hAlign:"start",gap:"gap.smaller",design:{marginTop:"2.67rem"}},i.createElement(f.Avatar,{size:"small",name:e}),i.createElement(f.Layout,{start:i.createElement(f.Text,{content:t("createdBy"),size:"small"}),main:i.createElement(f.Text,{content:e,size:"small",weight:"semibold"}),gap:".4rem"}))}()))},Mt=(a(1188),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.minDate=new Date,n.params={eventId:void 0,isDraft:!1},n.teamId=void 0,n.getEventDetailsToUpdate=Object(h.a)(g.a.mark((function e(){var t,a,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(n.params.eventId,n.teamId);case 2:(t=e.sent).status===r.OK?(a=t.data,i=Array(),a.selectedUserOrGroupListJSON&&(i=JSON.parse(a.selectedUserOrGroupListJSON)),a.startDate=j.a.utc(a.startDate).local().toDate(),a.endDate=j.a.utc(a.endDate).local().toDate(),a.startTime=j.a.utc(a.startTime).local().toDate(),a.endTime=j.a.utc(a.endTime).local().toDate(),a.status===A.Cancelled||a.endDate<new Date?n.setState({isLoading:!1,displayReadonly:!0,eventDetails:a},n.getAllCategories):n.setState({isLoading:!1,eventDetails:a,selectedUserGroups:i,isEdit:!0,isDraft:n.params.isDraft},n.getAllCategories)):n.setState({isLoading:!1});case 4:case"end":return e.stop()}}),e)}))),n.getAllCategories=Object(h.a)(g.a.mark((function e(){var t,a,i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie();case 2:(t=e.sent).status===r.OK?(a=t.data.map((function(e){return{name:e.name,id:e.categoryId}})),n.state.eventDetails.categoryId?(s=a.find((function(e){return e.id===n.state.eventDetails.categoryId})),i={header:s.name,key:s.id},n.setState({categories:a,selectedCategory:i,isLoading:!1})):n.setState({categories:a,isLoading:!1})):n.setState({isLoading:!1});case 4:case"end":return e.stop()}}),e)}))),n.setEventStep=function(e,t){n.setState({currentEventStep:e,eventDetails:t.eventDetails,selectedAudience:t.selectedAudience,selectedCategory:t.selectedCategory,selectedEvent:t.selectedEvent,selectedUserGroups:t.selectedUserGroups,categories:t.categories})},n.renderOperation=function(){switch(n.state.currentEventStep){case 1:return i.createElement(Nt,{eventPageState:Object($.a)({},n.state),navigateToPage:n.setEventStep});case 2:return i.createElement(At,{eventPageState:Object($.a)({},n.state),navigateToPage:n.setEventStep,dir:n.props.dir});case 3:return i.createElement(Bt,{eventPageState:Object($.a)({},n.state),navigateToPage:n.setEventStep});default:return i.createElement(Nt,{eventPageState:Object($.a)({},n.state),navigateToPage:n.setEventStep})}},n.localize=n.props.t,n.minDate.setDate(n.minDate.getDate()+1),n.teamId="";var s=window.location.search,o=new URLSearchParams(s);return n.params.eventId=o.get("eventId"),n.params.isDraft="true"===o.get("isDraft"),n.state={currentEventStep:1,categories:new Array,displayReadonly:!1,eventDetails:{categoryId:"",categoryName:"",createdBy:"",createdOn:new Date,description:"",endDate:n.minDate,eventId:"",graphEventId:"",isAutoRegister:!1,isRegistrationClosed:!1,maximumNumberOfParticipants:0,meetingLink:"",name:"",numberOfOccurrences:1,photo:"",registeredAttendeesCount:0,startDate:n.minDate,status:0,teamId:"",type:U.Teams,venue:"",audience:R.Public,endTime:void 0,startTime:void 0,mandatoryAttendees:"",optionalAttendees:"",registeredAttendees:"",selectedUserOrGroupListJSON:"",autoRegisteredAttendees:""},selectedCategory:void 0,selectedEvent:void 0,selectedAudience:void 0,selectedUserGroups:new Array,isEdit:!1,isDraft:!1,isLoading:!0},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.getAllCategories()}},{key:"componentWillReceiveProps",value:function(e){e.teamsContext&&e.teamsContext!==this.props.teamsContext&&(this.teamId=e.teamsContext.teamId,this.params.eventId&&this.getEventDetailsToUpdate())}},{key:"render",value:function(){var e;return this.state.isLoading||(null===(e=this.state.categories)||void 0===e?void 0:e.length)?this.state.displayReadonly?i.createElement(jt,{eventDetails:this.state.eventDetails}):i.createElement(Ce.a,{dir:this.props.dir},i.createElement(f.Provider,null,i.createElement(f.Flex,null,i.createElement("div",{className:"task-module-container"},!this.state.isLoading&&!this.state.displayReadonly&&this.renderOperation(),this.state.isLoading&&i.createElement(f.Loader,{className:"loader"}))))):i.createElement(f.Provider,null,i.createElement(f.Flex,null,i.createElement("div",{className:"task-module-container event-task-module"},i.createElement(f.Text,{error:!0,content:this.localize("categoriesNotAvailableError"),weight:"semibold"}))))}}]),a}(i.Component)),Rt=Object(M.a)()(me(Mt)),Ut=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(O.apiBaseURL,"/category"),n=V({teamId:t}),e.next=4,D.get(a,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Vt=function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(O.apiBaseURL,"/category/get-categories-for-event"),e.next=3,D.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_t=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/category"),r=V({teamId:t}),e.next=4,D.post(n,a,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Wt=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/category"),r=V({teamId:t}),e.next=4,D.patch(n,a,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Kt=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/category"),r=V({teamId:t,categoryIds:a}),e.next=4,D.delete(n,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Gt=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).localize=void 0,s.searchText=void 0,s.getCategoriesAsync=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ut(t);case 2:(a=e.sent)&&a.status===r.OK?(i=[],null===(n=a.data)||void 0===n||n.forEach((function(e){i.push(e)})),s.setState({categories:i,isLoading:!1})):s.setState({isLoading:!1,statusMessage:s.localize("dataResponseFailedStatus")});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.getLastCategoryUpdateDateAndTime=function(){var e;if(!((null===(e=s.state.categories)||void 0===e?void 0:e.length)>0))return null;var t,a=Object(X.a)(s.state.categories);a.sort((function(e,t){return e.updatedOn&&t.updatedOn||!e.updatedOn&&t.updatedOn?1:e.updatedOn&&!t.updatedOn?-1:0})),s.localize("lastUpdatedOnStatus",{lastUpdatedOnStatus:null===(t=a[a.length-1].updatedOn)||void 0===t?void 0:t.toUTCString})},s.searchCategories=function(e){var t,a=null!==(t=s.state.categories)&&void 0!==t?t:[];if(a.length>0&&e&&""!==e.trim()){s.searchText=e.trim();var n=a.filter((function(e){return e.name.toLowerCase().indexOf(s.searchText.toLowerCase())>-1||e.description.toLowerCase().indexOf(s.searchText.toLowerCase())>-1}));s.setState({searchedCategories:n})}else s.searchText="",s.setState({categories:a,searchedCategories:[]})},s.onActionPerformed=function(e){if(e===n.Edit||e===n.Delete){var t=s.state.categories.filter((function(e){return e.isSelected}));s.props.onActionPerformed(e,t)}else s.props.onActionPerformed(e)},s.onCategoryCheckedChange=function(e){e.isSelected=!e.isSelected,s.manageControlsEnabilityAndSelection()},s.onSelectAllCategoriesCheckedChange=function(){if(s.state.categories&&s.state.categories.length>0){for(var e=Object(X.a)(s.state.categories),t=0;t<e.length;t++)e[t].isSelected=!s.state.isAllCategoriesSelected;s.setState({categories:e},(function(){s.manageControlsEnabilityAndSelection()}))}},s.onSearchTextChanged=function(e){s.searchCategories(e.target.value)},s.renderCategoryOperationStatusIcon=function(){if(s.state.showStatusIcon)return i.createElement(E.PresenceAvailableIcon,{className:"success-icon"})},s.renderFooter=function(){if(s.state.statusMessage&&""!==s.state.statusMessage)return i.createElement(i.Fragment,null,i.createElement(f.Flex,{gap:"gap.small",vAlign:"center",hAlign:"center"},s.renderCategoryOperationStatusIcon(),i.createElement(f.Flex.Item,{grow:!0},i.createElement(f.Text,{"data-testid":"statusmessage",content:s.state.statusMessage,weight:"semibold"}))),i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Text,{timestamp:!0,content:s.getLastCategoryUpdateDateAndTime(),weight:"semibold"})))},s.renderCategories=function(){if(s.state.isLoading)return i.createElement(f.Flex,{className:"task-module-loader",hAlign:"center",vAlign:"center",fill:!0},i.createElement(f.Loader,null));var e=""!==s.searchText?s.state.searchedCategories:s.state.categories;if((null===e||void 0===e?void 0:e.length)>0){var t={key:"header",items:[{key:"select-all-categories",className:"category-select-all-column",content:i.createElement(f.Checkbox,{"data-testid":"list-categories_selectAllCheckbox",key:"categoriesTableHeader",checked:s.state.isAllCategoriesSelected,onChange:s.onSelectAllCategoriesCheckedChange})},{key:"category-name",className:"category-name-column",content:s.localize("categoryName")},{key:"category-description",content:s.localize("description")}]},a=e.map((function(e,t){return{key:t,items:[{className:"category-select-all-column",content:i.createElement(f.Checkbox,{"data-testid":"list-categories_categoryCheckbox"+t.toString(),key:t,checked:e.isSelected,onChange:function(){return s.onCategoryCheckedChange(e)}})},{className:"category-name-column",content:i.createElement(f.Text,{content:e.name,weight:"bold"}),title:e.name,truncateContent:!0},{content:e.description,title:e.description,truncateContent:!0}]}}));return i.createElement(f.Table,{"data-testid":"table",className:"manage-categories-content categories-table manage-categories-content-background",header:t,rows:a})}return i.createElement(f.Flex,{className:"manage-categories-content",gap:"gap.small"},i.createElement(f.Flex.Item,null,i.createElement("div",{style:{position:"relative"}},i.createElement(E.QuestionCircleIcon,{outline:!0,color:"green"}))),i.createElement(f.Flex.Item,{grow:s.props.dir===Z.Ltr},i.createElement(f.Flex,{column:!0,gap:"gap.small",vAlign:"stretch"},i.createElement("div",{className:s.props.dir===Z.Rtl?"rtl-direction rtl-right-margin-small":""},i.createElement(f.Text,{weight:"bold",content:s.localize("categoriesNotAvailableHeader")}),i.createElement("br",null),i.createElement(f.Text,{content:""!==s.searchText?s.localize("categoriesNotFoundForSearchedTextDescription",{searchedText:s.searchText}):s.localize("categoriesNotAvailableHeaderDescription")})))))},s.renderSearchInput=function(){return s.props.dir===Z.Rtl?i.createElement("div",null,i.createElement(f.Input,{icon:i.createElement(E.SearchIcon,null),iconPosition:"start","data-testid":"searchbar",placeholder:s.localize("searchPlaceholder"),onChange:s.onSearchTextChanged})):s.props.dir===Z.Ltr?i.createElement(f.Input,{icon:i.createElement(E.SearchIcon,null),iconPosition:"end","data-testid":"searchbar",placeholder:s.localize("searchPlaceholder"),onChange:s.onSearchTextChanged}):void 0},s.localize=s.props.t,s.searchText="",s.state={isEditEnabled:!1,isDeleteEnabled:!1,isAllCategoriesSelected:!1,categories:[],searchedCategories:[],statusMessage:s.props.statusMessage,isLoading:!1,showStatusIcon:""!==s.props.statusMessage&&s.props.statusMessage.length>0},s}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.setState({isLoading:!0})}},{key:"componentWillReceiveProps",value:function(e){this.props.teamsContext!==e.teamsContext&&e.teamsContext&&this.getCategoriesAsync(e.teamsContext.teamId)}},{key:"manageControlsEnabilityAndSelection",value:function(){var e,t=null===(e=this.state.categories.filter((function(e){return e.isSelected})))||void 0===e?void 0:e.length,a="",n=t===this.state.categories.length;1===t?(a=this.localize("listCategoriesSelectedStatus",{selectedCategoriesCount:t,totalCategoriesCount:this.state.categories.length}),this.setState({isEditEnabled:!0,isDeleteEnabled:!0,isAllCategoriesSelected:n,statusMessage:a,showStatusIcon:!1})):t>1?(a=this.localize("listCategoriesSelectedStatus",{selectedCategoriesCount:t,totalCategoriesCount:this.state.categories.length}),this.setState({isEditEnabled:!1,isDeleteEnabled:!0,isAllCategoriesSelected:n,statusMessage:a,showStatusIcon:!1})):this.setState({isEditEnabled:!1,isDeleteEnabled:!1,isAllCategoriesSelected:n,statusMessage:a,showStatusIcon:!1})}},{key:"render",value:function(){var e=this;return i.createElement(i.Fragment,null,i.createElement("div",{className:"commandbar-wrapper"},i.createElement(f.Flex,{className:"commandbar-wrapper-container"},i.createElement(f.Button,{text:!0,"data-testid":"addbutton",className:"list-categories-menu-button",icon:i.createElement(E.AddIcon,{className:this.props.dir===Z.Rtl?"rtl-left-margin-small":""}),content:this.localize("add"),onClick:function(){return e.onActionPerformed(n.Add)}}),i.createElement(f.Button,{text:!0,"data-testid":"editbutton",className:"list-categories-menu-button",icon:i.createElement(E.EditIcon,{className:this.props.dir===Z.Rtl?"rtl-left-margin-small":""}),disabled:!this.state.isEditEnabled,content:this.localize("edit"),onClick:function(){return e.onActionPerformed(n.Edit)}}),i.createElement(f.Button,{text:!0,"data-testid":"deletebutton",icon:i.createElement(E.TrashCanIcon,{className:this.props.dir===Z.Rtl?"rtl-left-margin-small":""}),disabled:!this.state.isDeleteEnabled,content:this.localize("delete"),onClick:function(){return e.onActionPerformed(n.Delete)}}),i.createElement(f.Flex.Item,{push:this.props.dir===Z.Ltr,grow:this.props.dir===Z.Rtl,className:"search-input-container"},this.renderSearchInput()))),this.renderCategories(),i.createElement(f.Flex,{className:"manage-categories-footer",space:"between"},this.renderFooter()))}}]),a}(i.Component),Ht=Object(M.a)()(me(Gt)),Qt=function(e){return i.createElement(f.Flex,{className:"manage-categories-footer",space:"between"},i.createElement(f.Button,{"data-testid":"backbutton",className:"back-button",text:!0,icon:e.dir===Z.Rtl?i.createElement(f.ChevronEndIcon,null):i.createElement(f.ChevronStartIcon,null),content:e.backButtonContent,onClick:e.onBackClicked}),i.createElement(f.Flex,{gap:"gap.medium",vAlign:"center",hAlign:"center"},function(){if(e.errorMessage&&""!==e.errorMessage)return i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Text,{error:!0,content:e.errorMessage,weight:"semibold"}))}(),i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Button,{primary:!0,content:e.submitButtonContent,disabled:e.isSubmitButtonDisabled,loading:e.isOperationInProgress,onClick:e.onSubmit,"data-testid":"manage-categories-operation-footer_button"}))))},Jt=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n,s;return Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.teamId=void 0,n.createOrUpdateCategoryAsync=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.setState({isCreatingOrUpdating:!0,errorMessage:""}),!1,n.props.category&&n.props.category.name===n.state.category.name.trim()){e.next=9;break}return e.next=5,n.checkCategoryExists();case 5:if(!e.sent){e.next=9;break}return n.setState({isCategoryAlreadyExists:!0,isCreatingOrUpdating:!1}),e.abrupt("return");case 9:if(!n.props.category){e.next=16;break}return e.next=12,Wt(n.teamId,n.state.category);case 12:(t=e.sent).status==r.OK?1==t.data?n.props.onCategoryAddedOrUpdated(n.localize("categoryUpdateSuccess")):n.setState({isCreatingOrUpdating:!1,errorMessage:n.localize("failedToUpdateCategory")}):n.setState({isCreatingOrUpdating:!1,errorMessage:n.localize("dataResponseFailedStatus")}),e.next=20;break;case 16:return e.next=18,_t(n.teamId,n.state.category);case 18:(t=e.sent).status==r.OK&&!0===t.data?(n.setState({isCreatingOrUpdating:!1,errorMessage:""}),n.props.onCategoryAddedOrUpdated(n.localize("categoryAddedSuccess"))):n.setState({isCreatingOrUpdating:!1,errorMessage:n.localize("dataResponseFailedStatus")});case 20:case"end":return e.stop()}}),e)}))),n.checkCategoryExists=Object(h.a)(g.a.mark((function e(){var t,a,i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=n.state.category.name)||void 0===t?void 0:t.length)){e.next=15;break}return e.next=3,Vt();case 3:if(!(a=e.sent)||a.status!==r.OK||!a.data){e.next=12;break}if((i=a.data)&&0!==i.length){e.next=8;break}return e.abrupt("return",!1);case 8:return s=i.some((function(e){return e.name.toLowerCase()===n.state.category.name.trim().toLowerCase()})),e.abrupt("return",s);case 12:return e.abrupt("return",!1);case 13:e.next=16;break;case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e)}))),n.onNameChanged=function(e){var t=n.state.category;t.name=e.target.value,n.setState({category:t,isCategoryAlreadyExists:!1})},n.onDescriptionChanged=function(e){var t=n.state.category;t.description=e.target.value,n.setState({category:t})},n.renderCategoryNameError=function(){if(n.state.isCategoryAlreadyExists)return i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Text,{error:!0,content:n.localize("categoryAlreadyExistsError"),weight:"semibold"}))},n.localize=n.props.t,n.teamId="",s=n.props.category?Object($.a)({},n.props.category):{categoryId:"",name:"",description:"",isSelected:!1,isInUse:!1},n.state={category:s,isCreatingOrUpdating:!1,errorMessage:"",isCategoryAlreadyExists:!1},n}return Object(u.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.props.teamsContext!==e.teamsContext&&e.teamsContext&&(this.teamId=e.teamsContext.teamId,this.props.category&&this.setState({category:Object($.a)({},this.props.category)}))}},{key:"render",value:function(){return i.createElement(i.Fragment,null,i.createElement(f.Flex,{column:!0,gap:"gap.medium","data-testid":"addorupdateform"},i.createElement(f.Flex,{column:!0,gap:"gap.smaller"},i.createElement(f.Flex,{space:"between"},i.createElement(f.Text,{content:"".concat(this.localize("categoryName"),"*"),weight:"semibold"}),this.renderCategoryNameError()),i.createElement(f.Input,{fluid:!0,required:!0,placeholder:this.localize("enterNamePlaceholder"),value:this.state.category.name,maxLength:O.categoryNameMaxLength,onChange:this.onNameChanged,"data-testid":"categoryname"})),i.createElement(f.Flex,{column:!0,gap:"gap.smaller"},i.createElement(f.Text,{content:"".concat(this.localize("description"),"*"),weight:"semibold"}),i.createElement(f.TextArea,{className:"add-update-category-description",fluid:!0,placeholder:this.localize("categoryDescriptionPlaceholder",{categoryDescriptionMaxLength:O.categoryDescriptionMaxLength}),maxLength:O.categoryDescriptionMaxLength,value:this.state.category.description,onChange:this.onDescriptionChanged,"data-testid":"categorydescription"})),i.createElement(Qt,{dir:this.props.dir,backButtonContent:this.localize("back"),submitButtonContent:this.props.category?this.localize("save"):this.localize("addCategory"),isSubmitButtonDisabled:""===this.state.category.name.trim()||""===this.state.category.description.trim()||this.state.isCreatingOrUpdating||this.state.isCategoryAlreadyExists,isOperationInProgress:this.state.isCreatingOrUpdating,errorMessage:this.state.errorMessage,onBackClicked:this.props.onBackClicked,onSubmit:this.createOrUpdateCategoryAsync})))}}]),a}(i.Component),Yt=Object(M.a)()(me(Jt)),qt=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).localize=n.props.t,n.teamId=void 0,n.deleteCategoryAsync=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isDeleting:!0,errorMessage:""}),t=n.props.categories.map((function(e){return e.categoryId})),e.next=4,Kt(n.teamId,t.join(","));case 4:(a=e.sent).status===r.OK?!0===a.data?n.props.onCategoryDeleted(n.localize("categoryDeleteSuccess")):n.setState({isDeleting:!1,errorMessage:n.localize("failedToDeleteCategory")}):n.setState({isDeleting:!1,errorMessage:n.localize("dataResponseFailedStatus")});case 6:case"end":return e.stop()}}),e)}))),n.renderCategories=function(){if(n.props.categories&&n.props.categories.length>0){var e={key:"header",items:[{key:"category-name",className:"category-name-column",content:n.localize("categoryName")},{key:"category-description",content:n.localize("description")}]},t=n.props.categories.map((function(e,t){return{key:t,items:[{className:"category-select-all-column",content:e.isInUse?i.createElement(f.ExclamationCircleIcon,{title:n.localize("categoryInUse"),style:{paddingLeft:".42rem"}}):""},{className:"category-name-column",content:i.createElement(f.Text,{content:e.name,weight:"bold"}),title:e.name,truncateContent:!0},{content:e.description,title:e.description,truncateContent:!0}]}}));return i.createElement(f.Table,{className:"manage-categories-content categories-table manage-categories-content-background",header:e,rows:t,"data-testid":"deletecategorytable"})}},n.teamId="",n.state={isDeleting:!1,errorMessage:""},n}return Object(u.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.props.teamsContext!==e.teamsContext&&e.teamsContext&&(this.teamId=e.teamsContext.teamId)}},{key:"render",value:function(){return i.createElement(i.Fragment,null,i.createElement(f.Text,{content:this.localize("deleteCategoryConfirmation"),weight:"semibold"}),this.renderCategories(),i.createElement(Qt,{dir:this.props.dir,backButtonContent:this.localize("back"),submitButtonContent:this.localize("delete"),isSubmitButtonDisabled:this.state.isDeleting,isOperationInProgress:this.state.isDeleting,errorMessage:this.state.errorMessage,onBackClicked:this.props.onBackClicked,onSubmit:this.deleteCategoryAsync}))}}]),a}(i.Component),Zt=Object(M.a)()(me(qt)),$t=(a(1189),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).localize=void 0,r.setCategoryOperation=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.Unknown,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];r.setState({operation:t,operationData:a,operationStatusMessage:e})},r.onBackClicked=function(){r.setCategoryOperation()},r.onOperationSuccessful=function(e){r.setCategoryOperation(e)},r.onCategoryActionPerformed=function(e,t){r.setCategoryOperation("",e,t)},r.renderOperation=function(){var e;switch(r.state.operation){case n.Add:return i.createElement(Yt,{onBackClicked:r.onBackClicked,onCategoryAddedOrUpdated:r.onOperationSuccessful});case n.Edit:return i.createElement(Yt,{category:null===(e=r.state.operationData)||void 0===e?void 0:e[0],onBackClicked:r.onBackClicked,onCategoryAddedOrUpdated:r.onOperationSuccessful});case n.Delete:return i.createElement(Zt,{categories:r.state.operationData,onBackClicked:r.onBackClicked,onCategoryDeleted:r.onOperationSuccessful});default:return i.createElement(Ht,{statusMessage:r.state.operationStatusMessage,onActionPerformed:r.onCategoryActionPerformed})}},r.localize=r.props.t,r.state={operation:n.Unknown,operationData:[],operationStatusMessage:""},r}return Object(u.a)(a,[{key:"render",value:function(){return i.createElement(Ce.a,{dir:this.props.dir},i.createElement(f.Provider,null,i.createElement(f.Flex,null,i.createElement("div",{className:"task-module-container"},this.renderOperation()))))}}]),a}(i.Component)),Xt=Object(M.a)()(me($t)),ea=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.isMobileView=void 0,n.getEventDetailsAsync=Object(h.a)(g.a.mark((function e(){var t,a,i,s,o,l,c,u,d,m;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new URLSearchParams(window.location.search),o=null!==(t=s.get("operationType"))&&void 0!==t?t:"0",l=null!==(a=s.get("eventId"))&&void 0!==a?a:"0",c=null!==(i=s.get("teamId"))&&void 0!==i?i:"0",n.isMobileView="true"===s.get("isMobileView"),e.next=7,lt(l,c);case 7:(u=e.sent).status===r.OK&&u.data?(d=u.data,m=P.None,d.status===A.Active&&new Date<j.a.utc(d.endDate).local().toDate()&&(o===P.CloseRegistration.toString()?d.isRegistrationClosed||(m=P.CloseRegistration):o===P.CancelEvent.toString()&&(m=P.CancelEvent)),n.setState({isLoading:!1,eventDetails:d,eventOperationType:m},(function(){n.state.eventDetails&&n.getUserProfileAsync(n.state.eventDetails.createdBy)}))):n.setState({isLoading:!1,isErrorGettingEventDetails:!0});case 9:case"end":return e.stop()}}),e)}))),n.getUserProfileAsync=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[t],e.next=3,G(a);case 3:(i=e.sent).status===r.OK&&i.data&&(s=i.data[0],n.setState({eventCreatedBy:s.displayName}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onCloseOrCancelEvent=Object(h.a)(g.a.mark((function e(){var t,a,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.setState({isFailedToCloseOrCancelEvent:!1,isOperationInProgress:!0}),a=n.state.eventDetails?n.state.eventDetails.teamId:"0",i=n.state.eventDetails?n.state.eventDetails.eventId:"0",e.t0=n.state.eventOperationType,e.next=e.t0===P.CloseRegistration?6:e.t0===P.CancelEvent?10:14;break;case 6:return e.next=8,ct(a,i);case 8:return t=e.sent,e.abrupt("break",15);case 10:return e.next=12,ut(a,i);case 12:return t=e.sent,e.abrupt("break",15);case 14:return e.abrupt("break",15);case 15:t&&t.status===r.OK&&!0===t.data?n.props.microsoftTeams.tasks.submitTask({isSuccess:!0}):n.setState({isFailedToCloseOrCancelEvent:!0,isOperationInProgress:!1});case 16:case"end":return e.stop()}}),e)}))),n.localize=n.props.t,n.isMobileView=!1,n.state={isLoading:!0,isOperationInProgress:!1,eventDetails:void 0,eventCreatedBy:"",isErrorGettingEventDetails:!1,isFailedToCloseOrCancelEvent:!1,eventOperationType:P.None},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.getEventDetailsAsync()}},{key:"render",value:function(){return i.createElement(xe,{dir:this.props.dir,eventDetails:this.state.eventDetails,eventCreatedByName:this.state.eventCreatedBy,eventOperationType:this.state.eventOperationType,isLoadingEventDetails:this.state.isLoading,isFailedToGetEventDetails:this.state.isErrorGettingEventDetails,isOperationInProgress:this.state.isOperationInProgress,isOperationFailed:this.state.isFailedToCloseOrCancelEvent,isMobileView:this.isMobileView,onPerformOperation:this.onCloseOrCancelEvent})}}]),a}(i.Component),ta=Object(M.a)()(me(ea)),aa=function(e){var t=Object(ze.a)().t,a=window.location.search,n=new URLSearchParams(a),s=n.get("eventId"),o=n.get("teamId"),l=i.useState(!1),c=Object(be.a)(l,2),u=c[0],d=c[1],m=i.useState(!1),p=Object(be.a)(m,2),v=p[0],E=(p[1],i.useState(!1)),b=Object(be.a)(E,2),y=b[0],C=b[1],x=function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!1),d(!0),e.next=4,dt(o,s);case 4:(t=e.sent)&&t.status===r.OK&&!0===t.data?(d(!1),S.tasks.submitTask({isSuccess:!0})):(d(!1),C(!0));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return v?i.createElement(f.Text,{error:!0,content:t("dataResponseFailedStatus"),weight:"semibold"}):i.createElement(f.Provider,null,i.createElement(f.Flex,null,i.createElement("div",{className:"task-module-container close-cancel-event-container"},i.createElement("div",{className:"close-cancel-event"},i.createElement(f.Text,{weight:"bold",content:t("deleteConfirmationText")})),i.createElement(f.Flex,{styles:{marginRight:"3.4rem",marginLeft:"3.4rem",margintop:"2rem",position:"absolute",bottom:"3.4rem"},vAlign:"center"},y?i.createElement(f.Text,{error:!0,content:t("dataResponseFailedStatus"),weight:"semibold"}):null,i.createElement(f.Flex.Item,{push:!0},i.createElement(f.Button,{primary:!0,loading:u,disabled:u,content:t("delete"),onClick:x}))))))},na=(a(1190),function(e){var t=Object(ze.a)().t;return i.createElement("div",{className:"sign-in-content-container"},i.createElement("div",null),i.createElement(f.Text,{content:t("signInMessage"),size:"medium"}),i.createElement("div",{className:"space"}),i.createElement(f.Button,{content:t("signInText"),primary:!0,className:"sign-in-button",onClick:function(){S.initialize(),S.authentication.authenticate({url:window.location.origin+"/signin-simple-start",successCallback:function(){console.log("Login succeeded!"),window.location.href="/discover"},failureCallback:function(e){console.log("Login failed: "+e),window.location.href="/errorpage"}})}}))}),ra=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(O.apiBaseURL,"/authenticationMetadata/consentUrl"),r=V({windowLocationOriginDomain:t,loginhint:a}),e.next=4,D.get(n,r,!1);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ia=function(){return Object(i.useEffect)((function(){S.initialize(),S.getContext((function(e){var t=window.location.origin.replace("https://",""),a=e.upn?e.upn:"";ra(t,a).then((function(e){window.location.assign(e.data)}))}))})),s.a.createElement(s.a.Fragment,null)},sa=function(){return Object(i.useEffect)((function(){S.initialize();var e=function(){var e={};return window.location.hash.substr(1).split("&").forEach((function(t){var a=t.split("="),n=a[0],r=a[1]&&decodeURIComponent(a[1]);e[n]=r})),e}();e.error?S.authentication.notifyFailure(e.error):e.id_token?(S.authentication.notifySuccess(),window.location.href="/"):S.authentication.notifyFailure("UnexpectedFailure")})),s.a.createElement(s.a.Fragment,null)},oa=function(){return i.createElement(i.Suspense,{fallback:i.createElement("div",{className:"container-div"},i.createElement("div",{className:"container-subdiv"}))},i.createElement(l.a,null,i.createElement(p.c,null,i.createElement(p.a,{exact:!0,path:"/discover-events",component:$e}),i.createElement(p.a,{exact:!0,path:"/my-events",component:et}),i.createElement(p.a,{exact:!0,path:"/manage-events",component:gt}),i.createElement(p.a,{exact:!0,path:"/manage-categories",component:Xt}),i.createElement(p.a,{exact:!0,path:"/close-or-cancel-event",component:ta}),i.createElement(p.a,{exact:!0,path:"/register-remove",component:ke}),i.createElement(p.a,{exact:!0,path:"/create-event",component:Rt}),i.createElement(p.a,{exact:!0,path:"/delete-draft",component:aa}),i.createElement(p.a,{exact:!0,path:"/mobile-filter",component:it}),i.createElement(p.a,{exact:!0,path:"/signin",component:na}),i.createElement(p.a,{exact:!0,path:"/signin-simple-start",component:ia}),i.createElement(p.a,{exact:!0,path:"/signin-simple-end",component:sa}),i.createElement(p.a,{exact:!0,path:"/error",component:b}))))},la=(a(1192),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).theme=null,n.setThemeComponent=function(){return n.state.theme===O.dark?n.getAppDOM(f.themes.teamsDark,"dark-container"):n.state.theme===O.contrast?n.getAppDOM(f.themes.teamsHighContrast,"high-contrast-container"):n.getAppDOM(f.themes.teams,"default-container")},n.getAppDOM=function(e,t){return i.createElement(f.Provider,{theme:e},i.createElement("div",{className:t},i.createElement("div",{className:"appContainer"},i.createElement(oa,null))))};var r=window.location.search,s=new URLSearchParams(r);return n.theme=s.get("theme"),Object(Ae.a)(),n.state={theme:n.theme?n.theme:O.default},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;S.initialize(),S.getContext((function(t){e.setState({theme:t.theme})})),S.registerOnThemeChangeHandler((function(t){e.setState({theme:t},(function(){e.forceUpdate()}))}))}},{key:"render",value:function(){return i.createElement("div",null,this.setThemeComponent())}}]),a}(i.Component));o.render(i.createElement(l.a,null,i.createElement(la,null)),document.getElementById("root"))},289:function(e,t,a){},290:function(e,t,a){},470:function(e,t,a){},511:function(e,t,a){e.exports=a(1193)}},[[511,1,2]]]);
//# sourceMappingURL=main.2c39724d.chunk.js.map